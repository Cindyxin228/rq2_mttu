[{"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/60", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/60/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/60/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/60/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/60", "id": 1504318665, "node_id": "PR_kwDOIA_TYM5F2shC", "number": 60, "title": "Export notary api.", "user": {"login": "dvc94ch", "id": 741807, "node_id": "MDQ6VXNlcjc0MTgwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/741807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvc94ch", "html_url": "https://github.com/dvc94ch", "followers_url": "https://api.github.com/users/dvc94ch/followers", "following_url": "https://api.github.com/users/dvc94ch/following{/other_user}", "gists_url": "https://api.github.com/users/dvc94ch/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvc94ch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvc94ch/subscriptions", "organizations_url": "https://api.github.com/users/dvc94ch/orgs", "repos_url": "https://api.github.com/users/dvc94ch/repos", "events_url": "https://api.github.com/users/dvc94ch/events{/privacy}", "received_events_url": "https://api.github.com/users/dvc94ch/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-20T10:19:53Z", "updated_at": "2022-12-21T01:53:14Z", "closed_at": "2022-12-21T00:31:19Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/60", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/60", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/60.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/60.patch", "merged_at": "2022-12-21T00:31:19Z"}, "body": "This change was dropped from my PR. Wanted to reopen to discuss it in more detail.\r\n\r\nA consumer of the notarization api would have to add `app-store-connect` as a dependency and hope that the version matches the one required by apple-codesign. This is because the response types of the `notary_api` are part of the public api of the `Notarizer`. I think a crate should export all types in it's public api. An alternative would be to try to remove the types from the public api, by wrapping them with types in this crate that hide the inner type. But in this case I think that reexporting notary_api is the sensible thing to do. wdyt?", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/60/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/60/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/48", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/48/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/48/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/48/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/48", "id": 1439601330, "node_id": "PR_kwDOIA_TYM5CZGFI", "number": 48, "title": "ci: only trigger on pushes to main", "user": {"login": "indygreg", "id": 342993, "node_id": "MDQ6VXNlcjM0Mjk5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/342993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/indygreg", "html_url": "https://github.com/indygreg", "followers_url": "https://api.github.com/users/indygreg/followers", "following_url": "https://api.github.com/users/indygreg/following{/other_user}", "gists_url": "https://api.github.com/users/indygreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/indygreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/indygreg/subscriptions", "organizations_url": "https://api.github.com/users/indygreg/orgs", "repos_url": "https://api.github.com/users/indygreg/repos", "events_url": "https://api.github.com/users/indygreg/events{/privacy}", "received_events_url": "https://api.github.com/users/indygreg/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-11-08T06:56:45Z", "updated_at": "2022-11-09T02:03:03Z", "closed_at": "2022-11-09T02:03:02Z", "author_association": "OWNER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/48", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/48", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/48.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/48.patch", "merged_at": "2022-11-09T02:03:02Z"}, "body": "Before this, CI would run for both a branch push and a PR event. That resulted in double CI for project maintainers.\r\n\r\nLet's just trigger CI on the main branch and on PRs. This could inconvenience people who push branches to this repo. But what else can you do?", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/48/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/48/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/47", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/47/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/47/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/47/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/47", "id": 1439588167, "node_id": "PR_kwDOIA_TYM5CZDSl", "number": 47, "title": "apple-codesign: introduce trycmd for CLI testing", "user": {"login": "indygreg", "id": 342993, "node_id": "MDQ6VXNlcjM0Mjk5Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/342993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/indygreg", "html_url": "https://github.com/indygreg", "followers_url": "https://api.github.com/users/indygreg/followers", "following_url": "https://api.github.com/users/indygreg/following{/other_user}", "gists_url": "https://api.github.com/users/indygreg/gists{/gist_id}", "starred_url": "https://api.github.com/users/indygreg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/indygreg/subscriptions", "organizations_url": "https://api.github.com/users/indygreg/orgs", "repos_url": "https://api.github.com/users/indygreg/repos", "events_url": "https://api.github.com/users/indygreg/events{/privacy}", "received_events_url": "https://api.github.com/users/indygreg/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-08T06:41:49Z", "updated_at": "2022-11-26T22:16:46Z", "closed_at": "2022-11-26T22:16:45Z", "author_association": "OWNER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/47", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/47", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/47.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/47.patch", "merged_at": "2022-11-26T22:16:45Z"}, "body": "We don't have great test coverage of the CLI. Let's introduce `trycmd` so we can start to change that.", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/47/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/47/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/39", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/39/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/39/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/39/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/39", "id": 1436356105, "node_id": "PR_kwDOIA_TYM5COaSY", "number": 39, "title": "Add apple-dmg.", "user": {"login": "dvc94ch", "id": 741807, "node_id": "MDQ6VXNlcjc0MTgwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/741807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvc94ch", "html_url": "https://github.com/dvc94ch", "followers_url": "https://api.github.com/users/dvc94ch/followers", "following_url": "https://api.github.com/users/dvc94ch/following{/other_user}", "gists_url": "https://api.github.com/users/dvc94ch/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvc94ch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvc94ch/subscriptions", "organizations_url": "https://api.github.com/users/dvc94ch/orgs", "repos_url": "https://api.github.com/users/dvc94ch/repos", "events_url": "https://api.github.com/users/dvc94ch/events{/privacy}", "received_events_url": "https://api.github.com/users/dvc94ch/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-11-04T16:42:48Z", "updated_at": "2022-11-08T05:15:16Z", "closed_at": "2022-11-08T05:15:15Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/39", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/39", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/39.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/39.patch", "merged_at": "2022-11-08T05:15:15Z"}, "body": "Remaining issues with writing dmgs are:\r\n- no support for customizing the dmg with `.DS_Store` files as there is no rust crate to write them\r\n- the number of sectors need to be guessed in advance because the fatfs crate does not support shrinking the file system\r\n\r\nCloses #2 ", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/39/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/39/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/37", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/37/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/37/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/37/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/37", "id": 1425696784, "node_id": "PR_kwDOIA_TYM5Bq2OA", "number": 37, "title": "Update deps.", "user": {"login": "dvc94ch", "id": 741807, "node_id": "MDQ6VXNlcjc0MTgwNw==", "avatar_url": "https://avatars.githubusercontent.com/u/741807?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvc94ch", "html_url": "https://github.com/dvc94ch", "followers_url": "https://api.github.com/users/dvc94ch/followers", "following_url": "https://api.github.com/users/dvc94ch/following{/other_user}", "gists_url": "https://api.github.com/users/dvc94ch/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvc94ch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvc94ch/subscriptions", "organizations_url": "https://api.github.com/users/dvc94ch/orgs", "repos_url": "https://api.github.com/users/dvc94ch/repos", "events_url": "https://api.github.com/users/dvc94ch/events{/privacy}", "received_events_url": "https://api.github.com/users/dvc94ch/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-10-27T14:05:08Z", "updated_at": "2022-10-30T20:20:33Z", "closed_at": "2022-10-30T20:20:32Z", "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/37", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/37", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/37.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/37.patch", "merged_at": "2022-10-30T20:20:32Z"}, "body": "Currently have a build failure due to aws-smithy-xml pinning xmlparser to an old version. this is fixed in 0.51. While at it ran `cargo upgrade` on the workspace. Didn't update goblin from 0.5 to 0.6 because it requires api changes.", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/37/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/37/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/36", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/36/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/36/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/36/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/36", "id": 1411900996, "node_id": "PR_kwDOIA_TYM5A8nt3", "number": 36, "title": "implement support for specifying smartcard PIN in an environment variable for signing operatons", "user": {"login": "wrl", "id": 1824, "node_id": "MDQ6VXNlcjE4MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1824?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wrl", "html_url": "https://github.com/wrl", "followers_url": "https://api.github.com/users/wrl/followers", "following_url": "https://api.github.com/users/wrl/following{/other_user}", "gists_url": "https://api.github.com/users/wrl/gists{/gist_id}", "starred_url": "https://api.github.com/users/wrl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wrl/subscriptions", "organizations_url": "https://api.github.com/users/wrl/orgs", "repos_url": "https://api.github.com/users/wrl/repos", "events_url": "https://api.github.com/users/wrl/events{/privacy}", "received_events_url": "https://api.github.com/users/wrl/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-10-17T16:53:16Z", "updated_at": "2022-10-27T08:25:50Z", "closed_at": "2022-10-27T08:25:50Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/36", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/36", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/36.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/36.patch", "merged_at": "2022-10-27T08:25:50Z"}, "body": "This PR implements a `--smartcard-pin-env` for specifying an environment variable which holds the smartcard PIN (in the same fashion as `--remote-shared-secret-env`). If this argument is not specified, or the environment variable is empty, the operation falls back to the existing interactive prompt.\r\n\r\nI implemented this by changing `set_pin_callback()` to be able to take a closure rather than a function pointer, which required a bit of surgery in `yubikey.rs`. Happy to re-implement this a different way (for example, some sort of `PINSource` enum, with keyboard input and already-allocated PIN as options).\r\n\r\nNotably missing from this PR:\r\n- Support for operations other than signing.\r\n\r\n    My intended usage for this was an HSM in a remote CI machine, so in a sense this fulfills the same sort of use-case as the remote signing support. I don't think that providing the PIN outside of keyboard input for management operations is a good idea from a security standpoint.\r\n\r\n- A separate argument for specifying the PIN directly via a command line argument.\r\n\r\n    Roughly the same equivalent to `--remote-shared-secret`. I have only slight reservations about implementing this (I'm very happy to discourage passing secrets as command line parameters) but would do so if you would prefer.\r\n\r\n- Documentation.\r\n\r\n    Happy to add once you're happy with the implementation. :)\r\n\r\nHave tested and works well with a Yubikey 5.\r\n\r\nResolves #33 ", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/36/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/36/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/34", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/34/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/34/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/34/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/34", "id": 1398186618, "node_id": "PR_kwDOIA_TYM5APDmN", "number": 34, "title": "Fix smartcard-import certificate import command documentation", "user": {"login": "wrl", "id": 1824, "node_id": "MDQ6VXNlcjE4MjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1824?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wrl", "html_url": "https://github.com/wrl", "followers_url": "https://api.github.com/users/wrl/followers", "following_url": "https://api.github.com/users/wrl/following{/other_user}", "gists_url": "https://api.github.com/users/wrl/gists{/gist_id}", "starred_url": "https://api.github.com/users/wrl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wrl/subscriptions", "organizations_url": "https://api.github.com/users/wrl/orgs", "repos_url": "https://api.github.com/users/wrl/repos", "events_url": "https://api.github.com/users/wrl/events{/privacy}", "received_events_url": "https://api.github.com/users/wrl/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-10-05T18:20:51Z", "updated_at": "2022-10-17T16:40:29Z", "closed_at": "2022-10-07T09:15:10Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/34", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/34", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/34.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/34.patch", "merged_at": "2022-10-07T09:15:10Z"}, "body": "Was missing `--existing-key`, which resulted in a `no private key found` error.", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/34/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/34/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/20", "repository_url": "https://api.github.com/repos/indygreg/apple-platform-rs", "labels_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/20/labels{/name}", "comments_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/20/comments", "events_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/20/events", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/20", "id": 1377190492, "node_id": "PR_kwDOIA_TYM4_KNaz", "number": 20, "title": "apple-codesign: zip notarization support", "user": {"login": "deansheather", "id": 11241812, "node_id": "MDQ6VXNlcjExMjQxODEy", "avatar_url": "https://avatars.githubusercontent.com/u/11241812?v=4", "gravatar_id": "", "url": "https://api.github.com/users/deansheather", "html_url": "https://github.com/deansheather", "followers_url": "https://api.github.com/users/deansheather/followers", "following_url": "https://api.github.com/users/deansheather/following{/other_user}", "gists_url": "https://api.github.com/users/deansheather/gists{/gist_id}", "starred_url": "https://api.github.com/users/deansheather/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/deansheather/subscriptions", "organizations_url": "https://api.github.com/users/deansheather/orgs", "repos_url": "https://api.github.com/users/deansheather/repos", "events_url": "https://api.github.com/users/deansheather/events{/privacy}", "received_events_url": "https://api.github.com/users/deansheather/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2022-09-18T22:03:12Z", "updated_at": "2022-09-21T02:15:21Z", "closed_at": "2022-09-21T02:15:21Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/pulls/20", "html_url": "https://github.com/indygreg/apple-platform-rs/pull/20", "diff_url": "https://github.com/indygreg/apple-platform-rs/pull/20.diff", "patch_url": "https://github.com/indygreg/apple-platform-rs/pull/20.patch", "merged_at": "2022-09-21T02:15:21Z"}, "body": "From indygreg/PyOxidizer#635\r\n\r\nAdds the ability to notarize .zip files containing other notarizable assets (such as a Mach-O binary).\r\n\r\nStapling (via the `staple` subcommand or `notary-submit --staple` option) is not supported for .zip files and will return an error.\r\n\r\nZip files are supported by the popular [gon](https://github.com/mitchellh/gon) tool which we were previously using. We would like to switch to rcodesign to sign our darwin release binaries but we can't as we don't release our CLI as a bundle, xar or dmg file.\r\n\r\n```console\r\n$ rcodesign sign --p12-file ./AppleDevCert_Production.p12 --p12-password-file ./cert-pw.txt --code-signature-flags runtime ./build/coder_darwin_arm64\r\n...\r\n\r\n$ zip x.zip build/coder_darwn_arm64\r\n  adding: build/coder_darwin_arm64 (deflated 23%)\r\n\r\n$ rcodesign notary-submit --api-key-path ./key.json --wait x.zip \r\ncreating Notary API submission for x.zip (sha256: 309d5c53a47a45a07c1869171df7b1b136d1077f5f0e268373d2fefd18074b0d)\r\ncreated submission ID: 51310405-3244-46cc-a2f3-efd83401bcbf\r\nresolving AWS S3 configuration from Apple-provided credentials\r\nuploading asset to s3://notary-submissions-prod/prod/AROARQRX7CZS3PRF6ZA5L:51310405-3244-46cc-a2f3-efd83401bcbf\r\n(you may see additional log output from S3 client)\r\nsend_operation;\r\nsend_operation; operation=\"PutObject\"\r\nsend_operation; service=\"s3\"\r\nsend_operation; status=\"ok\"\r\nS3 upload completed successfully\r\nwaiting up to 600s for package upload 51310405-3244-46cc-a2f3-efd83401bcbf to finish processing\r\npoll state after 0s: InProgress\r\npoll state after 4s: InProgress\r\npoll state after 7s: InProgress\r\npoll state after 11s: InProgress\r\npoll state after 15s: InProgress\r\npoll state after 19s: InProgress\r\npoll state after 22s: Accepted\r\nNotary API Server has finished processing the uploaded asset\r\nfetching notarization log for 51310405-3244-46cc-a2f3-efd83401bcbf\r\nnotary log> {\r\nnotary log>   \"archiveFilename\": \"x.zip\",\r\nnotary log>   \"issues\": null,\r\nnotary log>   \"jobId\": \"51310405-3244-46cc-a2f3-efd83401bcbf\",\r\nnotary log>   \"logFormatVersion\": 1,\r\nnotary log>   \"sha256\": \"309d5c53a47a45a07c1869171df7b1b136d1077f5f0e268373d2fefd18074b0d\",\r\nnotary log>   \"status\": \"Accepted\",\r\nnotary log>   \"statusCode\": 0,\r\nnotary log>   \"statusSummary\": \"Ready for distribution\",\r\nnotary log>   \"ticketContents\": [\r\nnotary log>     {\r\nnotary log>       \"arch\": \"arm64\",\r\nnotary log>       \"cdhash\": \"181a64cf314e5f0fefd468aee3a0047992244d60\",\r\nnotary log>       \"digestAlgorithm\": \"SHA-256\",\r\nnotary log>       \"path\": \"x.zip/build/coder_darwin_arm64\"\r\nnotary log>     }\r\nnotary log>   ],\r\nnotary log>   \"uploadDate\": \"2022-09-06T07:48:23.895Z\"\r\nnotary log> }\r\n```", "reactions": {"url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/20/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 3}, "timeline_url": "https://api.github.com/repos/indygreg/apple-platform-rs/issues/20/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]