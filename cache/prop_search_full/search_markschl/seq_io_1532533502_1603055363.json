[{"url": "https://api.github.com/repos/markschl/seq_io/issues/2", "repository_url": "https://api.github.com/repos/markschl/seq_io", "labels_url": "https://api.github.com/repos/markschl/seq_io/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/markschl/seq_io/issues/2/comments", "events_url": "https://api.github.com/repos/markschl/seq_io/issues/2/events", "html_url": "https://github.com/markschl/seq_io/pull/2", "id": 349632937, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA3NzAzNDM0", "number": 2, "title": "Add support for fuzzing using cargo fuzz", "user": {"login": "aseyboldt", "id": 1882397, "node_id": "MDQ6VXNlcjE4ODIzOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1882397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aseyboldt", "html_url": "https://github.com/aseyboldt", "followers_url": "https://api.github.com/users/aseyboldt/followers", "following_url": "https://api.github.com/users/aseyboldt/following{/other_user}", "gists_url": "https://api.github.com/users/aseyboldt/gists{/gist_id}", "starred_url": "https://api.github.com/users/aseyboldt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aseyboldt/subscriptions", "organizations_url": "https://api.github.com/users/aseyboldt/orgs", "repos_url": "https://api.github.com/users/aseyboldt/repos", "events_url": "https://api.github.com/users/aseyboldt/events{/privacy}", "received_events_url": "https://api.github.com/users/aseyboldt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2018-08-10T19:33:19Z", "updated_at": "2018-08-13T17:44:08Z", "closed_at": "2018-08-13T17:42:26Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/markschl/seq_io/pulls/2", "html_url": "https://github.com/markschl/seq_io/pull/2", "diff_url": "https://github.com/markschl/seq_io/pull/2.diff", "patch_url": "https://github.com/markschl/seq_io/pull/2.patch", "merged_at": "2018-08-13T17:42:26Z"}, "body": "I've been fuzzing seq_io, and found an issue.\r\nWith this PR applied, run\r\n```\r\nenv RUST_BACKTRACE=1 cargo fuzz run single_thread -- -max_len=100 -only_ascii=1\r\n```\r\nI'm getting a panic:\r\n\r\n<details>\r\n\r\n```\r\nINFO: Seed: 3182441194\r\nINFO: Loaded 1 modules   (1091157 guards): 1091157 [0x109391148, 0x1097baa9c), \r\nINFO:       76 files found in /Users/adrianseyboldt/git/seq_io/fuzz/corpus/single_thread\r\nINFO: seed corpus: files: 76 min: 1b max: 100b total: 3390b rss: 50Mb\r\n#77\tINITED cov: 3516 ft: 6385 corp: 28/615b exec/s: 0 rss: 67Mb\r\n#98\tREDUCE cov: 3516 ft: 6385 corp: 28/601b exec/s: 0 rss: 68Mb L: 18/82 MS: 1 EraseBytes-\r\nthread '<unnamed>' panicked at 'slice index starts at 1 but ends at 0', libcore/slice/mod.rs:1941:5\r\nstack backtrace:\r\n   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace\r\n             at libstd/sys/unix/backtrace/tracing/gcc_s.rs:49\r\n   1: std::sys_common::backtrace::print\r\n             at libstd/sys_common/backtrace.rs:71\r\n             at libstd/sys_common/backtrace.rs:59\r\n   2: std::panicking::default_hook::{{closure}}\r\n             at libstd/panicking.rs:211\r\n   3: std::panicking::default_hook\r\n             at libstd/panicking.rs:227\r\n   4: <std::panicking::begin_panic::PanicPayload<A> as core::panic::BoxMeUp>::get\r\n             at libstd/panicking.rs:475\r\n   5: std::panicking::continue_panic_fmt\r\n             at libstd/panicking.rs:390\r\n   6: std::panicking::default_hook::{{closure}}\r\n             at libstd/panicking.rs:325\r\n   7: core::ptr::drop_in_place\r\n             at libcore/panicking.rs:77\r\n   8: core::ptr::drop_in_place\r\n             at libcore/slice/mod.rs:1941\r\n   9: core::alloc::Layout::align\r\n             at /Users/travis/build/rust-lang/rust/src/libcore/slice/mod.rs:2098\r\n  10: core::str::traits::<impl core::cmp::PartialEq for str>::eq\r\n             at /Users/travis/build/rust-lang/rust/src/libcore/slice/mod.rs:1917\r\n  11: seq_io::fastq::BufferPosition::head\r\n             at ./src/fastq.rs:750\r\n  12: <seq_io::fastq::Reader<R, S>>::get_error_pos\r\n             at ./src/fastq.rs:322\r\n  13: <seq_io::fastq::Reader<R, S>>::next_complete\r\n             at ./src/fastq.rs:368\r\n  14: <seq_io::fastq::Reader<R, S>>::proceed\r\n             at ./src/fastq.rs:119\r\n  15: <seq_io::fastq::Reader<R, S>>::next\r\n             at ./src/fastq.rs:142\r\n  16: asan.module_dtor\r\n             at fuzz_targets/single_thread.rs:15\r\n  17: libfuzzer_sys::test_input_wrap::{{closure}}\r\n             at /Users/adrianseyboldt/.cargo/git/checkouts/libfuzzer-sys-e07fde05820d7bc6/86bcaac/src/lib.rs:11\r\n  18: asan.module_dtor\r\n             at /Users/travis/build/rust-lang/rust/src/libstd/panicking.rs:310\r\n==71378== ERROR: libFuzzer: deadly signal\r\n    #0 0x10b582bf7 in __sanitizer_print_stack_trace (libclang_rt.asan_osx_dynamic.dylib:x86_64+0x62bf7)\r\n    #1 0x108fa7cfb in fuzzer::Fuzzer::CrashCallback() FuzzerLoop.cpp:233\r\n    #2 0x108fa7cad in fuzzer::Fuzzer::StaticCrashSignalCallback() FuzzerLoop.cpp:206\r\n    #3 0x109005ea7 in fuzzer::CrashHandler(int, __siginfo*, void*) FuzzerUtilPosix.cpp:36\r\n    #4 0x7fff6d803f59 in _sigtramp (libsystem_platform.dylib:x86_64+0x1f59)\r\n    #5 0x109304007  (single_thread):x86_64+0x102a0f007)\r\n    #6 0x7fff6d5a11ad in abort (libsystem_c.dylib:x86_64+0x5d1ad)\r\n    #7 0x109055318 in panic_abort::__rust_start_panic::abort::h634520f98782cd18 lib.rs:61\r\n    #8 0x109055308 in __rust_start_panic lib.rs:56\r\n    #9 0x109049e28 in rust_panic panicking.rs:523\r\n    #10 0x109049e01 in std::panicking::rust_panic_with_hook::h63bac89c0b130b1b panicking.rs:495\r\n    #11 0x10904990c in std::panicking::continue_panic_fmt::hca36ebb6f3aa63ac panicking.rs:390\r\n    #12 0x1090497f8 in rust_begin_unwind panicking.rs:325\r\n    #13 0x1090644e1 in core::panicking::panic_fmt::hf13b65b6154af8d5 panicking.rs:77\r\n    #14 0x109057ff4 in core::slice::slice_index_order_fail::h43a32eb72008320c mod.rs:1941\r\n    #15 0x108f2e66e in _$LT$core..ops..range..Range$LT$usize$GT$$u20$as$u20$core..slice..SliceIndex$LT$$u5b$T$u5d$$GT$$GT$::index::h0faf9fbc7c59c6ff mod.rs:2098\r\n    #16 0x1089b1695 in core::slice::_$LT$impl$u20$core..ops..index..Index$LT$I$GT$$u20$for$u20$$u5b$T$u5d$$GT$::index::h18f44fda58e6d108 mod.rs:1917\r\n    #17 0x106918df2 in seq_io::fastq::BufferPosition::head::h255a495d6fa69647 fastq.rs:750\r\n    #18 0x106901a4c in _$LT$seq_io..fastq..Reader$LT$R$C$$u20$S$GT$$GT$::get_error_pos::hb03a14f6d76fb403 fastq.rs:322\r\n    #19 0x106904db7 in _$LT$seq_io..fastq..Reader$LT$R$C$$u20$S$GT$$GT$::next_complete::hc1c47ae20e64b998 fastq.rs:368\r\n    #20 0x106911419 in _$LT$seq_io..fastq..Reader$LT$R$C$$u20$S$GT$$GT$::proceed::hc5c2d0ce376e739b fastq.rs:119\r\n    #21 0x10690fa5f in _$LT$seq_io..fastq..Reader$LT$R$C$$u20$S$GT$$GT$::next::h131e1813100d008b fastq.rs:142\r\n    #22 0x1068fbabf in rust_fuzzer_test_input single_thread.rs:15\r\n    #23 0x108fa42de in libfuzzer_sys::test_input_wrap::_$u7b$$u7b$closure$u7d$$u7d$::h0a71f7a9044d8747 lib.rs:11\r\n    #24 0x108fa56e0 in std::panicking::try::do_call::h6dffe5f7048c2351 panicking.rs:310\r\n    #25 0x1090552fb in __rust_maybe_catch_panic lib.rs:39\r\n    #26 0x108fa4c12 in std::panicking::try::hee4100871ea2e35d panicking.rs:289\r\n    #27 0x108fa018f in std::panic::catch_unwind::h02670d829b3a0291 panic.rs:392\r\n    #28 0x108fa3b01 in LLVMFuzzerTestOneInput lib.rs:9\r\n    #29 0x108faa811 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) FuzzerLoop.cpp:515\r\n    #30 0x108fa9c6a in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) FuzzerLoop.cpp:440\r\n    #31 0x108faff03 in fuzzer::Fuzzer::MutateAndTestOne() FuzzerLoop.cpp:648\r\n    #32 0x108fb27d8 in fuzzer::Fuzzer::Loop(std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, fuzzer::fuzzer_allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) FuzzerLoop.cpp:775\r\n    #33 0x108ff1961 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) FuzzerDriver.cpp:754\r\n    #34 0x10901e87f in main FuzzerMain.cpp:20\r\n    #35 0x7fff6d4f5014 in start (libdyld.dylib:x86_64+0x1014)\r\n\r\nNOTE: libFuzzer has rudimentary signal handlers.\r\n      Combine libFuzzer with AddressSanitizer or similar for better crash reports.\r\nSUMMARY: libFuzzer: deadly signal\r\nMS: 3 EraseBytes-CopyPart-EraseBytes-; base unit: d95527d899043c4adbc0db32a303b7221f1f05d5\r\n0xa,0x2a,\r\n\\x0a*\r\nartifact_prefix='/Users/adrianseyboldt/git/seq_io/fuzz/artifacts/single_thread/'; Test unit written to /Users/adrianseyboldt/git/seq_io/fuzz/artifacts/single_thread/crash-f9583eb831f52cfe1fd177744a6b511382ab8df6\r\nBase64: Cio=\r\n```\r\n\r\n</details>\r\n\r\nI'm the fastq-rs author by the way. I love what you've been doing with seq_io. :-)", "reactions": {"url": "https://api.github.com/repos/markschl/seq_io/issues/2/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/markschl/seq_io/issues/2/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]