[{"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/986", "repository_url": "https://api.github.com/repos/sourmash-bio/sourmash", "labels_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/986/labels{/name}", "comments_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/986/comments", "events_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/986/events", "html_url": "https://github.com/sourmash-bio/sourmash/pull/986", "id": 615538444, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE1ODI3NTAz", "number": 986, "title": "[MRG] Hide internal representation in core, and update FFI and cbindgen", "user": {"login": "luizirber", "id": 6642, "node_id": "MDQ6VXNlcjY2NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/6642?v=4", "gravatar_id": "", "url": "https://api.github.com/users/luizirber", "html_url": "https://github.com/luizirber", "followers_url": "https://api.github.com/users/luizirber/followers", "following_url": "https://api.github.com/users/luizirber/following{/other_user}", "gists_url": "https://api.github.com/users/luizirber/gists{/gist_id}", "starred_url": "https://api.github.com/users/luizirber/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/luizirber/subscriptions", "organizations_url": "https://api.github.com/users/luizirber/orgs", "repos_url": "https://api.github.com/users/luizirber/repos", "events_url": "https://api.github.com/users/luizirber/events{/privacy}", "received_events_url": "https://api.github.com/users/luizirber/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2020-05-11T02:09:18Z", "updated_at": "2020-05-12T16:08:34Z", "closed_at": "2020-05-12T16:08:03Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/pulls/986", "html_url": "https://github.com/sourmash-bio/sourmash/pull/986", "diff_url": "https://github.com/sourmash-bio/sourmash/pull/986.diff", "patch_url": "https://github.com/sourmash-bio/sourmash/pull/986.patch", "merged_at": "2020-05-12T16:08:03Z"}, "body": "My younger self used a lot of `pub(crate)` as shortcuts doing the Rust `core` crate prototyping, time to reverse it. (This also allows changing internal representations more easily in the future).\r\n\r\nAdditionally, `cbindgen` generation for the C header in `include/sourmash.h` was broken for a long time, finally figured out why, This also adds CI to check and avoid breaking it again.\r\n\r\nFinally, [symbolic](https://github.com/getsentry/symbolic/commit/8d62b84e91b4ef52fed91d5776386f9374199538#diff-fb71e16c946a8e4ba3a70f2b22b03e26) updated their FFI, and there are many useful things for us too. Especially the `ForeignObject` trait, which avoids a lot of code repetition (and makes it easier to modify behavior and refactor).\r\n\r\n## TODO:\r\n\r\n- [x] add instructions to dev docs about cbindgen and when to call it\r\n- [-] ~start documenting `src/core/src/ffi/*`, since the documentation will show up in `include/sourmash.h` now.~ -> https://github.com/dib-lab/sourmash/issues/988\r\n- [x] check that the regenerated C header in CI matches what is in the repo, because it is an error if they differ (forgot to add changes to the new C header to the repo)\r\n\r\n## Checklist\r\n\r\n- [x] Is it mergeable?\r\n- [x] `make test` Did it pass the tests?\r\n- [x] `make coverage` Is the new code covered?\r\n- [x] Did it change the command-line interface? Only additions are allowed\r\n  without a major version increment. Changing file formats also requires a\r\n  major version number increment.\r\n- [x] Was a spellchecker run on the source code and documentation after\r\n  changes were made?\r\n", "reactions": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/986/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/986/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/981", "repository_url": "https://api.github.com/repos/sourmash-bio/sourmash", "labels_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/981/labels{/name}", "comments_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/981/comments", "events_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/981/events", "html_url": "https://github.com/sourmash-bio/sourmash/pull/981", "id": 612018999, "node_id": "MDExOlB1bGxSZXF1ZXN0NDEzMDY0OTI4", "number": 981, "title": "fix enum34/python version mismatch more cleanly than #979", "user": {"login": "ctb", "id": 51016, "node_id": "MDQ6VXNlcjUxMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/51016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ctb", "html_url": "https://github.com/ctb", "followers_url": "https://api.github.com/users/ctb/followers", "following_url": "https://api.github.com/users/ctb/following{/other_user}", "gists_url": "https://api.github.com/users/ctb/gists{/gist_id}", "starred_url": "https://api.github.com/users/ctb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ctb/subscriptions", "organizations_url": "https://api.github.com/users/ctb/orgs", "repos_url": "https://api.github.com/users/ctb/repos", "events_url": "https://api.github.com/users/ctb/events{/privacy}", "received_events_url": "https://api.github.com/users/ctb/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2020-05-04T16:50:06Z", "updated_at": "2020-05-04T17:19:48Z", "closed_at": "2020-05-04T17:19:42Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/pulls/981", "html_url": "https://github.com/sourmash-bio/sourmash/pull/981", "diff_url": "https://github.com/sourmash-bio/sourmash/pull/981.diff", "patch_url": "https://github.com/sourmash-bio/sourmash/pull/981.patch", "merged_at": "2020-05-04T17:19:42Z"}, "body": "specify python versions for which enum34 should be installed.\r\n\r\nref #979 \r\nfixes #980\r\n\r\n- [ ] Is it mergeable?\r\n- [ ] `make test` Did it pass the tests?\r\n- [ ] `make coverage` Is the new code covered?\r\n- [ ] Did it change the command-line interface? Only additions are allowed\r\n  without a major version increment. Changing file formats also requires a\r\n  major version number increment.\r\n- [ ] Was a spellchecker run on the source code and documentation after\r\n  changes were made?\r\n", "reactions": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/981/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/981/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/979", "repository_url": "https://api.github.com/repos/sourmash-bio/sourmash", "labels_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/979/labels{/name}", "comments_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/979/comments", "events_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/979/events", "html_url": "https://github.com/sourmash-bio/sourmash/pull/979", "id": 611993242, "node_id": "MDExOlB1bGxSZXF1ZXN0NDEzMDQ0NTUx", "number": 979, "title": "[MRG] switch to enum-compat instead of enum34", "user": {"login": "ctb", "id": 51016, "node_id": "MDQ6VXNlcjUxMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/51016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ctb", "html_url": "https://github.com/ctb", "followers_url": "https://api.github.com/users/ctb/followers", "following_url": "https://api.github.com/users/ctb/following{/other_user}", "gists_url": "https://api.github.com/users/ctb/gists{/gist_id}", "starred_url": "https://api.github.com/users/ctb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ctb/subscriptions", "organizations_url": "https://api.github.com/users/ctb/orgs", "repos_url": "https://api.github.com/users/ctb/repos", "events_url": "https://api.github.com/users/ctb/events{/privacy}", "received_events_url": "https://api.github.com/users/ctb/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2020-05-04T16:09:03Z", "updated_at": "2020-05-04T16:09:20Z", "closed_at": "2020-05-04T16:09:15Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/pulls/979", "html_url": "https://github.com/sourmash-bio/sourmash/pull/979", "diff_url": "https://github.com/sourmash-bio/sourmash/pull/979.diff", "patch_url": "https://github.com/sourmash-bio/sourmash/pull/979.patch", "merged_at": "2020-05-04T16:09:15Z"}, "body": "When setting up a v3.3.0 release, I ran into a problem with enum34 and python version incompatibilities -- briefly, when installing enum34 with pip install, I get\r\n\r\n```\r\nAttributeError: module 'enum' has no attribute 'IntFlag'  \r\n``\r\n\r\nThis uses the [enum-compat package as a solution, via StackOverflow](https://stackoverflow.com/questions/43124775/why-python-3-6-1-throws-attributeerror-module-enum-has-no-attribute-intflag).\r\n\r\n@luizirber approved this via slack :)\r\n\r\n---\r\n\r\n- [ ] Is it mergeable?\r\n- [ ] `make test` Did it pass the tests?\r\n- [ ] `make coverage` Is the new code covered?\r\n- [ ] Did it change the command-line interface? Only additions are allowed\r\n  without a major version increment. Changing file formats also requires a\r\n  major version number increment.\r\n- [ ] Was a spellchecker run on the source code and documentation after\r\n  changes were made?\r\n", "reactions": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/979/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/979/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/975", "repository_url": "https://api.github.com/repos/sourmash-bio/sourmash", "labels_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/975/labels{/name}", "comments_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/975/comments", "events_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/975/events", "html_url": "https://github.com/sourmash-bio/sourmash/pull/975", "id": 609990112, "node_id": "MDExOlB1bGxSZXF1ZXN0NDExNDk1MTEw", "number": 975, "title": "[MRG] upgrade sourmash index usage docs on CLI", "user": {"login": "ctb", "id": 51016, "node_id": "MDQ6VXNlcjUxMDE2", "avatar_url": "https://avatars.githubusercontent.com/u/51016?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ctb", "html_url": "https://github.com/ctb", "followers_url": "https://api.github.com/users/ctb/followers", "following_url": "https://api.github.com/users/ctb/following{/other_user}", "gists_url": "https://api.github.com/users/ctb/gists{/gist_id}", "starred_url": "https://api.github.com/users/ctb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ctb/subscriptions", "organizations_url": "https://api.github.com/users/ctb/orgs", "repos_url": "https://api.github.com/users/ctb/repos", "events_url": "https://api.github.com/users/ctb/events{/privacy}", "received_events_url": "https://api.github.com/users/ctb/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-30T13:28:40Z", "updated_at": "2020-05-07T03:10:09Z", "closed_at": "2020-05-07T03:10:03Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/pulls/975", "html_url": "https://github.com/sourmash-bio/sourmash/pull/975", "diff_url": "https://github.com/sourmash-bio/sourmash/pull/975.diff", "patch_url": "https://github.com/sourmash-bio/sourmash/pull/975.patch", "merged_at": "2020-05-07T03:10:02Z"}, "body": "Adds a `compute`-like usage output for `sourmash index`. In particular, mentions `.sbt.zip` behavior.\r\n\r\nPartly addresses #973 \r\n\r\n- [x] Is it mergeable?\r\n- [x] `make test` Did it pass the tests?\r\n- [x] `make coverage` Is the new code covered?\r\n- [x] Did it change the command-line interface? Only additions are allowed\r\n  without a major version increment. Changing file formats also requires a\r\n  major version number increment.\r\n- [x] Was a spellchecker run on the source code and documentation after\r\n  changes were made?\r\n", "reactions": {"url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/975/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/sourmash-bio/sourmash/issues/975/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]