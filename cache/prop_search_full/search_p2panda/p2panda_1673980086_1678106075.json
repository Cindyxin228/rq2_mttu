[{"url": "https://api.github.com/repos/p2panda/p2panda/issues/486", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/486/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/486/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/486/events", "html_url": "https://github.com/p2panda/p2panda/pull/486", "id": 1605017663, "node_id": "PR_kwDOEhZKfs5LCMXN", "number": 486, "title": "Validate schema for UPDATE operations", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-03-01T13:53:35Z", "updated_at": "2023-03-06T09:08:34Z", "closed_at": "2023-03-06T09:08:31Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/486", "html_url": "https://github.com/p2panda/p2panda/pull/486", "diff_url": "https://github.com/p2panda/p2panda/pull/486.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/486.patch", "merged_at": "2023-03-06T09:08:31Z"}, "body": "When an operation arrives via `publish` we validate it's contained fields match the claimed schema, but when it's an UPDATE (therefore being applied to an existing document) we don't check if it's claimed schema matches that of the existing document.\r\n\r\nThis PR adds that validation step.\r\n\r\ncloses: https://github.com/p2panda/aquadoggo/issues/50\r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/486/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/486/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/485", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/485/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/485/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/485/events", "html_url": "https://github.com/p2panda/p2panda/pull/485", "id": 1599879672, "node_id": "PR_kwDOEhZKfs5Kw9VQ", "number": 485, "title": "Add `commit` method on document", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-26T00:08:18Z", "updated_at": "2023-02-28T14:21:37Z", "closed_at": "2023-02-28T14:21:22Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/485", "html_url": "https://github.com/p2panda/p2panda/pull/485", "diff_url": "https://github.com/p2panda/p2panda/pull/485.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/485.patch", "merged_at": "2023-02-28T14:21:22Z"}, "body": ":tada: \r\n\r\n- `commit` method on `Document` / `AsDocument` which allows applying operations incrementally on an already constructed document\r\n- refactoring of `is_edited` and `is_deleted` patterns\r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/485/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/485/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/483", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/483/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/483/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/483/events", "html_url": "https://github.com/p2panda/p2panda/pull/483", "id": 1596649731, "node_id": "PR_kwDOEhZKfs5KmGhl", "number": 483, "title": "Expose `publish` and `next_args` publicly in new `api` module", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-23T11:04:04Z", "updated_at": "2023-03-06T09:48:04Z", "closed_at": "2023-02-27T11:03:40Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/483", "html_url": "https://github.com/p2panda/p2panda/pull/483", "diff_url": "https://github.com/p2panda/p2panda/pull/483.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/483.patch", "merged_at": "2023-02-27T11:03:40Z"}, "body": "`domain` and `validation` modules are where the public (non-query) api for a p2panda node is defined. Currently they are defined in `aquadoggo` where they are used behind the graphQL api and also in the `p2panda-rs` test utilities. This PR exposes the methods publicly in `p2panda-rs` in a new `api` module which allows them to be imported for both use cases. It also paves the way for them to be used in other storage provider implementations in the future and demonstrates the specified validation flows clearly in the main p2panda repo.  \r\n\r\n- [x] introduce public `api` module and move `domain` and `validation` there\r\n- [x] move methods from `domain` into `publish` and `next_args` modules\r\n- [x] refactor `publish` and `next_args` for improved readability\r\n\r\nNext steps following this PR are to add additional validation steps we are currently missing: https://github.com/p2panda/aquadoggo/issues/250 https://github.com/p2panda/aquadoggo/issues/50\r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/483/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/483/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/481", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/481/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/481/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/481/events", "html_url": "https://github.com/p2panda/p2panda/pull/481", "id": 1590889906, "node_id": "PR_kwDOEhZKfs5KS2o5", "number": 481, "title": "Introduce `SchemaName` `SchemaDescription` and `SchemaFields` structs", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-02-19T22:48:49Z", "updated_at": "2023-02-28T14:27:38Z", "closed_at": "2023-02-28T14:27:34Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/481", "html_url": "https://github.com/p2panda/p2panda/pull/481", "diff_url": "https://github.com/p2panda/p2panda/pull/481.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/481.patch", "merged_at": "2023-02-28T14:27:34Z"}, "body": "This PR introduces three new types which provide validation, checking adherence to the specification requirements, in the construction of `Schema`s. The new types are `SchemaName`, `SchemaDescription` and `SchemaFields` each of which has a `validation` method which performs all required validation steps and is called in each structs constructor. Using these types in the constructor of `Schema` ensures validation occurs as expected.\r\n\r\nAn additional change included in this PR is to add checks for any additional fields which might exist (but currently be ignored) when converting generic `DocumentViews` into specialised `SchemaDefinitionView` and `SchemaFieldDefinition` views.\r\n\r\nNOTE: There are three distinct validation flows all relating to validating the fields of schema-like objects. One is dealing with `PlainOperation`s, one is dealing with the construction of `Schema` and one is dealing with conversion of `DocumuntView`s into system schema views. Each flow has their own errors and validation methods. This is a little confusing and could maybe be simplified if the methods became more generic. It seemed out of scope to tackle all that (the operation validation flow in particular is dense) but I raise a refactoring issue https://github.com/p2panda/p2panda/issues/482.\r\n\r\ncloses: https://github.com/p2panda/p2panda/issues/426 https://github.com/p2panda/handbook/issues/220 #238 \r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/481/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/481/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/480", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/480/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/480/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/480/events", "html_url": "https://github.com/p2panda/p2panda/pull/480", "id": 1590341998, "node_id": "PR_kwDOEhZKfs5KRPPz", "number": 480, "title": "Check invalid schema names in plain operation deserialization tests", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-18T13:13:09Z", "updated_at": "2023-02-21T23:24:05Z", "closed_at": "2023-02-21T15:17:45Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/480", "html_url": "https://github.com/p2panda/p2panda/pull/480", "diff_url": "https://github.com/p2panda/p2panda/pull/480.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/480.patch", "merged_at": "2023-02-21T15:17:45Z"}, "body": "Just add some tests to show that schema name validation occurs during operation deserialization.\r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/480/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/480/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/478", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/478/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/478/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/478/events", "html_url": "https://github.com/p2panda/p2panda/pull/478", "id": 1589088746, "node_id": "PR_kwDOEhZKfs5KNEmn", "number": 478, "title": "Typed errors in `domain` and `validation` modules", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-02-17T10:08:32Z", "updated_at": "2023-02-21T13:03:04Z", "closed_at": "2023-02-21T12:31:01Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/478", "html_url": "https://github.com/p2panda/p2panda/pull/478", "diff_url": "https://github.com/p2panda/p2panda/pull/478.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/478.patch", "merged_at": "2023-02-21T12:31:01Z"}, "body": "This PR introduces typed errors (instead of `anyhow` errors) to the `domain` and `validation` modules.\r\n\r\nbonuses:\r\n- removes TODOs which are now issues \r\n- brings across some small changes made in the equivalent `aquadoggo` modules\r\n- removes response types, we don't need them\r\n\r\nThese are currently only used in tests but we want to export them publicly for use in `aquadoggo` and we need nice error handling in line with the rest of the crate before doing so, this is outlined more here: https://github.com/p2panda/p2panda/issues/479\r\n\r\ncloses: https://github.com/p2panda/p2panda/issues/466\r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/478/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/478/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/476", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/476/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/476/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/476/events", "html_url": "https://github.com/p2panda/p2panda/pull/476", "id": 1582643145, "node_id": "PR_kwDOEhZKfs5J3Yew", "number": 476, "title": "Update TypeScript and Rust dependencies", "user": {"login": "adzialocha", "id": 1822473, "node_id": "MDQ6VXNlcjE4MjI0NzM=", "avatar_url": "https://avatars.githubusercontent.com/u/1822473?v=4", "gravatar_id": "", "url": "https://api.github.com/users/adzialocha", "html_url": "https://github.com/adzialocha", "followers_url": "https://api.github.com/users/adzialocha/followers", "following_url": "https://api.github.com/users/adzialocha/following{/other_user}", "gists_url": "https://api.github.com/users/adzialocha/gists{/gist_id}", "starred_url": "https://api.github.com/users/adzialocha/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/adzialocha/subscriptions", "organizations_url": "https://api.github.com/users/adzialocha/orgs", "repos_url": "https://api.github.com/users/adzialocha/repos", "events_url": "https://api.github.com/users/adzialocha/events{/privacy}", "received_events_url": "https://api.github.com/users/adzialocha/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-02-13T16:11:38Z", "updated_at": "2023-02-22T16:23:44Z", "closed_at": "2023-02-22T16:20:24Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/476", "html_url": "https://github.com/p2panda/p2panda/pull/476", "diff_url": "https://github.com/p2panda/p2panda/pull/476.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/476.patch", "merged_at": "2023-02-22T16:20:24Z"}, "body": "Update TypeScript and Rust dependencies to latest versions.\r\n\r\nRequired changes to make updates work:\r\n\r\n* Exclude benchmark-related dependencies to make `wasm-pack` tests work again\r\n* Adjust `rollup` config after default configs got changed in v3 :vomiting_face: \r\n* Use official and latest `replace` and `terser` rollup plugins\r\n* `rstest` templates do not need to be explicitly exported\r\n\r\nCloses: #477 \r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/476/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/476/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/p2panda/p2panda/issues/469", "repository_url": "https://api.github.com/repos/p2panda/p2panda", "labels_url": "https://api.github.com/repos/p2panda/p2panda/issues/469/labels{/name}", "comments_url": "https://api.github.com/repos/p2panda/p2panda/issues/469/comments", "events_url": "https://api.github.com/repos/p2panda/p2panda/issues/469/events", "html_url": "https://github.com/p2panda/p2panda/pull/469", "id": 1509472123, "node_id": "PR_kwDOEhZKfs5GIHDq", "number": 469, "title": "Storage trait API changes", "user": {"login": "sandreae", "id": 24291662, "node_id": "MDQ6VXNlcjI0MjkxNjYy", "avatar_url": "https://avatars.githubusercontent.com/u/24291662?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandreae", "html_url": "https://github.com/sandreae", "followers_url": "https://api.github.com/users/sandreae/followers", "following_url": "https://api.github.com/users/sandreae/following{/other_user}", "gists_url": "https://api.github.com/users/sandreae/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandreae/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandreae/subscriptions", "organizations_url": "https://api.github.com/users/sandreae/orgs", "repos_url": "https://api.github.com/users/sandreae/repos", "events_url": "https://api.github.com/users/sandreae/events{/privacy}", "received_events_url": "https://api.github.com/users/sandreae/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-12-23T15:34:04Z", "updated_at": "2023-02-21T12:23:51Z", "closed_at": "2023-02-09T17:16:03Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/p2panda/p2panda/pulls/469", "html_url": "https://github.com/p2panda/p2panda/pull/469", "diff_url": "https://github.com/p2panda/p2panda/pull/469.diff", "patch_url": "https://github.com/p2panda/p2panda/pull/469.patch", "merged_at": "2023-02-09T17:16:03Z"}, "body": "Part of one of the \"code love\" NLNet milestones, deals with some left over issues around improving the API of our storage traits. Original API change suggestions were being tracked here: [#149](https://github.com/p2panda/aquadoggo/issues/149)\r\n\r\nLooking at these now after some time I spotted one or two interface design decisions which could be improved on, in particular in the `DocumentStore` API which inadvertently introduced a concept of a cache layer, which is not wanted/needed in p2panda-rs. More on that here: #468 .\r\n\r\nThe general name of the game is: make it simple, less is more, only define what we really need.\r\n\r\nI want it to be as easy as possible to implement these storage traits for other backends while still satisfying our storage requirements for our core data types `Entry` and `Operation`. \r\n\r\n## Changes\r\n- [x] remove `StorageLog` struct/trait in favour of passing individual parameters\r\n- [x] general renaming of badly named methods\r\n- [x] remove `next_log_id` method which was too smart and has been moved to the `validation` module\r\n- [x] move remaining top level method to it's store\r\n- [x] remove `StorageProvider` trait completely (!) in favour of requiring individual storage traits which encourages separation of concerns.\r\n- [x] remove any concept of \"caching\" documents and views from `DocumentStore` only leave basic \"get\" methods which have default trait methods which require `OperationStore` and internally materialise docs each time they're called (inefficient, but no cache!)\r\n- [x] already introduce `WithId<T>` trait\r\n- [x] refactor out test database structs in favour of manually populating `MemoryStore` in tests\r\n- [x] remove use of blanket conversion trait implementations for `Entry` and `EncodedEntry` (this is, apparently, not very \"rusty\" (i can see why))\r\n  - to do this we make `domain`, and all `validation` methods generic over `AsEntry` and `AsEncodedEntry`\r\n- [x] remove `EntryWithOperation` trait which is no longer needed\r\n- [x] better docs to reflect all this\r\n- [x] more tests, especially in `DocumentStore` \r\n\r\ncloses: #468 ` aquadoggo: [#149](https://github.com/p2panda/aquadoggo/issues/149) [#203](https://github.com/p2panda/aquadoggo/issues/203)\r\n\r\n## \ud83d\udccb Checklist\r\n\r\n- [x] Add tests that cover your changes\r\n- [x] Add this PR to the _Unreleased_ section in `CHANGELOG.md`\r\n- [x] Link this PR to any issues it closes\r\n- [x] New files contain a SPDX license header\r\n- [x] Check if descriptions and terminology match `handbook` content (and visa-versa) \r\n", "reactions": {"url": "https://api.github.com/repos/p2panda/p2panda/issues/469/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/p2panda/p2panda/issues/469/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]