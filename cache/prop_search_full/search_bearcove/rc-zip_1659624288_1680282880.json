[{"url": "https://api.github.com/repos/bearcove/rc-zip/issues/23", "repository_url": "https://api.github.com/repos/bearcove/rc-zip", "labels_url": "https://api.github.com/repos/bearcove/rc-zip/issues/23/labels{/name}", "comments_url": "https://api.github.com/repos/bearcove/rc-zip/issues/23/comments", "events_url": "https://api.github.com/repos/bearcove/rc-zip/issues/23/events", "html_url": "https://github.com/bearcove/rc-zip/pull/23", "id": 1649565495, "node_id": "PR_kwDOC64qZ85NXQXC", "number": 23, "title": "Don't depend on positioned-io in rc-zip", "user": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-03-31T15:19:07Z", "updated_at": "2023-03-31T15:23:57Z", "closed_at": "2023-03-31T15:23:57Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/bearcove/rc-zip/pulls/23", "html_url": "https://github.com/bearcove/rc-zip/pull/23", "diff_url": "https://github.com/bearcove/rc-zip/pull/23.diff", "patch_url": "https://github.com/bearcove/rc-zip/pull/23.patch", "merged_at": "2023-03-31T15:23:57Z"}, "body": "Closes #16\r\n\r\nIntroduces `HasCursor` and implements it on `Vec<u8>` and `&[u8]` (also `std::fs::File` if both the \"sync\" and \"file\" features are enabled).\r\n\r\nThis should make it usable from wasm.", "reactions": {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/23/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/bearcove/rc-zip/issues/23/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/22", "repository_url": "https://api.github.com/repos/bearcove/rc-zip", "labels_url": "https://api.github.com/repos/bearcove/rc-zip/issues/22/labels{/name}", "comments_url": "https://api.github.com/repos/bearcove/rc-zip/issues/22/comments", "events_url": "https://api.github.com/repos/bearcove/rc-zip/issues/22/events", "html_url": "https://github.com/bearcove/rc-zip/pull/22", "id": 1649483565, "node_id": "PR_kwDOC64qZ85NW-Fe", "number": 22, "title": "Add a lil' heuristic to decide between CP437 and Shift-JIS", "user": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-03-31T14:41:32Z", "updated_at": "2023-03-31T14:51:12Z", "closed_at": "2023-03-31T14:51:12Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/bearcove/rc-zip/pulls/22", "html_url": "https://github.com/bearcove/rc-zip/pull/22", "diff_url": "https://github.com/bearcove/rc-zip/pull/22.diff", "patch_url": "https://github.com/bearcove/rc-zip/pull/22.patch", "merged_at": "2023-03-31T14:51:12Z"}, "body": "This closes #15 ", "reactions": {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/22/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/bearcove/rc-zip/issues/22/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/21", "repository_url": "https://api.github.com/repos/bearcove/rc-zip", "labels_url": "https://api.github.com/repos/bearcove/rc-zip/issues/21/labels{/name}", "comments_url": "https://api.github.com/repos/bearcove/rc-zip/issues/21/comments", "events_url": "https://api.github.com/repos/bearcove/rc-zip/issues/21/events", "html_url": "https://github.com/bearcove/rc-zip/pull/21", "id": 1649378769, "node_id": "PR_kwDOC64qZ85NWnYs", "number": 21, "title": "Closes #5 (have the sync API be higher-level)", "user": {"login": "fasterthanlime", "id": 7998310, "node_id": "MDQ6VXNlcjc5OTgzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7998310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fasterthanlime", "html_url": "https://github.com/fasterthanlime", "followers_url": "https://api.github.com/users/fasterthanlime/followers", "following_url": "https://api.github.com/users/fasterthanlime/following{/other_user}", "gists_url": "https://api.github.com/users/fasterthanlime/gists{/gist_id}", "starred_url": "https://api.github.com/users/fasterthanlime/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fasterthanlime/subscriptions", "organizations_url": "https://api.github.com/users/fasterthanlime/orgs", "repos_url": "https://api.github.com/users/fasterthanlime/repos", "events_url": "https://api.github.com/users/fasterthanlime/events{/privacy}", "received_events_url": "https://api.github.com/users/fasterthanlime/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-03-31T13:41:39Z", "updated_at": "2023-03-31T13:52:37Z", "closed_at": "2023-03-31T13:52:37Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/bearcove/rc-zip/pulls/21", "html_url": "https://github.com/bearcove/rc-zip/pull/21", "diff_url": "https://github.com/bearcove/rc-zip/pull/21.diff", "patch_url": "https://github.com/bearcove/rc-zip/pull/21.patch", "merged_at": "2023-03-31T13:52:37Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/21/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/bearcove/rc-zip/issues/21/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/18", "repository_url": "https://api.github.com/repos/bearcove/rc-zip", "labels_url": "https://api.github.com/repos/bearcove/rc-zip/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/bearcove/rc-zip/issues/18/comments", "events_url": "https://api.github.com/repos/bearcove/rc-zip/issues/18/events", "html_url": "https://github.com/bearcove/rc-zip/pull/18", "id": 963490636, "node_id": "MDExOlB1bGxSZXF1ZXN0NzA2MDg3OTA0", "number": 18, "title": "Patch known ZIP attacks", "user": {"login": "mufeedvh", "id": 26198477, "node_id": "MDQ6VXNlcjI2MTk4NDc3", "avatar_url": "https://avatars.githubusercontent.com/u/26198477?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mufeedvh", "html_url": "https://github.com/mufeedvh", "followers_url": "https://api.github.com/users/mufeedvh/followers", "following_url": "https://api.github.com/users/mufeedvh/following{/other_user}", "gists_url": "https://api.github.com/users/mufeedvh/gists{/gist_id}", "starred_url": "https://api.github.com/users/mufeedvh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mufeedvh/subscriptions", "organizations_url": "https://api.github.com/users/mufeedvh/orgs", "repos_url": "https://api.github.com/users/mufeedvh/repos", "events_url": "https://api.github.com/users/mufeedvh/events{/privacy}", "received_events_url": "https://api.github.com/users/mufeedvh/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-08-08T18:37:08Z", "updated_at": "2023-01-10T12:58:41Z", "closed_at": "2023-01-10T12:58:41Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/bearcove/rc-zip/pulls/18", "html_url": "https://github.com/bearcove/rc-zip/pull/18", "diff_url": "https://github.com/bearcove/rc-zip/pull/18.diff", "patch_url": "https://github.com/bearcove/rc-zip/pull/18.patch", "merged_at": "2023-01-10T12:58:41Z"}, "body": "This patch handles ZIP attacks such as **Zip Slip** (system path traversal), **Symlink Traversal**, and **absolute path write** (`/<path>`) based on https://github.com/rust-compress/rc-zip/issues/17.\r\n\r\n<details>\r\n<summary><strong>Changes</strong></summary>\r\n\r\n#### 1. `unwrap()` on `do_main()` panicked when handling a ZIP file that is invalid or doesn't exist, this change handles that error.\r\n\r\nhttps://github.com/rust-compress/rc-zip/blob/c37846f0aab89626282eb1b8aa437373923e1d65/samples/jean/src/main.rs#L106-L109\r\n\r\n#### 2. This change handles the Zip Slip fix bypass mentioned in https://github.com/rust-compress/rc-zip/issues/17.\r\n\r\n> First, ../ should be stripped even on Windows. / is the zip file directory separator, regardless of the separator of the underlying filesystem (see appnote.txt 4.4.17).\r\n\r\n> Second, a file name may become a directory traversal after being transformed. For example, ..././escape.txt becomes ../escape.txt.\r\n\r\nhttps://github.com/rust-compress/rc-zip/blob/c37846f0aab89626282eb1b8aa437373923e1d65/samples/jean/src/main.rs#L229-L230\r\n\r\n#### 3. This fixes absolute path write attack on Windows.\r\n\r\n> File names starting with / are treated as absolute and can write outside the target directory. On Windows, prefixes like C:\\ and UNC paths like \\\\ComputerName\\ may also work.\r\n\r\nhttps://github.com/rust-compress/rc-zip/blob/c37846f0aab89626282eb1b8aa437373923e1d65/samples/jean/src/main.rs#L231-L236\r\n\r\n#### 4. This fixes absolute path write attack on Linux by stripping absolute path prefix and will write to the current directory.\r\n\r\nhttps://github.com/rust-compress/rc-zip/blob/c37846f0aab89626282eb1b8aa437373923e1d65/samples/jean/src/main.rs#L237-L245\r\n\r\n[**`unzip`**](http://infozip.sourceforge.net/UnZip.html) handle this the same way:\r\n\r\n[Permalink](https://github.com/LuaDist/unzip/blob/master/extract.c#L1341-L1346)\r\n```c\r\ndo {\r\n    char *p = G.filename + 1;\r\n    do {\r\n        *(p-1) = *p;\r\n    } while (*p++ != '\\0');\r\n} while (G.filename[0] == '/');\r\n```\r\n\r\n#### 5. This fixes **Symlink Traversal** attacks attempting to write files outside the target directory.\r\n\r\n> One entry may be a directory symbolic link pointing outside the target directory, and a later entry may write through the symlink.\r\n> This is like [CVE-2002-1216](https://nvd.nist.gov/vuln/detail/CVE-2002-1216) in GNU Tar.\r\n\r\nhttps://github.com/rust-compress/rc-zip/blob/c37846f0aab89626282eb1b8aa437373923e1d65/samples/jean/src/main.rs#L285-L287\r\n\r\n#### 6. Removing an already existing path while handling symlink panics if the path is not a `file` since there were no checks before `std::fs::remove_file(&path)`.\r\n\r\nhttps://github.com/rust-compress/rc-zip/blob/c37846f0aab89626282eb1b8aa437373923e1d65/samples/jean/src/main.rs#L273-L275\r\n</details>\r\n\r\nAs far as I've tested, this fixes https://github.com/rust-compress/rc-zip/issues/17.\r\n\r\n---\r\n\r\nHey @l4AgXc, can you please take a look and see if it looks good? :raised_hands:", "reactions": {"url": "https://api.github.com/repos/bearcove/rc-zip/issues/18/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/bearcove/rc-zip/issues/18/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]