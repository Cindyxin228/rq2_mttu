{"window": ["2020-11-18T21:04:16.204386+00:00", "2022-04-07T15:32:41.641651+00:00"], "repo_slug": "wezterm/wezterm", "candidates": [{"url": "https://api.github.com/repos/wezterm/wezterm/issues/1810", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/events", "html_url": "https://github.com/wezterm/wezterm/pull/1810", "id": 1190677980, "node_id": "PR_kwDOBy-5T841h9cR", "number": 1810, "title": "Added support for kitty images protocol using Shared Memory", "user": {"login": "tantei3", "id": 54449449, "node_id": "MDQ6VXNlcjU0NDQ5NDQ5", "avatar_url": "https://avatars.githubusercontent.com/u/54449449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tantei3", "html_url": "https://github.com/tantei3", "followers_url": "https://api.github.com/users/tantei3/followers", "following_url": "https://api.github.com/users/tantei3/following{/other_user}", "gists_url": "https://api.github.com/users/tantei3/gists{/gist_id}", "starred_url": "https://api.github.com/users/tantei3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tantei3/subscriptions", "organizations_url": "https://api.github.com/users/tantei3/orgs", "repos_url": "https://api.github.com/users/tantei3/repos", "events_url": "https://api.github.com/users/tantei3/events{/privacy}", "received_events_url": "https://api.github.com/users/tantei3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-04-02T16:30:52Z", "updated_at": "2025-08-06T10:25:27Z", "closed_at": "2022-04-03T19:59:58Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1810", "html_url": "https://github.com/wezterm/wezterm/pull/1810", "diff_url": "https://github.com/wezterm/wezterm/pull/1810.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1810.patch", "merged_at": "2022-04-03T19:59:58Z"}, "body": "Allows reading data via shared memory on both Unix and Windows. Adds support for tasks 9 and 10 from issue 986 related to Kitty Image Protocol. Tested on Linux and on Windows 10 (Had to split the below script into two different parts and run the command via wezterm ssh) using the below python script:\r\n```python\r\nimport sys\r\nfrom base64 import b64encode\r\nfrom multiprocessing import shared_memory\r\nfrom time import sleep\r\n\r\nwidth = 1920\r\nheight = 1080\r\ndepth = 4\r\nsize = width * height * depth\r\nshm = shared_memory.SharedMemory(create=True, name=\"myshm\", size = size)\r\nimg = shm.buf\r\n\r\nfor row in range(height):\r\n    for col in range(width):\r\n        img[(row * width + col) * 4 + 0] = int(255 / (height + 1) * row) # red\r\n        img[(row * width + col) * 4 + 1] = int(255 / (width + 1) * col) # green\r\n        img[(row * width + col) * 4 + 2] = 255 # blue\r\n        img[(row * width + col) * 4 + 3] = 255\r\n\r\ncontrol_data = b'\\033_Ga=T,f=32,t=s,s=' + str(width).encode() + b',v=' + str(height).encode() + b';'\r\nend_sequence = b\"\\033\\\\\"\r\nstring = control_data + b64encode(b\"myshm\") + end_sequence\r\nsys.stdout.buffer.write(string)\r\nsys.stdout.flush()\r\nsleep(5)\r\nprint(\"Exiting\")\r\n```", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/reactions", "total_count": 6, "+1": 3, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 1, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1689", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1689/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1689/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1689/events", "html_url": "https://github.com/wezterm/wezterm/pull/1689", "id": 1160756215, "node_id": "PR_kwDOBy-5T840Al3w", "number": 1689, "title": "Use newer windows crate", "user": {"login": "davidrios", "id": 1418372, "node_id": "MDQ6VXNlcjE0MTgzNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1418372?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidrios", "html_url": "https://github.com/davidrios", "followers_url": "https://api.github.com/users/davidrios/followers", "following_url": "https://api.github.com/users/davidrios/following{/other_user}", "gists_url": "https://api.github.com/users/davidrios/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidrios/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidrios/subscriptions", "organizations_url": "https://api.github.com/users/davidrios/orgs", "repos_url": "https://api.github.com/users/davidrios/repos", "events_url": "https://api.github.com/users/davidrios/events{/privacy}", "received_events_url": "https://api.github.com/users/davidrios/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-03-07T00:04:19Z", "updated_at": "2022-03-11T15:40:45Z", "closed_at": "2022-03-11T15:40:39Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1689", "html_url": "https://github.com/wezterm/wezterm/pull/1689", "diff_url": "https://github.com/wezterm/wezterm/pull/1689.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1689.patch", "merged_at": "2022-03-11T15:40:39Z"}, "body": "Upgrade the windows crate version to 0.33.0.\r\n\r\nThis is in anticipation of its use in another PR, and also it's future-proof.", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1689/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1689/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1534", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1534/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1534/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1534/events", "html_url": "https://github.com/wezterm/wezterm/pull/1534", "id": 1099917514, "node_id": "PR_kwDOBy-5T84w1iPI", "number": 1534, "title": "FEATURE: Allow ScrollByPage f64 values", "user": {"login": "hahuang65", "id": 280972, "node_id": "MDQ6VXNlcjI4MDk3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/280972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hahuang65", "html_url": "https://github.com/hahuang65", "followers_url": "https://api.github.com/users/hahuang65/followers", "following_url": "https://api.github.com/users/hahuang65/following{/other_user}", "gists_url": "https://api.github.com/users/hahuang65/gists{/gist_id}", "starred_url": "https://api.github.com/users/hahuang65/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hahuang65/subscriptions", "organizations_url": "https://api.github.com/users/hahuang65/orgs", "repos_url": "https://api.github.com/users/hahuang65/repos", "events_url": "https://api.github.com/users/hahuang65/events{/privacy}", "received_events_url": "https://api.github.com/users/hahuang65/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2022-01-12T06:07:03Z", "updated_at": "2022-01-13T01:01:38Z", "closed_at": "2022-01-13T01:01:38Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1534", "html_url": "https://github.com/wezterm/wezterm/pull/1534", "diff_url": "https://github.com/wezterm/wezterm/pull/1534.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1534.patch", "merged_at": "2022-01-13T01:01:38Z"}, "body": "`ScrollByPage` can accept non-integer values in the configuration.\r\nThis allows fractional page scrolling, such as by half a page.\r\n\r\nThe default remains the same, at 1 page.", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1534/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1534/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1415", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1415/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1415/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1415/events", "html_url": "https://github.com/wezterm/wezterm/pull/1415", "id": 1083740262, "node_id": "PR_kwDOBy-5T84wBznn", "number": 1415, "title": "Support gating libssh-rs and ssh2 behind features of same name", "user": {"login": "chipsenkbeil", "id": 2481802, "node_id": "MDQ6VXNlcjI0ODE4MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2481802?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chipsenkbeil", "html_url": "https://github.com/chipsenkbeil", "followers_url": "https://api.github.com/users/chipsenkbeil/followers", "following_url": "https://api.github.com/users/chipsenkbeil/following{/other_user}", "gists_url": "https://api.github.com/users/chipsenkbeil/gists{/gist_id}", "starred_url": "https://api.github.com/users/chipsenkbeil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chipsenkbeil/subscriptions", "organizations_url": "https://api.github.com/users/chipsenkbeil/orgs", "repos_url": "https://api.github.com/users/chipsenkbeil/repos", "events_url": "https://api.github.com/users/chipsenkbeil/events{/privacy}", "received_events_url": "https://api.github.com/users/chipsenkbeil/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2021-12-18T04:04:58Z", "updated_at": "2022-04-18T23:23:11Z", "closed_at": "2022-01-10T03:36:56Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1415", "html_url": "https://github.com/wezterm/wezterm/pull/1415", "diff_url": "https://github.com/wezterm/wezterm/pull/1415.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1415.patch", "merged_at": "2022-01-10T03:36:56Z"}, "body": "Moves libssh-rs and ssh2 backends to be gated by features of the same name. This enables building wezterm-ssh with only one of two dependencies, getting around problems with compiling both for a cdylib target.\r\n\r\nYou can verify that each backend works by running with `cargo test --no-default-features --features libssh-rs` and `cargo test --no-default-features --features ssh2` from within the wezterm-ssh directory. If `libssh-rs` is not present, then the backend will be switched to `ssh2`.", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1415/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1415/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1167", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1167/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1167/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1167/events", "html_url": "https://github.com/wezterm/wezterm/pull/1167", "id": 1006708811, "node_id": "PR_kwDOBy-5T84sQFjl", "number": 1167, "title": "Extend wezterm-ssh with Sftp functionality", "user": {"login": "chipsenkbeil", "id": 2481802, "node_id": "MDQ6VXNlcjI0ODE4MDI=", "avatar_url": "https://avatars.githubusercontent.com/u/2481802?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chipsenkbeil", "html_url": "https://github.com/chipsenkbeil", "followers_url": "https://api.github.com/users/chipsenkbeil/followers", "following_url": "https://api.github.com/users/chipsenkbeil/following{/other_user}", "gists_url": "https://api.github.com/users/chipsenkbeil/gists{/gist_id}", "starred_url": "https://api.github.com/users/chipsenkbeil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chipsenkbeil/subscriptions", "organizations_url": "https://api.github.com/users/chipsenkbeil/orgs", "repos_url": "https://api.github.com/users/chipsenkbeil/repos", "events_url": "https://api.github.com/users/chipsenkbeil/events{/privacy}", "received_events_url": "https://api.github.com/users/chipsenkbeil/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 12, "created_at": "2021-09-24T18:08:21Z", "updated_at": "2021-10-10T21:54:45Z", "closed_at": "2021-10-10T21:54:45Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1167", "html_url": "https://github.com/wezterm/wezterm/pull/1167", "diff_url": "https://github.com/wezterm/wezterm/pull/1167.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1167.patch", "merged_at": "2021-10-10T21:54:45Z"}, "body": "Work-in-progress to extend wezterm-ssh with sftp functionality that I need for distant-ssh2.\r\n\r\nAt the moment, this does the following:\r\n\r\n1. Extends `SessionRequest` with additional requests for each type of sftp action that can be taken by using a new `Sftp` type\r\n2. Adds a `File` struct that implements `smol::io::{AsyncRead, AsyncWrite}`, communicating back to the session thread to perform the actions on `ssh2::File` instances\r\n3. Exposes a variety of dependency types that are directly used in public APIs to avoid consumers from needing to manually import those dependencies themselves\r\n    - `filedescriptor::FileDescriptor`, \r\n    - `portable_pty::Child`\r\n    - `ssh2::{FileStat, OpenFlags, OpenType, RenameFlags}`\r\n\r\nThis currently is not fully tested or working as there are a lot of async hangups that I need to debug. It may also be worth porting over some of the testing logic I've been implementing with sshd programmatically to use with this crate to maintain our sanity with it working as expected e2e.\r\n\r\n1. The design is a ~~flat exposure of `ssh2::Sftp` methods instead of returning an sftp channel directly, or some wrapper around the sftp channel~~ to use an `Sftp` struct that contains a `SessionSender` with methods geared directly towards sending sftp requests. \r\n    - **I switched to this approach** :: We could alternatively switch to returning an Sftp wrapper object (holding a `SessionSender`) with the methods exposed on it that just performs the sends, and that may be cleaner than having them all directly on the session. @wez, thoughts? We could have `SessionRequest` contain just an `Sftp(Sftp)` variant where the Sftp value is another enum containing the submessage, if we want to not have everything be entirely flat.\r\n    - Right now, we allocate a singular sftp channel upon first receiving an sftp-related message. I think this makes sense, but I don't know if there are any drawbacks. @wez?\r\n2. The design I've seen from the existing `SessionRequest` handlers is to include a `Sender<...>` to act as a reply for the async request. These don't handle sending back error information, so I don't know if that is done elsewhere. \r\n    - My only thought behind these not causing async to hang indefinitely is that the sender gets dropped at the end of the request regardless, but this doesn't communicate any specific error information to the async caller, does it?\r\n3. The file read/write I'm just calling directly in a blocking fashion. To be honest, your file descriptor and polling work was a little more than I wanted to read through last night, but I'm also not sure how much it applies and/or would work with `ssh2::File` from the sftp channel. @wez?", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1167/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1167/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1043", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1043/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1043/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1043/events", "html_url": "https://github.com/wezterm/wezterm/pull/1043", "id": 973776340, "node_id": "MDExOlB1bGxSZXF1ZXN0NzE1MTc2ODc0", "number": 1043, "title": "IME support on X11", "user": {"login": "H-M-H", "id": 7461564, "node_id": "MDQ6VXNlcjc0NjE1NjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7461564?v=4", "gravatar_id": "", "url": "https://api.github.com/users/H-M-H", "html_url": "https://github.com/H-M-H", "followers_url": "https://api.github.com/users/H-M-H/followers", "following_url": "https://api.github.com/users/H-M-H/following{/other_user}", "gists_url": "https://api.github.com/users/H-M-H/gists{/gist_id}", "starred_url": "https://api.github.com/users/H-M-H/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/H-M-H/subscriptions", "organizations_url": "https://api.github.com/users/H-M-H/orgs", "repos_url": "https://api.github.com/users/H-M-H/repos", "events_url": "https://api.github.com/users/H-M-H/events{/privacy}", "received_events_url": "https://api.github.com/users/H-M-H/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2021-08-18T15:00:47Z", "updated_at": "2021-08-20T03:51:56Z", "closed_at": "2021-08-20T03:51:56Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1043", "html_url": "https://github.com/wezterm/wezterm/pull/1043", "diff_url": "https://github.com/wezterm/wezterm/pull/1043.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1043.patch", "merged_at": "2021-08-20T03:51:56Z"}, "body": "Add support for Input Method Editors (IME) on X11.", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1043/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 2, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1043/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}], "chosen_pr": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1810", "repository_url": "https://api.github.com/repos/wezterm/wezterm", "labels_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/labels{/name}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/comments", "events_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/events", "html_url": "https://github.com/wezterm/wezterm/pull/1810", "id": 1190677980, "node_id": "PR_kwDOBy-5T841h9cR", "number": 1810, "title": "Added support for kitty images protocol using Shared Memory", "user": {"login": "tantei3", "id": 54449449, "node_id": "MDQ6VXNlcjU0NDQ5NDQ5", "avatar_url": "https://avatars.githubusercontent.com/u/54449449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tantei3", "html_url": "https://github.com/tantei3", "followers_url": "https://api.github.com/users/tantei3/followers", "following_url": "https://api.github.com/users/tantei3/following{/other_user}", "gists_url": "https://api.github.com/users/tantei3/gists{/gist_id}", "starred_url": "https://api.github.com/users/tantei3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tantei3/subscriptions", "organizations_url": "https://api.github.com/users/tantei3/orgs", "repos_url": "https://api.github.com/users/tantei3/repos", "events_url": "https://api.github.com/users/tantei3/events{/privacy}", "received_events_url": "https://api.github.com/users/tantei3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2022-04-02T16:30:52Z", "updated_at": "2025-08-06T10:25:27Z", "closed_at": "2022-04-03T19:59:58Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1810", "html_url": "https://github.com/wezterm/wezterm/pull/1810", "diff_url": "https://github.com/wezterm/wezterm/pull/1810.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1810.patch", "merged_at": "2022-04-03T19:59:58Z"}, "body": "Allows reading data via shared memory on both Unix and Windows. Adds support for tasks 9 and 10 from issue 986 related to Kitty Image Protocol. Tested on Linux and on Windows 10 (Had to split the below script into two different parts and run the command via wezterm ssh) using the below python script:\r\n```python\r\nimport sys\r\nfrom base64 import b64encode\r\nfrom multiprocessing import shared_memory\r\nfrom time import sleep\r\n\r\nwidth = 1920\r\nheight = 1080\r\ndepth = 4\r\nsize = width * height * depth\r\nshm = shared_memory.SharedMemory(create=True, name=\"myshm\", size = size)\r\nimg = shm.buf\r\n\r\nfor row in range(height):\r\n    for col in range(width):\r\n        img[(row * width + col) * 4 + 0] = int(255 / (height + 1) * row) # red\r\n        img[(row * width + col) * 4 + 1] = int(255 / (width + 1) * col) # green\r\n        img[(row * width + col) * 4 + 2] = 255 # blue\r\n        img[(row * width + col) * 4 + 3] = 255\r\n\r\ncontrol_data = b'\\033_Ga=T,f=32,t=s,s=' + str(width).encode() + b',v=' + str(height).encode() + b';'\r\nend_sequence = b\"\\033\\\\\"\r\nstring = control_data + b64encode(b\"myshm\") + end_sequence\r\nsys.stdout.buffer.write(string)\r\nsys.stdout.flush()\r\nsleep(5)\r\nprint(\"Exiting\")\r\n```", "reactions": {"url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/reactions", "total_count": 6, "+1": 3, "-1": 0, "laugh": 0, "hooray": 1, "confused": 0, "heart": 1, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, "chosen_detail": {"url": "https://api.github.com/repos/wezterm/wezterm/pulls/1810", "id": 898094865, "node_id": "PR_kwDOBy-5T841h9cR", "html_url": "https://github.com/wezterm/wezterm/pull/1810", "diff_url": "https://github.com/wezterm/wezterm/pull/1810.diff", "patch_url": "https://github.com/wezterm/wezterm/pull/1810.patch", "issue_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810", "number": 1810, "state": "closed", "locked": false, "title": "Added support for kitty images protocol using Shared Memory", "user": {"login": "tantei3", "id": 54449449, "node_id": "MDQ6VXNlcjU0NDQ5NDQ5", "avatar_url": "https://avatars.githubusercontent.com/u/54449449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tantei3", "html_url": "https://github.com/tantei3", "followers_url": "https://api.github.com/users/tantei3/followers", "following_url": "https://api.github.com/users/tantei3/following{/other_user}", "gists_url": "https://api.github.com/users/tantei3/gists{/gist_id}", "starred_url": "https://api.github.com/users/tantei3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tantei3/subscriptions", "organizations_url": "https://api.github.com/users/tantei3/orgs", "repos_url": "https://api.github.com/users/tantei3/repos", "events_url": "https://api.github.com/users/tantei3/events{/privacy}", "received_events_url": "https://api.github.com/users/tantei3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "body": "Allows reading data via shared memory on both Unix and Windows. Adds support for tasks 9 and 10 from issue 986 related to Kitty Image Protocol. Tested on Linux and on Windows 10 (Had to split the below script into two different parts and run the command via wezterm ssh) using the below python script:\r\n```python\r\nimport sys\r\nfrom base64 import b64encode\r\nfrom multiprocessing import shared_memory\r\nfrom time import sleep\r\n\r\nwidth = 1920\r\nheight = 1080\r\ndepth = 4\r\nsize = width * height * depth\r\nshm = shared_memory.SharedMemory(create=True, name=\"myshm\", size = size)\r\nimg = shm.buf\r\n\r\nfor row in range(height):\r\n    for col in range(width):\r\n        img[(row * width + col) * 4 + 0] = int(255 / (height + 1) * row) # red\r\n        img[(row * width + col) * 4 + 1] = int(255 / (width + 1) * col) # green\r\n        img[(row * width + col) * 4 + 2] = 255 # blue\r\n        img[(row * width + col) * 4 + 3] = 255\r\n\r\ncontrol_data = b'\\033_Ga=T,f=32,t=s,s=' + str(width).encode() + b',v=' + str(height).encode() + b';'\r\nend_sequence = b\"\\033\\\\\"\r\nstring = control_data + b64encode(b\"myshm\") + end_sequence\r\nsys.stdout.buffer.write(string)\r\nsys.stdout.flush()\r\nsleep(5)\r\nprint(\"Exiting\")\r\n```", "created_at": "2022-04-02T16:30:52Z", "updated_at": "2025-08-06T10:25:27Z", "closed_at": "2022-04-03T19:59:58Z", "merged_at": "2022-04-03T19:59:58Z", "merge_commit_sha": "60ec82554bd8d781975b5dc88684bda57f910a8b", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "draft": false, "commits_url": "https://api.github.com/repos/wezterm/wezterm/pulls/1810/commits", "review_comments_url": "https://api.github.com/repos/wezterm/wezterm/pulls/1810/comments", "review_comment_url": "https://api.github.com/repos/wezterm/wezterm/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/issues/1810/comments", "statuses_url": "https://api.github.com/repos/wezterm/wezterm/statuses/ec555a8a5ab9d97df5afa256c53669e4f5a8e557", "head": {"label": "tantei3:kitty_shm", "ref": "kitty_shm", "sha": "ec555a8a5ab9d97df5afa256c53669e4f5a8e557", "user": {"login": "tantei3", "id": 54449449, "node_id": "MDQ6VXNlcjU0NDQ5NDQ5", "avatar_url": "https://avatars.githubusercontent.com/u/54449449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tantei3", "html_url": "https://github.com/tantei3", "followers_url": "https://api.github.com/users/tantei3/followers", "following_url": "https://api.github.com/users/tantei3/following{/other_user}", "gists_url": "https://api.github.com/users/tantei3/gists{/gist_id}", "starred_url": "https://api.github.com/users/tantei3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tantei3/subscriptions", "organizations_url": "https://api.github.com/users/tantei3/orgs", "repos_url": "https://api.github.com/users/tantei3/repos", "events_url": "https://api.github.com/users/tantei3/events{/privacy}", "received_events_url": "https://api.github.com/users/tantei3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "repo": {"id": 477106339, "node_id": "R_kgDOHHAQow", "name": "wezterm", "full_name": "tantei3/wezterm", "private": false, "owner": {"login": "tantei3", "id": 54449449, "node_id": "MDQ6VXNlcjU0NDQ5NDQ5", "avatar_url": "https://avatars.githubusercontent.com/u/54449449?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tantei3", "html_url": "https://github.com/tantei3", "followers_url": "https://api.github.com/users/tantei3/followers", "following_url": "https://api.github.com/users/tantei3/following{/other_user}", "gists_url": "https://api.github.com/users/tantei3/gists{/gist_id}", "starred_url": "https://api.github.com/users/tantei3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tantei3/subscriptions", "organizations_url": "https://api.github.com/users/tantei3/orgs", "repos_url": "https://api.github.com/users/tantei3/repos", "events_url": "https://api.github.com/users/tantei3/events{/privacy}", "received_events_url": "https://api.github.com/users/tantei3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/tantei3/wezterm", "description": "A GPU-accelerated cross-platform terminal emulator and multiplexer written by @wez and implemented in Rust", "fork": true, "url": "https://api.github.com/repos/tantei3/wezterm", "forks_url": "https://api.github.com/repos/tantei3/wezterm/forks", "keys_url": "https://api.github.com/repos/tantei3/wezterm/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/tantei3/wezterm/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/tantei3/wezterm/teams", "hooks_url": "https://api.github.com/repos/tantei3/wezterm/hooks", "issue_events_url": "https://api.github.com/repos/tantei3/wezterm/issues/events{/number}", "events_url": "https://api.github.com/repos/tantei3/wezterm/events", "assignees_url": "https://api.github.com/repos/tantei3/wezterm/assignees{/user}", "branches_url": "https://api.github.com/repos/tantei3/wezterm/branches{/branch}", "tags_url": "https://api.github.com/repos/tantei3/wezterm/tags", "blobs_url": "https://api.github.com/repos/tantei3/wezterm/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/tantei3/wezterm/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/tantei3/wezterm/git/refs{/sha}", "trees_url": "https://api.github.com/repos/tantei3/wezterm/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/tantei3/wezterm/statuses/{sha}", "languages_url": "https://api.github.com/repos/tantei3/wezterm/languages", "stargazers_url": "https://api.github.com/repos/tantei3/wezterm/stargazers", "contributors_url": "https://api.github.com/repos/tantei3/wezterm/contributors", "subscribers_url": "https://api.github.com/repos/tantei3/wezterm/subscribers", "subscription_url": "https://api.github.com/repos/tantei3/wezterm/subscription", "commits_url": "https://api.github.com/repos/tantei3/wezterm/commits{/sha}", "git_commits_url": "https://api.github.com/repos/tantei3/wezterm/git/commits{/sha}", "comments_url": "https://api.github.com/repos/tantei3/wezterm/comments{/number}", "issue_comment_url": "https://api.github.com/repos/tantei3/wezterm/issues/comments{/number}", "contents_url": "https://api.github.com/repos/tantei3/wezterm/contents/{+path}", "compare_url": "https://api.github.com/repos/tantei3/wezterm/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/tantei3/wezterm/merges", "archive_url": "https://api.github.com/repos/tantei3/wezterm/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/tantei3/wezterm/downloads", "issues_url": "https://api.github.com/repos/tantei3/wezterm/issues{/number}", "pulls_url": "https://api.github.com/repos/tantei3/wezterm/pulls{/number}", "milestones_url": "https://api.github.com/repos/tantei3/wezterm/milestones{/number}", "notifications_url": "https://api.github.com/repos/tantei3/wezterm/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/tantei3/wezterm/labels{/name}", "releases_url": "https://api.github.com/repos/tantei3/wezterm/releases{/id}", "deployments_url": "https://api.github.com/repos/tantei3/wezterm/deployments", "created_at": "2022-04-02T16:13:54Z", "updated_at": "2025-02-07T19:48:32Z", "pushed_at": "2022-04-03T15:29:33Z", "git_url": "git://github.com/tantei3/wezterm.git", "ssh_url": "git@github.com:tantei3/wezterm.git", "clone_url": "https://github.com/tantei3/wezterm.git", "svn_url": "https://github.com/tantei3/wezterm", "homepage": "https://wezfurlong.org/wezterm/", "size": 367241, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 0, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 0, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "main"}}, "base": {"label": "wezterm:main", "ref": "main", "sha": "2faa6822f992f2acd183589b85fb87827453dc7b", "user": {"login": "wezterm", "id": 198158019, "node_id": "O_kgDOC8-mww", "avatar_url": "https://avatars.githubusercontent.com/u/198158019?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wezterm", "html_url": "https://github.com/wezterm", "followers_url": "https://api.github.com/users/wezterm/followers", "following_url": "https://api.github.com/users/wezterm/following{/other_user}", "gists_url": "https://api.github.com/users/wezterm/gists{/gist_id}", "starred_url": "https://api.github.com/users/wezterm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wezterm/subscriptions", "organizations_url": "https://api.github.com/users/wezterm/orgs", "repos_url": "https://api.github.com/users/wezterm/repos", "events_url": "https://api.github.com/users/wezterm/events{/privacy}", "received_events_url": "https://api.github.com/users/wezterm/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "repo": {"id": 120568143, "node_id": "MDEwOlJlcG9zaXRvcnkxMjA1NjgxNDM=", "name": "wezterm", "full_name": "wezterm/wezterm", "private": false, "owner": {"login": "wezterm", "id": 198158019, "node_id": "O_kgDOC8-mww", "avatar_url": "https://avatars.githubusercontent.com/u/198158019?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wezterm", "html_url": "https://github.com/wezterm", "followers_url": "https://api.github.com/users/wezterm/followers", "following_url": "https://api.github.com/users/wezterm/following{/other_user}", "gists_url": "https://api.github.com/users/wezterm/gists{/gist_id}", "starred_url": "https://api.github.com/users/wezterm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wezterm/subscriptions", "organizations_url": "https://api.github.com/users/wezterm/orgs", "repos_url": "https://api.github.com/users/wezterm/repos", "events_url": "https://api.github.com/users/wezterm/events{/privacy}", "received_events_url": "https://api.github.com/users/wezterm/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/wezterm/wezterm", "description": "A GPU-accelerated cross-platform terminal emulator and multiplexer written by @wez and implemented in Rust", "fork": false, "url": "https://api.github.com/repos/wezterm/wezterm", "forks_url": "https://api.github.com/repos/wezterm/wezterm/forks", "keys_url": "https://api.github.com/repos/wezterm/wezterm/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/wezterm/wezterm/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/wezterm/wezterm/teams", "hooks_url": "https://api.github.com/repos/wezterm/wezterm/hooks", "issue_events_url": "https://api.github.com/repos/wezterm/wezterm/issues/events{/number}", "events_url": "https://api.github.com/repos/wezterm/wezterm/events", "assignees_url": "https://api.github.com/repos/wezterm/wezterm/assignees{/user}", "branches_url": "https://api.github.com/repos/wezterm/wezterm/branches{/branch}", "tags_url": "https://api.github.com/repos/wezterm/wezterm/tags", "blobs_url": "https://api.github.com/repos/wezterm/wezterm/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/wezterm/wezterm/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/wezterm/wezterm/git/refs{/sha}", "trees_url": "https://api.github.com/repos/wezterm/wezterm/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/wezterm/wezterm/statuses/{sha}", "languages_url": "https://api.github.com/repos/wezterm/wezterm/languages", "stargazers_url": "https://api.github.com/repos/wezterm/wezterm/stargazers", "contributors_url": "https://api.github.com/repos/wezterm/wezterm/contributors", "subscribers_url": "https://api.github.com/repos/wezterm/wezterm/subscribers", "subscription_url": "https://api.github.com/repos/wezterm/wezterm/subscription", "commits_url": "https://api.github.com/repos/wezterm/wezterm/commits{/sha}", "git_commits_url": "https://api.github.com/repos/wezterm/wezterm/git/commits{/sha}", "comments_url": "https://api.github.com/repos/wezterm/wezterm/comments{/number}", "issue_comment_url": "https://api.github.com/repos/wezterm/wezterm/issues/comments{/number}", "contents_url": "https://api.github.com/repos/wezterm/wezterm/contents/{+path}", "compare_url": "https://api.github.com/repos/wezterm/wezterm/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/wezterm/wezterm/merges", "archive_url": "https://api.github.com/repos/wezterm/wezterm/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/wezterm/wezterm/downloads", "issues_url": "https://api.github.com/repos/wezterm/wezterm/issues{/number}", "pulls_url": "https://api.github.com/repos/wezterm/wezterm/pulls{/number}", "milestones_url": "https://api.github.com/repos/wezterm/wezterm/milestones{/number}", "notifications_url": "https://api.github.com/repos/wezterm/wezterm/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/wezterm/wezterm/labels{/name}", "releases_url": "https://api.github.com/repos/wezterm/wezterm/releases{/id}", "deployments_url": "https://api.github.com/repos/wezterm/wezterm/deployments", "created_at": "2018-02-07T05:35:46Z", "updated_at": "2026-01-21T02:08:26Z", "pushed_at": "2026-01-17T15:44:28Z", "git_url": "git://github.com/wezterm/wezterm.git", "ssh_url": "git@github.com:wezterm/wezterm.git", "clone_url": "https://github.com/wezterm/wezterm.git", "svn_url": "https://github.com/wezterm/wezterm", "homepage": "https://wezterm.org/", "size": 309658, "stargazers_count": 23598, "watchers_count": 23598, "language": "Rust", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": true, "has_discussions": true, "forks_count": 1141, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 1541, "license": {"key": "other", "name": "Other", "spdx_id": "NOASSERTION", "url": null, "node_id": "MDc6TGljZW5zZTA="}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": ["rust", "serial", "serial-port", "terminal", "terminal-emulator", "terminal-emulators"], "visibility": "public", "forks": 1141, "open_issues": 1541, "watchers": 23598, "default_branch": "main"}}, "_links": {"self": {"href": "https://api.github.com/repos/wezterm/wezterm/pulls/1810"}, "html": {"href": "https://github.com/wezterm/wezterm/pull/1810"}, "issue": {"href": "https://api.github.com/repos/wezterm/wezterm/issues/1810"}, "comments": {"href": "https://api.github.com/repos/wezterm/wezterm/issues/1810/comments"}, "review_comments": {"href": "https://api.github.com/repos/wezterm/wezterm/pulls/1810/comments"}, "review_comment": {"href": "https://api.github.com/repos/wezterm/wezterm/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/wezterm/wezterm/pulls/1810/commits"}, "statuses": {"href": "https://api.github.com/repos/wezterm/wezterm/statuses/ec555a8a5ab9d97df5afa256c53669e4f5a8e557"}}, "author_association": "CONTRIBUTOR", "auto_merge": null, "active_lock_reason": null, "merged": true, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": {"login": "wez", "id": 117777, "node_id": "MDQ6VXNlcjExNzc3Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/117777?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wez", "html_url": "https://github.com/wez", "followers_url": "https://api.github.com/users/wez/followers", "following_url": "https://api.github.com/users/wez/following{/other_user}", "gists_url": "https://api.github.com/users/wez/gists{/gist_id}", "starred_url": "https://api.github.com/users/wez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wez/subscriptions", "organizations_url": "https://api.github.com/users/wez/orgs", "repos_url": "https://api.github.com/users/wez/repos", "events_url": "https://api.github.com/users/wez/events{/privacy}", "received_events_url": "https://api.github.com/users/wez/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "comments": 7, "review_comments": 31, "maintainer_can_modify": false, "commits": 4, "additions": 170, "deletions": 3, "changed_files": 3}}