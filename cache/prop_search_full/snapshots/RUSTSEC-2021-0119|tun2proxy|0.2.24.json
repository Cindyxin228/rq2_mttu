{"window": ["2021-09-29T03:28:08.745264+00:00", "2024-07-16T05:02:15.720890+00:00"], "repo_slug": "tun2proxy/tun2proxy", "candidates": [{"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/122", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/122/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/122/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/122/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/122", "id": 2356089953, "node_id": "PR_kwDOF_nm_s5yoGIf", "number": 122, "title": "Update android_logger requirement from 0.13 to 0.14", "user": {"login": "dependabot[bot]", "id": 49699333, "node_id": "MDM6Qm90NDk2OTkzMzM=", "avatar_url": "https://avatars.githubusercontent.com/in/29110?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dependabot%5Bbot%5D", "html_url": "https://github.com/apps/dependabot", "followers_url": "https://api.github.com/users/dependabot%5Bbot%5D/followers", "following_url": "https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dependabot%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/dependabot%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/dependabot%5Bbot%5D/repos", "events_url": "https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/dependabot%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 7089980587, "node_id": "LA_kwDOF_nm_s8AAAABppiEqw", "url": "https://api.github.com/repos/tun2proxy/tun2proxy/labels/dependencies", "name": "dependencies", "color": "0366d6", "default": false, "description": "Pull requests that update a dependency file"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2024-06-17T00:41:47Z", "updated_at": "2024-06-17T03:45:47Z", "closed_at": "2024-06-17T03:45:40Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/122", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/122", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/122.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/122.patch", "merged_at": "2024-06-17T03:45:40Z"}, "body": "Updates the requirements on [android_logger](https://github.com/rust-mobile/android_logger-rs) to permit the latest version.\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/e5f0e39a1826557e142d87af1cb1eba9d3efe00a\"><code>e5f0e39</code></a> version bump</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/18f1e462b3d81c5ddddba96c03b4dd88ca52f9f3\"><code>18f1e46</code></a> Don't see reason to depend on env_logger just for reexport</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/038b0dc8d0641aad8e5a98cae0cda4b0e424e4e6\"><code>038b0dc</code></a> remove once_cell as dependency</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/772434ec17b975a70c2c58309ba14f407ea8aae7\"><code>772434e</code></a> Merge pull request <a href=\"https://redirect.github.com/rust-mobile/android_logger-rs/issues/71\">#71</a> from DJMcNab/env_logger_0_11</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/84c765736f513ba12d54906c74d141bd3a30b5af\"><code>84c7657</code></a> Update env_logger to 0.11</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/cf2684e88f7cf6702c89a2fbebe0b8cb0fa77c31\"><code>cf2684e</code></a> Merge pull request <a href=\"https://redirect.github.com/rust-mobile/android_logger-rs/issues/70\">#70</a> from rust-mobile/update-version-in-readme</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/71f0ed9f965cf54f319411c8a8baac76a6cda332\"><code>71f0ed9</code></a> Merge pull request <a href=\"https://redirect.github.com/rust-mobile/android_logger-rs/issues/69\">#69</a> from Nercury/master</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/3f03273fbaff7ebce578f006ae9bd14d30803eb2\"><code>3f03273</code></a> Update version in readme example</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/d769d7d30036bb4fc93dce265bc6b1c79f6b4d91\"><code>d769d7d</code></a> Bump version</li>\n<li><a href=\"https://github.com/rust-mobile/android_logger-rs/commit/2f65cc50bf7ca1da06643557a8b77290120fddf9\"><code>2f65cc5</code></a> Change links to rust-mobile</li>\n<li>Additional commits viewable in <a href=\"https://github.com/rust-mobile/android_logger-rs/compare/v0.13.0...0.14.0\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/122/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/122/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/104", "id": 2223369691, "node_id": "PR_kwDOF_nm_s5rl2q-", "number": 104, "title": "Add support for unprivileged namespaces on linux", "user": {"login": "one-d-wide", "id": 116499566, "node_id": "U_kgDOBvGkbg", "avatar_url": "https://avatars.githubusercontent.com/u/116499566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/one-d-wide", "html_url": "https://github.com/one-d-wide", "followers_url": "https://api.github.com/users/one-d-wide/followers", "following_url": "https://api.github.com/users/one-d-wide/following{/other_user}", "gists_url": "https://api.github.com/users/one-d-wide/gists{/gist_id}", "starred_url": "https://api.github.com/users/one-d-wide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/one-d-wide/subscriptions", "organizations_url": "https://api.github.com/users/one-d-wide/orgs", "repos_url": "https://api.github.com/users/one-d-wide/repos", "events_url": "https://api.github.com/users/one-d-wide/events{/privacy}", "received_events_url": "https://api.github.com/users/one-d-wide/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "assignees": [{"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2024-04-03T16:22:56Z", "updated_at": "2024-04-13T15:24:26Z", "closed_at": "2024-04-07T19:52:22Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/104", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/104.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/104.patch", "merged_at": "2024-04-07T19:52:21Z"}, "body": "## Motivation\r\n\r\nHi. I was trying to came up with some solution to make a network environment isolated from a global system setup with all traffic reaching outside routing via the a socks proxy or vpn instance in unprivileged (rootless) manner.\r\n\r\nUsually this would require using something like veth pairs (virtual network interfaces) to bridge namespaces. But required modifications affect the global network namespace therefore require root-like capabilities. That aren't normally available to the user processes.\r\n\r\nThis why I came up with a solution utilizing TUN interface. And since it similar to what this project does, I decided to integrate that functionality here.\r\n\r\nHere are use-cases I wanted to add support for:\r\n- Create an isolated and proxified environment for applications that don't understand proxies by themselves.\r\n- Separate vpn instances from global network namespace.\r\n- Support flatpak application (this is tricky because some containerization solutions are messing up capabilities such that flatpak fails to run).\r\n- Do everything above without requiring root-like capabilities.\r\n\r\n## Implemented features\r\n- Unprivileged mode which creates an isolated network environment (from the global network configuration) and bridges all the traffic reaching outside of it through the proxy. See `--unshare`.\r\n- No-proxy mode which sends routes traffic directly to the requested address. See `--proxy none`.\r\n\r\n## Usage\r\nCreate a new network namespace where all traffic reaching outside is routed through the socks5 proxy.\r\n\r\n```sh\r\n$ tun2proxy --unshare --startup --proxy \"socks5://...\"\r\n...\r\n```\r\n\r\nCreate a new network namespace without additional redirection of traffic with `openvpn` running in it (with root-like capabilities provided to allow network configuration).\r\n\r\n```sh\r\n$ tun2proxy --unshare --startup --proxy \"none\" -- openvpn [...]\r\n...\r\n```\r\n\r\nStart `/bin/sh` in the namespace created by the `tun2proxy` started the latest. Persistent command is suggested in `tun2proxy` output.\r\n\r\n```sh\r\n$ nsenter --target $(pgrep -n tun2proxy) --preserve-credentials --user  --net --mount /bin/sh\r\n```\r\n\r\n## Architecture\r\n\r\nThere are three core ideas in play:\r\n- When a process creates namespace it gains root-like capabilities. I.e. the ability to modify filesystem and network devices it the namespaces. This capability can be passed to descendant processes allowing them to create a TUN devices in unprivileged environment.\r\n- A pair of interconnected `unix(7)` sockets may not only exchange data but also copies of valid file descriptors.\r\nThis mechanism is useful to transfer sockets bonded to the global network to another network namespace.\r\n- File descriptors without `CLOEXEC` flag (it is usually set by the std implementation) are inherited in descending processes.\r\n\r\nUsing those ideas execution flow can be described as follows:\r\n- First `tun2proxy` process with argument `--unshare` generates a pair of interconnected unix sockets unsetting `CLOEXEC` flag on one of those and converting it to raw file descriptor value.\r\n- Then it starts `unshare(1)` process that creates a new namespace.\r\n- `unshare` process is instructed to start `tun2proxy` binary again but this time with `--socket-transfer-fd <fd>` argument where `<fd>` is the raw file descriptor discussed earlier.\r\n- `tun2proxy` process inside the new namespace initializes TUN interface and routing table as normal.\r\n- But since network namespace it is running in is isolated, it can't connect to the proxy server directly. This what unix sockets are required for.\r\n- After initialization is done, it starts transferring network sockets from the first `tun2proxy` process that is still in the global network namespace and sockets created by which are bonded to the global namespace even after the transfer to the descendant process occurs.\r\n- The network admin process (see `[admin command]` cli argument) is started after the network is ready, preserving root-like capabilities, that process could be for example a vpn daemon.\r\n- Then `tun2proxy` operates as usual.\r\n\r\n## Code changes\r\n\r\n- `bin/main.rs` - added a startup routine triggered if `--unshare` is specified.\r\n- `args.rs` - added new cli arguments: `--proxy none`, `--unshare`, `--socket-transfer-fd <fd>`, `[admin\\_command...]`, `udp_timeout`.\r\n- `desktop_api.rs` - added code to spawn an `admin_command` and fix to allow running other proxy in a new namespace. \r\n- `lib.rs` - added functionality to fetch network sockets in case `--socket-tranfer-fd` was specified. Also a small fix to bunch series of `Mutex::lock` into one call where applicable.\r\n- `no_proxy.rs` (created) - implementation of no-proxy mode, basically a no-op since it signals that connection is always established.\r\n- `proxy_handle.rs` (and implementations of proxy protocols) - add `get_server_addr` function to `ProxyHandler` trait, previously server address was supplied directly from cli arguments.\r\n- `socket_transfer.rs` (created) - functionality to safely transfer raw sockets between processes.\r\n\r\n## Notes\r\n\r\n- `tproxy-config` is lacking the support not to set ipv6 routing. This confuses some user application if proxy doesn't support ipv6 connectivity, e.g. causes timeout in resolution and subsequent fail of dns requests (this also could be attributed to `ipstack` not reporting unreachable destinations).\r\n\r\n- `tproxy-config` is always setting *more specific* (compared to `0.0.0.0/0`) routing addresses even if no default route is presented in the network namespace. This causes mutual exclusion in routing tables for `0.0.0.0/1` and `128.0.0.0/1` address spaces with other proxy application (notably `openvpn`).\r\n", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/97", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/97/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/97/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/97/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/97", "id": 2165316426, "node_id": "PR_kwDOF_nm_s5oglnN", "number": 97, "title": "tun shutdown issues.", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2024-03-03T11:42:32Z", "updated_at": "2024-03-03T11:49:14Z", "closed_at": "2024-03-03T11:49:10Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/97", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/97", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/97.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/97.patch", "merged_at": "2024-03-03T11:49:10Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/97/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/97/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/90", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/90/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/90/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/90/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/90", "id": 2131364201, "node_id": "PR_kwDOF_nm_s5ms5Gg", "number": 90, "title": "Ffi2", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2024-02-13T02:45:42Z", "updated_at": "2024-02-13T02:46:17Z", "closed_at": "2024-02-13T02:46:13Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/90", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/90", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/90.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/90.patch", "merged_at": "2024-02-13T02:46:13Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/90/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/90/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/88", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/88/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/88/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/88/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/88", "id": 2128440071, "node_id": "PR_kwDOF_nm_s5mjL-R", "number": 88, "title": "Introduce cancellation token and reduce amount of code", "user": {"login": "pronebird", "id": 704044, "node_id": "MDQ6VXNlcjcwNDA0NA==", "avatar_url": "https://avatars.githubusercontent.com/u/704044?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pronebird", "html_url": "https://github.com/pronebird", "followers_url": "https://api.github.com/users/pronebird/followers", "following_url": "https://api.github.com/users/pronebird/following{/other_user}", "gists_url": "https://api.github.com/users/pronebird/gists{/gist_id}", "starred_url": "https://api.github.com/users/pronebird/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pronebird/subscriptions", "organizations_url": "https://api.github.com/users/pronebird/orgs", "repos_url": "https://api.github.com/users/pronebird/repos", "events_url": "https://api.github.com/users/pronebird/events{/privacy}", "received_events_url": "https://api.github.com/users/pronebird/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-02-10T13:31:26Z", "updated_at": "2024-02-19T08:04:51Z", "closed_at": "2024-02-10T16:36:54Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/88", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/88", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/88.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/88.patch", "merged_at": "2024-02-10T16:36:54Z"}, "body": "Hi,\r\n\r\n- Personally I found the use of `Builder` a bit excessive because we don't provide anything but `mtu` or `Args` so I figured we could get rid of it. \r\n\r\n- Same goes for `Tun2Socks5` which in essence is a holder of `Future` that it spawns on tokio runtime. Given that `tun2proxy::run()` is public, I thought that it's much simpler to call it directly within `tokio::spawn` which then shifts the interaction with `JoinHandle` onto consumer. And then all those types from `lib.rs` dealing with `JoinHandle` coming from tokio are going away, less code!\r\n\r\n- Besides that this PR replaces `Quit` with `tokio_util::sync::CancellationToken` which is basically the same thing but nicer. It integrates nicely with `tokio::select!` as well as it provides a `CancellationToken::cancelled()` that returns `Future` which basically completes execution upon cancellation and can be plugged right into `tokio::select!`. On top of that `CancellationToken::cancel()` should work just fine from sync contexts which makes `tun2proxy_internal_stop` from `api.rs` much simpler.\r\n\r\n- Last but not least, I refactored `api.rs` to use static `Mutex` (see https://github.com/rust-lang/rust/pull/97791) and got rid of all unsafe blocks, plus integrated cancellation token. I couldn't compile the lib for android, I assume because of macOS, but it compiles for iOS and macOS. Please verify that I didn't break anything if you consider accepting this work.\r\n\r\n- Just noticed right now MTU conversions from `usize` to `u16` and aligned the types across the board. On android `jchar` corresponds to `u16` so I hope bindings look fine on the other side. Feel free to cherry pick things if you think it's too much of a change in one go or I can extract this into separate PR.", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/88/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/88/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/85", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/85/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/85/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/85/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/85", "id": 2112627502, "node_id": "PR_kwDOF_nm_s5ltQbN", "number": 85, "title": "release script issues", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2024-02-01T14:12:11Z", "updated_at": "2024-02-01T14:12:35Z", "closed_at": "2024-02-01T14:12:31Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/85", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/85", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/85.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/85.patch", "merged_at": "2024-02-01T14:12:31Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/85/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/85/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/84", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/84/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/84/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/84/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/84", "id": 2112240591, "node_id": "PR_kwDOF_nm_s5lr6PS", "number": 84, "title": "beginning async version", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2024-02-01T11:15:15Z", "updated_at": "2024-02-01T11:15:36Z", "closed_at": "2024-02-01T11:15:32Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/84", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/84", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/84.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/84.patch", "merged_at": "2024-02-01T11:15:32Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/84/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/84/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/75", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/75/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/75/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/75/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/75", "id": 1978969857, "node_id": "PR_kwDOF_nm_s5erdk7", "number": 75, "title": "Ctrlc issues", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-11-06T11:53:27Z", "updated_at": "2023-11-06T12:03:44Z", "closed_at": "2023-11-06T12:03:40Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/75", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/75", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/75.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/75.patch", "merged_at": "2023-11-06T12:03:40Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/75/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/75/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/72", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/72/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/72/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/72/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/72", "id": 1956188402, "node_id": "PR_kwDOF_nm_s5depRD", "number": 72, "title": "Windows support", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-10-23T01:37:41Z", "updated_at": "2023-11-23T15:26:11Z", "closed_at": "2023-10-23T01:44:27Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/72", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/72", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/72.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/72.patch", "merged_at": "2023-10-23T01:44:27Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/72/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/72/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/61", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/61/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/61/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/61/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/61", "id": 1874866895, "node_id": "PR_kwDOF_nm_s5ZNBVL", "number": 61, "title": "Prepare to porting", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-08-31T06:28:33Z", "updated_at": "2023-08-31T06:50:13Z", "closed_at": "2023-08-31T06:31:02Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/61", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/61", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/61.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/61.patch", "merged_at": "2023-08-31T06:31:02Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/61/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/61/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/51", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/51/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/51/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/51/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/51", "id": 1838234473, "node_id": "PR_kwDOF_nm_s5XRZJS", "number": 51, "title": "publish script", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-08-06T14:42:38Z", "updated_at": "2023-08-06T14:46:39Z", "closed_at": "2023-08-06T14:46:34Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/51", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/51", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/51.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/51.patch", "merged_at": "2023-08-06T14:46:34Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/51/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/51/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/50", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/50/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/50/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/50/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/50", "id": 1838213224, "node_id": "PR_kwDOF_nm_s5XRVOc", "number": 50, "title": "refine Virtual DNS code.", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-08-06T13:38:06Z", "updated_at": "2023-08-06T13:40:39Z", "closed_at": "2023-08-06T13:40:34Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/50", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/50", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/50.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/50.patch", "merged_at": "2023-08-06T13:40:34Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/50/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/50/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/48", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/48/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/48/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/48/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/48", "id": 1819415127, "node_id": "PR_kwDOF_nm_s5WSOYP", "number": 48, "title": "Unexpected comsuming", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 5370867136, "node_id": "LA_kwDOF_nm_s8AAAABQCDtwA", "url": "https://api.github.com/repos/tun2proxy/tun2proxy/labels/safe%20to%20test", "name": "safe to test", "color": "A9E729", "default": false, "description": "The code has been reviewed to be safe for testing in the target repository context"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-07-25T01:53:26Z", "updated_at": "2023-07-26T17:55:29Z", "closed_at": "2023-07-25T23:01:49Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/48", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/48", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/48.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/48.patch", "merged_at": "2023-07-25T23:01:49Z"}, "body": "Avoid accidentally consuming incompletely arrived data", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/48/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/48/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/47", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/47/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/47/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/47/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/47", "id": 1817551908, "node_id": "PR_kwDOF_nm_s5WL5PX", "number": 47, "title": "swith socks5-impl", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 5370867136, "node_id": "LA_kwDOF_nm_s8AAAABQCDtwA", "url": "https://api.github.com/repos/tun2proxy/tun2proxy/labels/safe%20to%20test", "name": "safe to test", "color": "A9E729", "default": false, "description": "The code has been reviewed to be safe for testing in the target repository context"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-07-24T03:47:47Z", "updated_at": "2023-07-25T01:15:56Z", "closed_at": "2023-07-24T18:48:56Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/47", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/47", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/47.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/47.patch", "merged_at": "2023-07-24T18:48:56Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/47/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/47/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/45", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/45/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/45/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/45/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/45", "id": 1815245327, "node_id": "PR_kwDOF_nm_s5WEZ8u", "number": 45, "title": "Update dependencies", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 5370867136, "node_id": "LA_kwDOF_nm_s8AAAABQCDtwA", "url": "https://api.github.com/repos/tun2proxy/tun2proxy/labels/safe%20to%20test", "name": "safe to test", "color": "A9E729", "default": false, "description": "The code has been reviewed to be safe for testing in the target repository context"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-07-21T06:43:21Z", "updated_at": "2023-07-22T17:25:09Z", "closed_at": "2023-07-22T13:06:43Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/45", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/45", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/45.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/45.patch", "merged_at": "2023-07-22T13:06:43Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/45/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/45/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/44", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/44/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/44/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/44/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/44", "id": 1770107518, "node_id": "PR_kwDOF_nm_s5Trde7", "number": 44, "title": "Initial support for digest auth scheme", "user": {"login": "jorgeajimenezl", "id": 18174581, "node_id": "MDQ6VXNlcjE4MTc0NTgx", "avatar_url": "https://avatars.githubusercontent.com/u/18174581?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jorgeajimenezl", "html_url": "https://github.com/jorgeajimenezl", "followers_url": "https://api.github.com/users/jorgeajimenezl/followers", "following_url": "https://api.github.com/users/jorgeajimenezl/following{/other_user}", "gists_url": "https://api.github.com/users/jorgeajimenezl/gists{/gist_id}", "starred_url": "https://api.github.com/users/jorgeajimenezl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jorgeajimenezl/subscriptions", "organizations_url": "https://api.github.com/users/jorgeajimenezl/orgs", "repos_url": "https://api.github.com/users/jorgeajimenezl/repos", "events_url": "https://api.github.com/users/jorgeajimenezl/events{/privacy}", "received_events_url": "https://api.github.com/users/jorgeajimenezl/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2023-06-22T17:22:15Z", "updated_at": "2023-07-03T00:47:33Z", "closed_at": "2023-07-01T18:33:52Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/44", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/44", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/44.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/44.patch", "merged_at": "2023-07-01T18:33:52Z"}, "body": "Issue #43\n\nActually this works after the second request (when it gets the proxy challenge parameters). This must be because I made some mistake while restarting the connection. The workflow should be something like this (at the start of the program): \r\n\r\n1. tun2proxy makes the request using the basic authentication scheme \r\n2. The server returns a 407 error with the `Proxy-Authenticate` tag and the challenge digest parameters. \r\n3. If the server specifies `Connection: close` or does not specify any header nor `Content-Length` or `Transfer-Encoding` then the connection is closed and restarted. Otherwise, it determines the size of the current HTTP frame and jumps to it. \r\n3. tun2proxy now sends the request using the authentication digest with the response values to the challenge.\r\n4. For next request tun2proxy holds the old `nonce` param and use it to authenticate the response until the proxy requests by a new one, so, reset the connection with the proxy isn't longer needed ", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/44/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/44/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/30", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/30/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/30/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/30/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/30", "id": 1680012688, "node_id": "PR_kwDOF_nm_s5O8DaQ", "number": 30, "title": "Fix #29", "user": {"login": "acheong08", "id": 36258159, "node_id": "MDQ6VXNlcjM2MjU4MTU5", "avatar_url": "https://avatars.githubusercontent.com/u/36258159?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acheong08", "html_url": "https://github.com/acheong08", "followers_url": "https://api.github.com/users/acheong08/followers", "following_url": "https://api.github.com/users/acheong08/following{/other_user}", "gists_url": "https://api.github.com/users/acheong08/gists{/gist_id}", "starred_url": "https://api.github.com/users/acheong08/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acheong08/subscriptions", "organizations_url": "https://api.github.com/users/acheong08/orgs", "repos_url": "https://api.github.com/users/acheong08/repos", "events_url": "https://api.github.com/users/acheong08/events{/privacy}", "received_events_url": "https://api.github.com/users/acheong08/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2023-04-23T12:35:31Z", "updated_at": "2023-04-23T20:45:38Z", "closed_at": "2023-04-23T20:45:38Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/30", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/30", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/30.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/30.patch", "merged_at": "2023-04-23T20:45:38Z"}, "body": "https://github.com/smoltcp-rs/smoltcp#features-phy-raw_socket-and-phy-tuntap_interface\r\n\r\nThe feature should be enabled the feature in `Cargo.toml`.\r\n\r\nAnd then\r\n\r\n```bash\r\n$ cargo update\r\n$ cargo build --release\r\n```", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/30/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/30/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/24", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/24/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/24/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/24/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/24", "id": 1668500276, "node_id": "PR_kwDOF_nm_s5OVwVe", "number": 24, "title": "Integreate to Android", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2023-04-14T15:47:39Z", "updated_at": "2023-04-17T20:43:42Z", "closed_at": "2023-04-14T18:17:10Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/24", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/24", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/24.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/24.patch", "merged_at": "2023-04-14T18:17:10Z"}, "body": "try to integrate it, but not finish it yet.\r\n\r\nanother thing.\r\n\r\nDo we need to handle these two parameters?\r\n![image](https://user-images.githubusercontent.com/30760636/232091909-478dc893-9479-4177-9a43-f0e9dd67257b.png)\r\n", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/24/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/24/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/11", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/11/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/11/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/11/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/11", "id": 1636082978, "node_id": "PR_kwDOF_nm_s5MqNxi", "number": 11, "title": ".env file support", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-03-22T16:05:51Z", "updated_at": "2023-03-23T02:51:16Z", "closed_at": "2023-03-22T16:56:57Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/11", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/11", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/11.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/11.patch", "merged_at": "2023-03-22T16:56:57Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/11/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/11/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/8", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/8/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/8/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/8/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/8", "id": 1633238412, "node_id": "PR_kwDOF_nm_s5MgqQY", "number": 8, "title": "Reqwest without openssl", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2023-03-21T05:07:12Z", "updated_at": "2023-05-18T10:49:06Z", "closed_at": "2023-05-18T10:34:15Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/8", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/8", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/8.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/8.patch", "merged_at": "2023-05-18T10:34:15Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/8/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/8/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/5", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/5/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/5/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/5/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/5", "id": 1631466441, "node_id": "PR_kwDOF_nm_s5MasGG", "number": 5, "title": "Upgrade clap module", "user": {"login": "ssrlive", "id": 30760636, "node_id": "MDQ6VXNlcjMwNzYwNjM2", "avatar_url": "https://avatars.githubusercontent.com/u/30760636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ssrlive", "html_url": "https://github.com/ssrlive", "followers_url": "https://api.github.com/users/ssrlive/followers", "following_url": "https://api.github.com/users/ssrlive/following{/other_user}", "gists_url": "https://api.github.com/users/ssrlive/gists{/gist_id}", "starred_url": "https://api.github.com/users/ssrlive/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ssrlive/subscriptions", "organizations_url": "https://api.github.com/users/ssrlive/orgs", "repos_url": "https://api.github.com/users/ssrlive/repos", "events_url": "https://api.github.com/users/ssrlive/events{/privacy}", "received_events_url": "https://api.github.com/users/ssrlive/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2023-03-20T06:18:53Z", "updated_at": "2023-03-20T15:58:43Z", "closed_at": "2023-03-20T15:09:57Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/5", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/5", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/5.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/5.patch", "merged_at": "2023-03-20T15:09:57Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/5/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/5/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/2", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/2/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/2/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/2/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/2", "id": 1340439314, "node_id": "PR_kwDOF_nm_s49QW9e", "number": 2, "title": "Use log for logging", "user": {"login": "kujeger", "id": 2150686, "node_id": "MDQ6VXNlcjIxNTA2ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/2150686?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kujeger", "html_url": "https://github.com/kujeger", "followers_url": "https://api.github.com/users/kujeger/followers", "following_url": "https://api.github.com/users/kujeger/following{/other_user}", "gists_url": "https://api.github.com/users/kujeger/gists{/gist_id}", "starred_url": "https://api.github.com/users/kujeger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kujeger/subscriptions", "organizations_url": "https://api.github.com/users/kujeger/orgs", "repos_url": "https://api.github.com/users/kujeger/repos", "events_url": "https://api.github.com/users/kujeger/events{/privacy}", "received_events_url": "https://api.github.com/users/kujeger/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2022-08-16T14:25:23Z", "updated_at": "2022-08-16T21:49:45Z", "closed_at": "2022-08-16T21:49:25Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/2", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/2", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/2.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/2.patch", "merged_at": "2022-08-16T21:49:25Z"}, "body": "Use log crate for generating info and error output.\r\n\r\nIn order to maintain same verbosity, set default log level to 'info'. Can be overridden by setting the `RUST_LOG` env variable, e.g. `RUST_LOG=error`.", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/2/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/2/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/1", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/1/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/1/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/1", "id": 1324538565, "node_id": "PR_kwDOF_nm_s48b_mJ", "number": 1, "title": "Cleaning and update", "user": {"login": "dxfgg17", "id": 110106538, "node_id": "U_kgDOBpAXqg", "avatar_url": "https://avatars.githubusercontent.com/u/110106538?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dxfgg17", "html_url": "https://github.com/dxfgg17", "followers_url": "https://api.github.com/users/dxfgg17/followers", "following_url": "https://api.github.com/users/dxfgg17/following{/other_user}", "gists_url": "https://api.github.com/users/dxfgg17/gists{/gist_id}", "starred_url": "https://api.github.com/users/dxfgg17/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dxfgg17/subscriptions", "organizations_url": "https://api.github.com/users/dxfgg17/orgs", "repos_url": "https://api.github.com/users/dxfgg17/repos", "events_url": "https://api.github.com/users/dxfgg17/events{/privacy}", "received_events_url": "https://api.github.com/users/dxfgg17/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2022-08-01T14:42:48Z", "updated_at": "2022-08-02T16:36:56Z", "closed_at": "2022-08-02T16:25:17Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/1", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/1", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/1.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/1.patch", "merged_at": "2022-08-02T16:25:17Z"}, "body": "Hey!\r\n\r\nJust is case this repo is still active, I'd like to submit this pull request to you so it remains up to date :)\r\n\r\nI will probably continue to do some editing since they are some little things to improve and I have new ideas.\r\n\r\nFeel free to edit what I did!", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/1/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}], "chosen_pr": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104", "repository_url": "https://api.github.com/repos/tun2proxy/tun2proxy", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/labels{/name}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/comments", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/events", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/104", "id": 2223369691, "node_id": "PR_kwDOF_nm_s5rl2q-", "number": 104, "title": "Add support for unprivileged namespaces on linux", "user": {"login": "one-d-wide", "id": 116499566, "node_id": "U_kgDOBvGkbg", "avatar_url": "https://avatars.githubusercontent.com/u/116499566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/one-d-wide", "html_url": "https://github.com/one-d-wide", "followers_url": "https://api.github.com/users/one-d-wide/followers", "following_url": "https://api.github.com/users/one-d-wide/following{/other_user}", "gists_url": "https://api.github.com/users/one-d-wide/gists{/gist_id}", "starred_url": "https://api.github.com/users/one-d-wide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/one-d-wide/subscriptions", "organizations_url": "https://api.github.com/users/one-d-wide/orgs", "repos_url": "https://api.github.com/users/one-d-wide/repos", "events_url": "https://api.github.com/users/one-d-wide/events{/privacy}", "received_events_url": "https://api.github.com/users/one-d-wide/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": {"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "assignees": [{"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 17, "created_at": "2024-04-03T16:22:56Z", "updated_at": "2024-04-13T15:24:26Z", "closed_at": "2024-04-07T19:52:22Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/104", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/104.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/104.patch", "merged_at": "2024-04-07T19:52:21Z"}, "body": "## Motivation\r\n\r\nHi. I was trying to came up with some solution to make a network environment isolated from a global system setup with all traffic reaching outside routing via the a socks proxy or vpn instance in unprivileged (rootless) manner.\r\n\r\nUsually this would require using something like veth pairs (virtual network interfaces) to bridge namespaces. But required modifications affect the global network namespace therefore require root-like capabilities. That aren't normally available to the user processes.\r\n\r\nThis why I came up with a solution utilizing TUN interface. And since it similar to what this project does, I decided to integrate that functionality here.\r\n\r\nHere are use-cases I wanted to add support for:\r\n- Create an isolated and proxified environment for applications that don't understand proxies by themselves.\r\n- Separate vpn instances from global network namespace.\r\n- Support flatpak application (this is tricky because some containerization solutions are messing up capabilities such that flatpak fails to run).\r\n- Do everything above without requiring root-like capabilities.\r\n\r\n## Implemented features\r\n- Unprivileged mode which creates an isolated network environment (from the global network configuration) and bridges all the traffic reaching outside of it through the proxy. See `--unshare`.\r\n- No-proxy mode which sends routes traffic directly to the requested address. See `--proxy none`.\r\n\r\n## Usage\r\nCreate a new network namespace where all traffic reaching outside is routed through the socks5 proxy.\r\n\r\n```sh\r\n$ tun2proxy --unshare --startup --proxy \"socks5://...\"\r\n...\r\n```\r\n\r\nCreate a new network namespace without additional redirection of traffic with `openvpn` running in it (with root-like capabilities provided to allow network configuration).\r\n\r\n```sh\r\n$ tun2proxy --unshare --startup --proxy \"none\" -- openvpn [...]\r\n...\r\n```\r\n\r\nStart `/bin/sh` in the namespace created by the `tun2proxy` started the latest. Persistent command is suggested in `tun2proxy` output.\r\n\r\n```sh\r\n$ nsenter --target $(pgrep -n tun2proxy) --preserve-credentials --user  --net --mount /bin/sh\r\n```\r\n\r\n## Architecture\r\n\r\nThere are three core ideas in play:\r\n- When a process creates namespace it gains root-like capabilities. I.e. the ability to modify filesystem and network devices it the namespaces. This capability can be passed to descendant processes allowing them to create a TUN devices in unprivileged environment.\r\n- A pair of interconnected `unix(7)` sockets may not only exchange data but also copies of valid file descriptors.\r\nThis mechanism is useful to transfer sockets bonded to the global network to another network namespace.\r\n- File descriptors without `CLOEXEC` flag (it is usually set by the std implementation) are inherited in descending processes.\r\n\r\nUsing those ideas execution flow can be described as follows:\r\n- First `tun2proxy` process with argument `--unshare` generates a pair of interconnected unix sockets unsetting `CLOEXEC` flag on one of those and converting it to raw file descriptor value.\r\n- Then it starts `unshare(1)` process that creates a new namespace.\r\n- `unshare` process is instructed to start `tun2proxy` binary again but this time with `--socket-transfer-fd <fd>` argument where `<fd>` is the raw file descriptor discussed earlier.\r\n- `tun2proxy` process inside the new namespace initializes TUN interface and routing table as normal.\r\n- But since network namespace it is running in is isolated, it can't connect to the proxy server directly. This what unix sockets are required for.\r\n- After initialization is done, it starts transferring network sockets from the first `tun2proxy` process that is still in the global network namespace and sockets created by which are bonded to the global namespace even after the transfer to the descendant process occurs.\r\n- The network admin process (see `[admin command]` cli argument) is started after the network is ready, preserving root-like capabilities, that process could be for example a vpn daemon.\r\n- Then `tun2proxy` operates as usual.\r\n\r\n## Code changes\r\n\r\n- `bin/main.rs` - added a startup routine triggered if `--unshare` is specified.\r\n- `args.rs` - added new cli arguments: `--proxy none`, `--unshare`, `--socket-transfer-fd <fd>`, `[admin\\_command...]`, `udp_timeout`.\r\n- `desktop_api.rs` - added code to spawn an `admin_command` and fix to allow running other proxy in a new namespace. \r\n- `lib.rs` - added functionality to fetch network sockets in case `--socket-tranfer-fd` was specified. Also a small fix to bunch series of `Mutex::lock` into one call where applicable.\r\n- `no_proxy.rs` (created) - implementation of no-proxy mode, basically a no-op since it signals that connection is always established.\r\n- `proxy_handle.rs` (and implementations of proxy protocols) - add `get_server_addr` function to `ProxyHandler` trait, previously server address was supplied directly from cli arguments.\r\n- `socket_transfer.rs` (created) - functionality to safely transfer raw sockets between processes.\r\n\r\n## Notes\r\n\r\n- `tproxy-config` is lacking the support not to set ipv6 routing. This confuses some user application if proxy doesn't support ipv6 connectivity, e.g. causes timeout in resolution and subsequent fail of dns requests (this also could be attributed to `ipstack` not reporting unreachable destinations).\r\n\r\n- `tproxy-config` is always setting *more specific* (compared to `0.0.0.0/0`) routing addresses even if no default route is presented in the network namespace. This causes mutual exclusion in routing tables for `0.0.0.0/1` and `128.0.0.0/1` address spaces with other proxy application (notably `openvpn`).\r\n", "reactions": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, "chosen_detail": {"url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104", "id": 1805085374, "node_id": "PR_kwDOF_nm_s5rl2q-", "html_url": "https://github.com/tun2proxy/tun2proxy/pull/104", "diff_url": "https://github.com/tun2proxy/tun2proxy/pull/104.diff", "patch_url": "https://github.com/tun2proxy/tun2proxy/pull/104.patch", "issue_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104", "number": 104, "state": "closed", "locked": false, "title": "Add support for unprivileged namespaces on linux", "user": {"login": "one-d-wide", "id": 116499566, "node_id": "U_kgDOBvGkbg", "avatar_url": "https://avatars.githubusercontent.com/u/116499566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/one-d-wide", "html_url": "https://github.com/one-d-wide", "followers_url": "https://api.github.com/users/one-d-wide/followers", "following_url": "https://api.github.com/users/one-d-wide/following{/other_user}", "gists_url": "https://api.github.com/users/one-d-wide/gists{/gist_id}", "starred_url": "https://api.github.com/users/one-d-wide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/one-d-wide/subscriptions", "organizations_url": "https://api.github.com/users/one-d-wide/orgs", "repos_url": "https://api.github.com/users/one-d-wide/repos", "events_url": "https://api.github.com/users/one-d-wide/events{/privacy}", "received_events_url": "https://api.github.com/users/one-d-wide/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "body": "## Motivation\r\n\r\nHi. I was trying to came up with some solution to make a network environment isolated from a global system setup with all traffic reaching outside routing via the a socks proxy or vpn instance in unprivileged (rootless) manner.\r\n\r\nUsually this would require using something like veth pairs (virtual network interfaces) to bridge namespaces. But required modifications affect the global network namespace therefore require root-like capabilities. That aren't normally available to the user processes.\r\n\r\nThis why I came up with a solution utilizing TUN interface. And since it similar to what this project does, I decided to integrate that functionality here.\r\n\r\nHere are use-cases I wanted to add support for:\r\n- Create an isolated and proxified environment for applications that don't understand proxies by themselves.\r\n- Separate vpn instances from global network namespace.\r\n- Support flatpak application (this is tricky because some containerization solutions are messing up capabilities such that flatpak fails to run).\r\n- Do everything above without requiring root-like capabilities.\r\n\r\n## Implemented features\r\n- Unprivileged mode which creates an isolated network environment (from the global network configuration) and bridges all the traffic reaching outside of it through the proxy. See `--unshare`.\r\n- No-proxy mode which sends routes traffic directly to the requested address. See `--proxy none`.\r\n\r\n## Usage\r\nCreate a new network namespace where all traffic reaching outside is routed through the socks5 proxy.\r\n\r\n```sh\r\n$ tun2proxy --unshare --startup --proxy \"socks5://...\"\r\n...\r\n```\r\n\r\nCreate a new network namespace without additional redirection of traffic with `openvpn` running in it (with root-like capabilities provided to allow network configuration).\r\n\r\n```sh\r\n$ tun2proxy --unshare --startup --proxy \"none\" -- openvpn [...]\r\n...\r\n```\r\n\r\nStart `/bin/sh` in the namespace created by the `tun2proxy` started the latest. Persistent command is suggested in `tun2proxy` output.\r\n\r\n```sh\r\n$ nsenter --target $(pgrep -n tun2proxy) --preserve-credentials --user  --net --mount /bin/sh\r\n```\r\n\r\n## Architecture\r\n\r\nThere are three core ideas in play:\r\n- When a process creates namespace it gains root-like capabilities. I.e. the ability to modify filesystem and network devices it the namespaces. This capability can be passed to descendant processes allowing them to create a TUN devices in unprivileged environment.\r\n- A pair of interconnected `unix(7)` sockets may not only exchange data but also copies of valid file descriptors.\r\nThis mechanism is useful to transfer sockets bonded to the global network to another network namespace.\r\n- File descriptors without `CLOEXEC` flag (it is usually set by the std implementation) are inherited in descending processes.\r\n\r\nUsing those ideas execution flow can be described as follows:\r\n- First `tun2proxy` process with argument `--unshare` generates a pair of interconnected unix sockets unsetting `CLOEXEC` flag on one of those and converting it to raw file descriptor value.\r\n- Then it starts `unshare(1)` process that creates a new namespace.\r\n- `unshare` process is instructed to start `tun2proxy` binary again but this time with `--socket-transfer-fd <fd>` argument where `<fd>` is the raw file descriptor discussed earlier.\r\n- `tun2proxy` process inside the new namespace initializes TUN interface and routing table as normal.\r\n- But since network namespace it is running in is isolated, it can't connect to the proxy server directly. This what unix sockets are required for.\r\n- After initialization is done, it starts transferring network sockets from the first `tun2proxy` process that is still in the global network namespace and sockets created by which are bonded to the global namespace even after the transfer to the descendant process occurs.\r\n- The network admin process (see `[admin command]` cli argument) is started after the network is ready, preserving root-like capabilities, that process could be for example a vpn daemon.\r\n- Then `tun2proxy` operates as usual.\r\n\r\n## Code changes\r\n\r\n- `bin/main.rs` - added a startup routine triggered if `--unshare` is specified.\r\n- `args.rs` - added new cli arguments: `--proxy none`, `--unshare`, `--socket-transfer-fd <fd>`, `[admin\\_command...]`, `udp_timeout`.\r\n- `desktop_api.rs` - added code to spawn an `admin_command` and fix to allow running other proxy in a new namespace. \r\n- `lib.rs` - added functionality to fetch network sockets in case `--socket-tranfer-fd` was specified. Also a small fix to bunch series of `Mutex::lock` into one call where applicable.\r\n- `no_proxy.rs` (created) - implementation of no-proxy mode, basically a no-op since it signals that connection is always established.\r\n- `proxy_handle.rs` (and implementations of proxy protocols) - add `get_server_addr` function to `ProxyHandler` trait, previously server address was supplied directly from cli arguments.\r\n- `socket_transfer.rs` (created) - functionality to safely transfer raw sockets between processes.\r\n\r\n## Notes\r\n\r\n- `tproxy-config` is lacking the support not to set ipv6 routing. This confuses some user application if proxy doesn't support ipv6 connectivity, e.g. causes timeout in resolution and subsequent fail of dns requests (this also could be attributed to `ipstack` not reporting unreachable destinations).\r\n\r\n- `tproxy-config` is always setting *more specific* (compared to `0.0.0.0/0`) routing addresses even if no default route is presented in the network namespace. This causes mutual exclusion in routing tables for `0.0.0.0/1` and `128.0.0.0/1` address spaces with other proxy application (notably `openvpn`).\r\n", "created_at": "2024-04-03T16:22:56Z", "updated_at": "2024-04-13T15:24:26Z", "closed_at": "2024-04-07T19:52:22Z", "merged_at": "2024-04-07T19:52:21Z", "merge_commit_sha": "0239a225a1b5a6fe6da47e8b1b2bb1d018129bc2", "assignee": {"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "assignees": [{"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "draft": false, "commits_url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104/commits", "review_comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104/comments", "review_comment_url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/comments", "statuses_url": "https://api.github.com/repos/tun2proxy/tun2proxy/statuses/40368dd232ee2a8c0640db76e5bc39bdce8474ec", "head": {"label": "one-d-wide:namespaces", "ref": "namespaces", "sha": "40368dd232ee2a8c0640db76e5bc39bdce8474ec", "user": {"login": "one-d-wide", "id": 116499566, "node_id": "U_kgDOBvGkbg", "avatar_url": "https://avatars.githubusercontent.com/u/116499566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/one-d-wide", "html_url": "https://github.com/one-d-wide", "followers_url": "https://api.github.com/users/one-d-wide/followers", "following_url": "https://api.github.com/users/one-d-wide/following{/other_user}", "gists_url": "https://api.github.com/users/one-d-wide/gists{/gist_id}", "starred_url": "https://api.github.com/users/one-d-wide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/one-d-wide/subscriptions", "organizations_url": "https://api.github.com/users/one-d-wide/orgs", "repos_url": "https://api.github.com/users/one-d-wide/repos", "events_url": "https://api.github.com/users/one-d-wide/events{/privacy}", "received_events_url": "https://api.github.com/users/one-d-wide/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "repo": {"id": 781503500, "node_id": "R_kgDOLpTMDA", "name": "tun2proxy", "full_name": "one-d-wide/tun2proxy", "private": false, "owner": {"login": "one-d-wide", "id": 116499566, "node_id": "U_kgDOBvGkbg", "avatar_url": "https://avatars.githubusercontent.com/u/116499566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/one-d-wide", "html_url": "https://github.com/one-d-wide", "followers_url": "https://api.github.com/users/one-d-wide/followers", "following_url": "https://api.github.com/users/one-d-wide/following{/other_user}", "gists_url": "https://api.github.com/users/one-d-wide/gists{/gist_id}", "starred_url": "https://api.github.com/users/one-d-wide/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/one-d-wide/subscriptions", "organizations_url": "https://api.github.com/users/one-d-wide/orgs", "repos_url": "https://api.github.com/users/one-d-wide/repos", "events_url": "https://api.github.com/users/one-d-wide/events{/privacy}", "received_events_url": "https://api.github.com/users/one-d-wide/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/one-d-wide/tun2proxy", "description": "Tunnel (TUN) interface for SOCKS and HTTP proxies", "fork": true, "url": "https://api.github.com/repos/one-d-wide/tun2proxy", "forks_url": "https://api.github.com/repos/one-d-wide/tun2proxy/forks", "keys_url": "https://api.github.com/repos/one-d-wide/tun2proxy/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/one-d-wide/tun2proxy/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/one-d-wide/tun2proxy/teams", "hooks_url": "https://api.github.com/repos/one-d-wide/tun2proxy/hooks", "issue_events_url": "https://api.github.com/repos/one-d-wide/tun2proxy/issues/events{/number}", "events_url": "https://api.github.com/repos/one-d-wide/tun2proxy/events", "assignees_url": "https://api.github.com/repos/one-d-wide/tun2proxy/assignees{/user}", "branches_url": "https://api.github.com/repos/one-d-wide/tun2proxy/branches{/branch}", "tags_url": "https://api.github.com/repos/one-d-wide/tun2proxy/tags", "blobs_url": "https://api.github.com/repos/one-d-wide/tun2proxy/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/one-d-wide/tun2proxy/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/one-d-wide/tun2proxy/git/refs{/sha}", "trees_url": "https://api.github.com/repos/one-d-wide/tun2proxy/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/one-d-wide/tun2proxy/statuses/{sha}", "languages_url": "https://api.github.com/repos/one-d-wide/tun2proxy/languages", "stargazers_url": "https://api.github.com/repos/one-d-wide/tun2proxy/stargazers", "contributors_url": "https://api.github.com/repos/one-d-wide/tun2proxy/contributors", "subscribers_url": "https://api.github.com/repos/one-d-wide/tun2proxy/subscribers", "subscription_url": "https://api.github.com/repos/one-d-wide/tun2proxy/subscription", "commits_url": "https://api.github.com/repos/one-d-wide/tun2proxy/commits{/sha}", "git_commits_url": "https://api.github.com/repos/one-d-wide/tun2proxy/git/commits{/sha}", "comments_url": "https://api.github.com/repos/one-d-wide/tun2proxy/comments{/number}", "issue_comment_url": "https://api.github.com/repos/one-d-wide/tun2proxy/issues/comments{/number}", "contents_url": "https://api.github.com/repos/one-d-wide/tun2proxy/contents/{+path}", "compare_url": "https://api.github.com/repos/one-d-wide/tun2proxy/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/one-d-wide/tun2proxy/merges", "archive_url": "https://api.github.com/repos/one-d-wide/tun2proxy/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/one-d-wide/tun2proxy/downloads", "issues_url": "https://api.github.com/repos/one-d-wide/tun2proxy/issues{/number}", "pulls_url": "https://api.github.com/repos/one-d-wide/tun2proxy/pulls{/number}", "milestones_url": "https://api.github.com/repos/one-d-wide/tun2proxy/milestones{/number}", "notifications_url": "https://api.github.com/repos/one-d-wide/tun2proxy/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/one-d-wide/tun2proxy/labels{/name}", "releases_url": "https://api.github.com/repos/one-d-wide/tun2proxy/releases{/id}", "deployments_url": "https://api.github.com/repos/one-d-wide/tun2proxy/deployments", "created_at": "2024-04-03T14:04:14Z", "updated_at": "2024-06-29T10:22:27Z", "pushed_at": "2024-06-29T10:22:20Z", "git_url": "git://github.com/one-d-wide/tun2proxy.git", "ssh_url": "git@github.com:one-d-wide/tun2proxy.git", "clone_url": "https://github.com/one-d-wide/tun2proxy.git", "svn_url": "https://github.com/one-d-wide/tun2proxy", "homepage": "", "size": 2346, "stargazers_count": 0, "watchers_count": 0, "language": "Rust", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": false, "forks_count": 0, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 0, "license": {"key": "mit", "name": "MIT License", "spdx_id": "MIT", "url": "https://api.github.com/licenses/mit", "node_id": "MDc6TGljZW5zZTEz"}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "tun2proxy:master", "ref": "master", "sha": "050f8c0e65ce3f01e6acc8deeea99bf4cfb20fde", "user": {"login": "tun2proxy", "id": 166490253, "node_id": "O_kgDOCexwjQ", "avatar_url": "https://avatars.githubusercontent.com/u/166490253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tun2proxy", "html_url": "https://github.com/tun2proxy", "followers_url": "https://api.github.com/users/tun2proxy/followers", "following_url": "https://api.github.com/users/tun2proxy/following{/other_user}", "gists_url": "https://api.github.com/users/tun2proxy/gists{/gist_id}", "starred_url": "https://api.github.com/users/tun2proxy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tun2proxy/subscriptions", "organizations_url": "https://api.github.com/users/tun2proxy/orgs", "repos_url": "https://api.github.com/users/tun2proxy/repos", "events_url": "https://api.github.com/users/tun2proxy/events{/privacy}", "received_events_url": "https://api.github.com/users/tun2proxy/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "repo": {"id": 402253566, "node_id": "MDEwOlJlcG9zaXRvcnk0MDIyNTM1NjY=", "name": "tun2proxy", "full_name": "tun2proxy/tun2proxy", "private": false, "owner": {"login": "tun2proxy", "id": 166490253, "node_id": "O_kgDOCexwjQ", "avatar_url": "https://avatars.githubusercontent.com/u/166490253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tun2proxy", "html_url": "https://github.com/tun2proxy", "followers_url": "https://api.github.com/users/tun2proxy/followers", "following_url": "https://api.github.com/users/tun2proxy/following{/other_user}", "gists_url": "https://api.github.com/users/tun2proxy/gists{/gist_id}", "starred_url": "https://api.github.com/users/tun2proxy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tun2proxy/subscriptions", "organizations_url": "https://api.github.com/users/tun2proxy/orgs", "repos_url": "https://api.github.com/users/tun2proxy/repos", "events_url": "https://api.github.com/users/tun2proxy/events{/privacy}", "received_events_url": "https://api.github.com/users/tun2proxy/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/tun2proxy/tun2proxy", "description": "Tunnel (TUN) interface for SOCKS and HTTP proxies", "fork": false, "url": "https://api.github.com/repos/tun2proxy/tun2proxy", "forks_url": "https://api.github.com/repos/tun2proxy/tun2proxy/forks", "keys_url": "https://api.github.com/repos/tun2proxy/tun2proxy/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/tun2proxy/tun2proxy/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/tun2proxy/tun2proxy/teams", "hooks_url": "https://api.github.com/repos/tun2proxy/tun2proxy/hooks", "issue_events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/events{/number}", "events_url": "https://api.github.com/repos/tun2proxy/tun2proxy/events", "assignees_url": "https://api.github.com/repos/tun2proxy/tun2proxy/assignees{/user}", "branches_url": "https://api.github.com/repos/tun2proxy/tun2proxy/branches{/branch}", "tags_url": "https://api.github.com/repos/tun2proxy/tun2proxy/tags", "blobs_url": "https://api.github.com/repos/tun2proxy/tun2proxy/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/tun2proxy/tun2proxy/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/tun2proxy/tun2proxy/git/refs{/sha}", "trees_url": "https://api.github.com/repos/tun2proxy/tun2proxy/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/tun2proxy/tun2proxy/statuses/{sha}", "languages_url": "https://api.github.com/repos/tun2proxy/tun2proxy/languages", "stargazers_url": "https://api.github.com/repos/tun2proxy/tun2proxy/stargazers", "contributors_url": "https://api.github.com/repos/tun2proxy/tun2proxy/contributors", "subscribers_url": "https://api.github.com/repos/tun2proxy/tun2proxy/subscribers", "subscription_url": "https://api.github.com/repos/tun2proxy/tun2proxy/subscription", "commits_url": "https://api.github.com/repos/tun2proxy/tun2proxy/commits{/sha}", "git_commits_url": "https://api.github.com/repos/tun2proxy/tun2proxy/git/commits{/sha}", "comments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/comments{/number}", "issue_comment_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/comments{/number}", "contents_url": "https://api.github.com/repos/tun2proxy/tun2proxy/contents/{+path}", "compare_url": "https://api.github.com/repos/tun2proxy/tun2proxy/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/tun2proxy/tun2proxy/merges", "archive_url": "https://api.github.com/repos/tun2proxy/tun2proxy/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/tun2proxy/tun2proxy/downloads", "issues_url": "https://api.github.com/repos/tun2proxy/tun2proxy/issues{/number}", "pulls_url": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls{/number}", "milestones_url": "https://api.github.com/repos/tun2proxy/tun2proxy/milestones{/number}", "notifications_url": "https://api.github.com/repos/tun2proxy/tun2proxy/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/tun2proxy/tun2proxy/labels{/name}", "releases_url": "https://api.github.com/repos/tun2proxy/tun2proxy/releases{/id}", "deployments_url": "https://api.github.com/repos/tun2proxy/tun2proxy/deployments", "created_at": "2021-09-02T01:34:14Z", "updated_at": "2026-01-20T13:10:25Z", "pushed_at": "2025-12-31T04:04:51Z", "git_url": "git://github.com/tun2proxy/tun2proxy.git", "ssh_url": "git@github.com:tun2proxy/tun2proxy.git", "clone_url": "https://github.com/tun2proxy/tun2proxy.git", "svn_url": "https://github.com/tun2proxy/tun2proxy", "homepage": "", "size": 2583, "stargazers_count": 1152, "watchers_count": 1152, "language": "Rust", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": true, "forks_count": 153, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 8, "license": {"key": "mit", "name": "MIT License", "spdx_id": "MIT", "url": "https://api.github.com/licenses/mit", "node_id": "MDc6TGljZW5zZTEz"}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": ["http-proxy", "proxy", "socks", "socks5", "tun2http", "tun2proxy", "tun2socks", "tunnel"], "visibility": "public", "forks": 153, "open_issues": 8, "watchers": 1152, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104"}, "html": {"href": "https://github.com/tun2proxy/tun2proxy/pull/104"}, "issue": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104"}, "comments": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/issues/104/comments"}, "review_comments": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104/comments"}, "review_comment": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/pulls/104/commits"}, "statuses": {"href": "https://api.github.com/repos/tun2proxy/tun2proxy/statuses/40368dd232ee2a8c0640db76e5bc39bdce8474ec"}}, "author_association": "CONTRIBUTOR", "auto_merge": null, "active_lock_reason": null, "merged": true, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": {"login": "blechschmidt", "id": 18330291, "node_id": "MDQ6VXNlcjE4MzMwMjkx", "avatar_url": "https://avatars.githubusercontent.com/u/18330291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/blechschmidt", "html_url": "https://github.com/blechschmidt", "followers_url": "https://api.github.com/users/blechschmidt/followers", "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}", "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}", "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions", "organizations_url": "https://api.github.com/users/blechschmidt/orgs", "repos_url": "https://api.github.com/users/blechschmidt/repos", "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}", "received_events_url": "https://api.github.com/users/blechschmidt/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "comments": 17, "review_comments": 0, "maintainer_can_modify": false, "commits": 12, "additions": 820, "deletions": 85, "changed_files": 13}}