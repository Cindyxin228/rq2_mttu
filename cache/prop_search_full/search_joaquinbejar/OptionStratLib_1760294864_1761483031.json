[{"url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/issues/190", "repository_url": "https://api.github.com/repos/joaquinbejar/OptionStratLib", "labels_url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/issues/190/labels{/name}", "comments_url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/issues/190/comments", "events_url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/issues/190/events", "html_url": "https://github.com/joaquinbejar/OptionStratLib/pull/190", "id": 3553809692, "node_id": "PR_kwDOMd1O686vvNoj", "number": 190, "title": "Adjust `OptionData` struct serialization by replacing `#[serde(skip)]\u2026", "user": {"login": "joaquinbejar", "id": 99006095, "node_id": "U_kgDOBea2jw", "avatar_url": "https://avatars.githubusercontent.com/u/99006095?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joaquinbejar", "html_url": "https://github.com/joaquinbejar", "followers_url": "https://api.github.com/users/joaquinbejar/followers", "following_url": "https://api.github.com/users/joaquinbejar/following{/other_user}", "gists_url": "https://api.github.com/users/joaquinbejar/gists{/gist_id}", "starred_url": "https://api.github.com/users/joaquinbejar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joaquinbejar/subscriptions", "organizations_url": "https://api.github.com/users/joaquinbejar/orgs", "repos_url": "https://api.github.com/users/joaquinbejar/repos", "events_url": "https://api.github.com/users/joaquinbejar/events{/privacy}", "received_events_url": "https://api.github.com/users/joaquinbejar/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2025-10-26T11:44:54Z", "updated_at": "2025-12-05T16:32:46Z", "closed_at": "2025-10-26T11:46:54Z", "author_association": "OWNER", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/pulls/190", "html_url": "https://github.com/joaquinbejar/OptionStratLib/pull/190", "diff_url": "https://github.com/joaquinbejar/OptionStratLib/pull/190.diff", "patch_url": "https://github.com/joaquinbejar/OptionStratLib/pull/190.patch", "merged_at": "2025-10-26T11:46:54Z"}, "body": "# Integrate `utoipa::ToSchema` Support and Expand PnL Simulation Features\r\n\r\n## Description\r\nThis pull request introduces significant enhancements to the project\u2019s OpenAPI documentation, PnL calculation logic, and CI/CD workflows.  \r\nKey updates include the integration of `utoipa::ToSchema` for schema generation, improved option PnL management via new modules and methods, refined serialization behavior, and enhanced robustness in CI workflows.\r\n\r\nThe `OptionData` struct serialization has been improved to skip `None` fields instead of all skipped fields, enhancing OpenAPI compatibility.  \r\nAdditionally, a new Monte Carlo simulation HTML visualization has been added for interactive exploration of simulation results.\r\n\r\n---\r\n\r\n## Changes Made\r\n- **OpenAPI Integration**\r\n  - Added `utoipa::ToSchema` to various structs and enums for automatic OpenAPI schema generation.\r\n  - Refactored `DeltaAdjustment::SameSize` for better readability and structure.\r\n  - Replaced nested tuples with a dedicated struct for clarity.\r\n\r\n- **PnL and Portfolio Management**\r\n  - Added new `balance` module featuring:\r\n    - `Balance`, `MarginInfo`, and `Portfolio` structs.\r\n    - Methods for managing option positions, computing PnL, and tracking portfolio metrics.\r\n  - Implemented `diff_position_pnl` method to compare and analyze PnL differences between positions.\r\n  - Introduced `UnderlyingAssetType` enum with a `fmt::Display` implementation for cleaner output.\r\n  - Added error checks and validation for position attributes.\r\n\r\n- **Serialization Improvements**\r\n  - Updated `OptionData` struct serialization:\r\n    - Replaced `#[serde(skip)]` with `#[serde(skip_serializing_if = \"Option::is_none\")]`.\r\n    - Ensures more accurate JSON output for OpenAPI documentation.\r\n\r\n- **Visualization**\r\n  - Added **Monte Carlo Simulation HTML visualization** for enhanced interpretability of simulation results.\r\n\r\n- **Workflow Enhancements**\r\n  - Improved Rust CI workflow with:\r\n    - Retry mechanisms and fallback installation steps.\r\n    - Network diagnostics and reliability configurations.\r\n  - Expanded code coverage workflow with improved error handling and resiliency.\r\n\r\n- **Versioning**\r\n  - Bumped project version to **v0.8.1** and updated documentation accordingly.\r\n\r\n---\r\n\r\n## Testing\r\n- **Unit Tests**\r\n  - Added tests for new `balance` and `Portfolio` modules.\r\n  - Validated `diff_position_pnl` logic under diverse market conditions.\r\n  - Tested new serialization behavior for `OptionData`.\r\n- **Integration Tests**\r\n  - Verified OpenAPI schema generation via `utoipa`.\r\n- **Manual Testing**\r\n  - Confirmed Monte Carlo simulation HTML rendering and accuracy.\r\n  - Manually tested CI fallback and retry logic in workflow pipelines.\r\n\r\n---\r\n\r\n## Screenshots/Examples\r\n*(Optional, attach Monte Carlo simulation HTML screenshots or schema examples if available.)*\r\n\r\n---\r\n\r\n## Additional Notes\r\n- The integration of `utoipa` streamlines OpenAPI generation and aligns with future REST API documentation goals.\r\n- The new PnL framework enhances modularity and testability.\r\n- Future work may include adding risk metrics (Greeks) integration and extending Monte Carlo visualization interactivity.\r\n\r\n---\r\n\r\n## References\r\n- Relates to version milestone **v0.8.1**.\r\n- Associated commits:\r\n  - `dacb6002`, `240c2c43`, `27d80857`, `2e9cfd45`, `82903bbe`, `838a753f`, `a586c065`.\r\n\r\n---\r\n\r\n## Checklist\r\n- [x] Added `utoipa::ToSchema` for OpenAPI integration.  \r\n- [x] Implemented new `balance` and `Portfolio` modules.  \r\n- [x] Improved serialization logic for `OptionData`.  \r\n- [x] Added HTML visualization for Monte Carlo simulations.  \r\n- [x] Enhanced CI/CD workflow reliability.  \r\n- [x] All tests passing.  \r\n- [x] Documentation and version bumped to `v0.8.1`.  ", "reactions": {"url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/issues/190/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/joaquinbejar/OptionStratLib/issues/190/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]