[{"url": "https://api.github.com/repos/panamax-rs/panamax/issues/41", "repository_url": "https://api.github.com/repos/panamax-rs/panamax", "labels_url": "https://api.github.com/repos/panamax-rs/panamax/issues/41/labels{/name}", "comments_url": "https://api.github.com/repos/panamax-rs/panamax/issues/41/comments", "events_url": "https://api.github.com/repos/panamax-rs/panamax/issues/41/events", "html_url": "https://github.com/panamax-rs/panamax/pull/41", "id": 988681740, "node_id": "MDExOlB1bGxSZXF1ZXN0NzI3NTM4Njc3", "number": 41, "title": "Overhaul the download process to use tokio + async", "user": {"login": "DrChat", "id": 2402369, "node_id": "MDQ6VXNlcjI0MDIzNjk=", "avatar_url": "https://avatars.githubusercontent.com/u/2402369?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DrChat", "html_url": "https://github.com/DrChat", "followers_url": "https://api.github.com/users/DrChat/followers", "following_url": "https://api.github.com/users/DrChat/following{/other_user}", "gists_url": "https://api.github.com/users/DrChat/gists{/gist_id}", "starred_url": "https://api.github.com/users/DrChat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DrChat/subscriptions", "organizations_url": "https://api.github.com/users/DrChat/orgs", "repos_url": "https://api.github.com/users/DrChat/repos", "events_url": "https://api.github.com/users/DrChat/events{/privacy}", "received_events_url": "https://api.github.com/users/DrChat/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 18, "created_at": "2021-09-06T02:27:33Z", "updated_at": "2021-09-08T16:58:26Z", "closed_at": "2021-09-08T01:08:32Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/panamax-rs/panamax/pulls/41", "html_url": "https://github.com/panamax-rs/panamax/pull/41", "diff_url": "https://github.com/panamax-rs/panamax/pull/41.diff", "patch_url": "https://github.com/panamax-rs/panamax/pull/41.patch", "merged_at": "2021-09-08T01:08:32Z"}, "body": "This PR overhauls a significant portion of the code responsible for downloading files from both crates.io and rustup.\r\nInstead of using a blocking `reqwest` client, this changes functionality such that anything that was previously blocking is now async, all the way up to the `main` function.\r\n\r\nThat way we can remove all the code and complexity that deals with manual thread management and leave it up to the `tokio` multithreaded runtime.\r\n\r\nIn addition, several other changes were made:\r\n* Remove the progress bar thread. `indicatif` is `Send + Sync` capable, and their progress bars are implemented very similar to a `std::sync::Arc`.\r\n* Code was deduplicated in several spots\r\n* In `download`, if the file already exists on the filesystem and a hash was provided, we will verify the file on the filesystem and redownload it if it's invalid.\r\n* Options were added to specify whether or not to download GZ and XZ archives. Rustup uses the more efficient XZ compression nowadays, so GZ is safe to disable by default.\r\n* Fix some bugs dealing with path separator differences on Unix vs. Windows.\r\n\r\nFixes #38.", "reactions": {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/41/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/panamax-rs/panamax/issues/41/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/40", "repository_url": "https://api.github.com/repos/panamax-rs/panamax", "labels_url": "https://api.github.com/repos/panamax-rs/panamax/issues/40/labels{/name}", "comments_url": "https://api.github.com/repos/panamax-rs/panamax/issues/40/comments", "events_url": "https://api.github.com/repos/panamax-rs/panamax/issues/40/events", "html_url": "https://github.com/panamax-rs/panamax/pull/40", "id": 987957716, "node_id": "MDExOlB1bGxSZXF1ZXN0NzI2OTY2Njg3", "number": 40, "title": "Clarify the use of static.crates.io", "user": {"login": "aidanhs", "id": 1050652, "node_id": "MDQ6VXNlcjEwNTA2NTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1050652?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aidanhs", "html_url": "https://github.com/aidanhs", "followers_url": "https://api.github.com/users/aidanhs/followers", "following_url": "https://api.github.com/users/aidanhs/following{/other_user}", "gists_url": "https://api.github.com/users/aidanhs/gists{/gist_id}", "starred_url": "https://api.github.com/users/aidanhs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aidanhs/subscriptions", "organizations_url": "https://api.github.com/users/aidanhs/orgs", "repos_url": "https://api.github.com/users/aidanhs/repos", "events_url": "https://api.github.com/users/aidanhs/events{/privacy}", "received_events_url": "https://api.github.com/users/aidanhs/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-09-03T17:04:31Z", "updated_at": "2021-09-08T00:49:10Z", "closed_at": "2021-09-08T00:49:06Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/panamax-rs/panamax/pulls/40", "html_url": "https://github.com/panamax-rs/panamax/pull/40", "diff_url": "https://github.com/panamax-rs/panamax/pull/40.diff", "patch_url": "https://github.com/panamax-rs/panamax/pull/40.patch", "merged_at": "2021-09-08T00:49:06Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/40/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/panamax-rs/panamax/issues/40/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/36", "repository_url": "https://api.github.com/repos/panamax-rs/panamax", "labels_url": "https://api.github.com/repos/panamax-rs/panamax/issues/36/labels{/name}", "comments_url": "https://api.github.com/repos/panamax-rs/panamax/issues/36/comments", "events_url": "https://api.github.com/repos/panamax-rs/panamax/issues/36/events", "html_url": "https://github.com/panamax-rs/panamax/pull/36", "id": 947099305, "node_id": "MDExOlB1bGxSZXF1ZXN0NjkyMTM1MjMw", "number": 36, "title": "Fix inverted download_dev logic", "user": {"login": "sapir", "id": 896766, "node_id": "MDQ6VXNlcjg5Njc2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/896766?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sapir", "html_url": "https://github.com/sapir", "followers_url": "https://api.github.com/users/sapir/followers", "following_url": "https://api.github.com/users/sapir/following{/other_user}", "gists_url": "https://api.github.com/users/sapir/gists{/gist_id}", "starred_url": "https://api.github.com/users/sapir/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sapir/subscriptions", "organizations_url": "https://api.github.com/users/sapir/orgs", "repos_url": "https://api.github.com/users/sapir/repos", "events_url": "https://api.github.com/users/sapir/events{/privacy}", "received_events_url": "https://api.github.com/users/sapir/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-07-18T19:09:09Z", "updated_at": "2021-07-21T23:58:54Z", "closed_at": "2021-07-21T23:58:50Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/panamax-rs/panamax/pulls/36", "html_url": "https://github.com/panamax-rs/panamax/pull/36", "diff_url": "https://github.com/panamax-rs/panamax/pull/36.diff", "patch_url": "https://github.com/panamax-rs/panamax/pull/36.patch", "merged_at": "2021-07-21T23:58:50Z"}, "body": "oops :(", "reactions": {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/36/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/panamax-rs/panamax/issues/36/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/35", "repository_url": "https://api.github.com/repos/panamax-rs/panamax", "labels_url": "https://api.github.com/repos/panamax-rs/panamax/issues/35/labels{/name}", "comments_url": "https://api.github.com/repos/panamax-rs/panamax/issues/35/comments", "events_url": "https://api.github.com/repos/panamax-rs/panamax/issues/35/events", "html_url": "https://github.com/panamax-rs/panamax/pull/35", "id": 937148754, "node_id": "MDExOlB1bGxSZXF1ZXN0NjgzNzUxNDQ5", "number": 35, "title": "Add panamax serve command", "user": {"login": "k3d3", "id": 1247908, "node_id": "MDQ6VXNlcjEyNDc5MDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1247908?v=4", "gravatar_id": "", "url": "https://api.github.com/users/k3d3", "html_url": "https://github.com/k3d3", "followers_url": "https://api.github.com/users/k3d3/followers", "following_url": "https://api.github.com/users/k3d3/following{/other_user}", "gists_url": "https://api.github.com/users/k3d3/gists{/gist_id}", "starred_url": "https://api.github.com/users/k3d3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/k3d3/subscriptions", "organizations_url": "https://api.github.com/users/k3d3/orgs", "repos_url": "https://api.github.com/users/k3d3/repos", "events_url": "https://api.github.com/users/k3d3/events{/privacy}", "received_events_url": "https://api.github.com/users/k3d3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2021-07-05T14:29:33Z", "updated_at": "2021-07-07T01:48:58Z", "closed_at": "2021-07-07T01:48:58Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/panamax-rs/panamax/pulls/35", "html_url": "https://github.com/panamax-rs/panamax/pull/35", "diff_url": "https://github.com/panamax-rs/panamax/pull/35.diff", "patch_url": "https://github.com/panamax-rs/panamax/pull/35.patch", "merged_at": "2021-07-07T01:48:58Z"}, "body": "Adds a command that handles serving a panamax mirror via HTTP or HTTPS.\r\n\r\nHandles crates downloading, rustup download and self-updating, and serving the crates.io-index git repository.\r\n\r\nAlso includes instructions on how to use the mirror with rustup and cargo on the homepage.\r\n\r\nThe web server uses warp, so it should be able to serve many clients at once.\r\n\r\n![image](https://user-images.githubusercontent.com/1247908/124486502-830af900-dd62-11eb-9663-f32038be10e2.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1247908/124486543-9027e800-dd62-11eb-926f-a953d51ba404.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1247908/124486572-98802300-dd62-11eb-9535-f28124f61585.png)\r\n\r\n![image](https://user-images.githubusercontent.com/1247908/124486646-a9c92f80-dd62-11eb-86af-d6a76454eb6a.png)\r\n\r\nCloses #14 .", "reactions": {"url": "https://api.github.com/repos/panamax-rs/panamax/issues/35/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/panamax-rs/panamax/issues/35/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]