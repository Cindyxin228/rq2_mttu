[{"url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/issues/1", "repository_url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer", "labels_url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/issues/1/comments", "events_url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/issues/1/events", "html_url": "https://github.com/Bathtor/rust-hash-wheel-timer/pull/1", "id": 952648106, "node_id": "MDExOlB1bGxSZXF1ZXN0Njk2ODExMDc4", "number": 1, "title": "Remove arr! macro as it generates huge amount of LLVM IR", "user": {"login": "Max-Meldrum", "id": 11488530, "node_id": "MDQ6VXNlcjExNDg4NTMw", "avatar_url": "https://avatars.githubusercontent.com/u/11488530?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Max-Meldrum", "html_url": "https://github.com/Max-Meldrum", "followers_url": "https://api.github.com/users/Max-Meldrum/followers", "following_url": "https://api.github.com/users/Max-Meldrum/following{/other_user}", "gists_url": "https://api.github.com/users/Max-Meldrum/gists{/gist_id}", "starred_url": "https://api.github.com/users/Max-Meldrum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Max-Meldrum/subscriptions", "organizations_url": "https://api.github.com/users/Max-Meldrum/orgs", "repos_url": "https://api.github.com/users/Max-Meldrum/repos", "events_url": "https://api.github.com/users/Max-Meldrum/events{/privacy}", "received_events_url": "https://api.github.com/users/Max-Meldrum/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2021-07-26T08:32:20Z", "updated_at": "2021-07-27T09:15:37Z", "closed_at": "2021-07-27T09:03:47Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/pulls/1", "html_url": "https://github.com/Bathtor/rust-hash-wheel-timer/pull/1", "diff_url": "https://github.com/Bathtor/rust-hash-wheel-timer/pull/1.diff", "patch_url": "https://github.com/Bathtor/rust-hash-wheel-timer/pull/1.patch", "merged_at": "2021-07-27T09:03:47Z"}, "body": "I executed ``cargo llvm-lines`` on Arcon and Kompact and thought it was strange that ``ByteWheel::New`` stood for quite a large part of the generated LLVM IR. See below.\r\n\r\n![wheel_old](https://user-images.githubusercontent.com/11488530/126957601-b77188cf-aa32-4361-9241-5771b21677d7.PNG)\r\nand Kompact:\r\n![kompact_1](https://user-images.githubusercontent.com/11488530/126957678-3fdb2c04-3302-42d6-9a2c-b31e8cfc807c.PNG)\r\n\r\n\r\nI am not sure what is happening in that arr_macro but by turning the slots into a Boxed slice, it now looks like this:\r\n\r\n![wheel_actual_2](https://user-images.githubusercontent.com/11488530/126958096-38f91459-2b04-40fa-b770-c91d070d75cf.PNG)\r\n\r\n\r\nI ran cargo bench to see if performance was affected, but it looked like it even got better for most parts. But this should be checked again perhaps.  The big win  here is compile time. A release kompact build on my desktop went from 1 min to 42s after the change.", "reactions": {"url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/Bathtor/rust-hash-wheel-timer/issues/1/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]