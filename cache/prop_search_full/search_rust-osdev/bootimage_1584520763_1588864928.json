[{"url": "https://api.github.com/repos/rust-osdev/bootimage/issues/55", "repository_url": "https://api.github.com/repos/rust-osdev/bootimage", "labels_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/55/labels{/name}", "comments_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/55/comments", "events_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/55/events", "html_url": "https://github.com/rust-osdev/bootimage/pull/55", "id": 613877153, "node_id": "MDExOlB1bGxSZXF1ZXN0NDE0NTQxODUz", "number": 55, "title": "Rewrite: Remove support for `bootimage {run, test}`", "user": {"login": "phil-opp", "id": 1131315, "node_id": "MDQ6VXNlcjExMzEzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1131315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phil-opp", "html_url": "https://github.com/phil-opp", "followers_url": "https://api.github.com/users/phil-opp/followers", "following_url": "https://api.github.com/users/phil-opp/following{/other_user}", "gists_url": "https://api.github.com/users/phil-opp/gists{/gist_id}", "starred_url": "https://api.github.com/users/phil-opp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phil-opp/subscriptions", "organizations_url": "https://api.github.com/users/phil-opp/orgs", "repos_url": "https://api.github.com/users/phil-opp/repos", "events_url": "https://api.github.com/users/phil-opp/events{/privacy}", "received_events_url": "https://api.github.com/users/phil-opp/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-05-07T08:37:08Z", "updated_at": "2020-05-07T14:23:50Z", "closed_at": "2020-05-07T14:13:19Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/rust-osdev/bootimage/pulls/55", "html_url": "https://github.com/rust-osdev/bootimage/pull/55", "diff_url": "https://github.com/rust-osdev/bootimage/pull/55.diff", "patch_url": "https://github.com/rust-osdev/bootimage/pull/55.patch", "merged_at": "2020-05-07T14:13:18Z"}, "body": "This pull request rewrites the `bootimage` crate almost completely. The most notable changes are:\r\n\r\n- **Breaking:** Removes support for the old `bootimage run` and `bootimage test` commands because they were difficult to maintain.\r\n- **Breaking:** Removes support for the `default-target` config key because it did not play nice with cargo workspaces.\r\n- **Breaking:** The crate structure was changed completely, so users who use `bootimage` as a library will need to update their code when updating to the new (semver-incompatible) API.\r\n- Rewrite the code for finding the kernel `Cargo.toml` file to make `bootimage` work with cargo workspaces.\r\n- Switches error handling to the `anyhow`/`thiserror` crates.\r\n- Updates some dependencies.\r\n\r\n## Migration\r\n\r\nUsers of `bootimage run` should switch to the runner-based API provided by the `bootimage runner` sucommand as described [here](https://os.phil-opp.com/minimal-rust-kernel/#using-cargo-run). Instead of `bootimage test`, [custom test frameworks](https://os.phil-opp.com/testing/#custom-test-frameworks) should be used together with `cargo xtest`. Instead of using the `default-target` config key, setting a default target is possible [through a `build.target` key](https://os.phil-opp.com/minimal-rust-kernel/#set-a-default-target) in a `.cargo/config` file.\r\n\r\n---\r\n\r\nFixes #54 ", "reactions": {"url": "https://api.github.com/repos/rust-osdev/bootimage/issues/55/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/55/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/rust-osdev/bootimage/issues/52", "repository_url": "https://api.github.com/repos/rust-osdev/bootimage", "labels_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/52/labels{/name}", "comments_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/52/comments", "events_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/52/events", "html_url": "https://github.com/rust-osdev/bootimage/pull/52", "id": 601892236, "node_id": "MDExOlB1bGxSZXF1ZXN0NDA1MDY4ODU1", "number": 52, "title": "Add support for doctests", "user": {"login": "Freax13", "id": 14952658, "node_id": "MDQ6VXNlcjE0OTUyNjU4", "avatar_url": "https://avatars.githubusercontent.com/u/14952658?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Freax13", "html_url": "https://github.com/Freax13", "followers_url": "https://api.github.com/users/Freax13/followers", "following_url": "https://api.github.com/users/Freax13/following{/other_user}", "gists_url": "https://api.github.com/users/Freax13/gists{/gist_id}", "starred_url": "https://api.github.com/users/Freax13/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Freax13/subscriptions", "organizations_url": "https://api.github.com/users/Freax13/orgs", "repos_url": "https://api.github.com/users/Freax13/repos", "events_url": "https://api.github.com/users/Freax13/events{/privacy}", "received_events_url": "https://api.github.com/users/Freax13/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-04-17T11:05:31Z", "updated_at": "2020-04-30T09:05:51Z", "closed_at": "2020-04-30T09:02:12Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/rust-osdev/bootimage/pulls/52", "html_url": "https://github.com/rust-osdev/bootimage/pull/52", "diff_url": "https://github.com/rust-osdev/bootimage/pull/52.diff", "patch_url": "https://github.com/rust-osdev/bootimage/pull/52.patch", "merged_at": "2020-04-30T09:02:12Z"}, "body": "- detect doctests as tests", "reactions": {"url": "https://api.github.com/repos/rust-osdev/bootimage/issues/52/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/52/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/rust-osdev/bootimage/issues/51", "repository_url": "https://api.github.com/repos/rust-osdev/bootimage", "labels_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/51/labels{/name}", "comments_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/51/comments", "events_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/51/events", "html_url": "https://github.com/rust-osdev/bootimage/pull/51", "id": 591789420, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzk2ODkwMzI4", "number": 51, "title": "Set empty RUSTFLAGS to ensure that no .cargo/config applies", "user": {"login": "phil-opp", "id": 1131315, "node_id": "MDQ6VXNlcjExMzEzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1131315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/phil-opp", "html_url": "https://github.com/phil-opp", "followers_url": "https://api.github.com/users/phil-opp/followers", "following_url": "https://api.github.com/users/phil-opp/following{/other_user}", "gists_url": "https://api.github.com/users/phil-opp/gists{/gist_id}", "starred_url": "https://api.github.com/users/phil-opp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/phil-opp/subscriptions", "organizations_url": "https://api.github.com/users/phil-opp/orgs", "repos_url": "https://api.github.com/users/phil-opp/repos", "events_url": "https://api.github.com/users/phil-opp/events{/privacy}", "received_events_url": "https://api.github.com/users/phil-opp/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2020-04-01T10:01:03Z", "updated_at": "2020-04-01T12:47:39Z", "closed_at": "2020-04-01T12:43:58Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/rust-osdev/bootimage/pulls/51", "html_url": "https://github.com/rust-osdev/bootimage/pull/51", "diff_url": "https://github.com/rust-osdev/bootimage/pull/51.diff", "patch_url": "https://github.com/rust-osdev/bootimage/pull/51.patch", "merged_at": "2020-04-01T12:43:58Z"}, "body": "Without the `RUSTFLAGS` environment variable set, cargo looks at `.cargo/config` files in all parent directories. Such a file can contain a `build.rustflags` key that would then be applied to the bootloader build too. Since some rustflags can break the build (e.g. `-C target-cpu=native`), we should prevent that.\r\n\r\nCreating a `cargo/.config` file with an empty `build.rustflags` key in the bootloader repository does not suffice for fixing this because cargo unifies arrays with the values defined in parent directories. So the only way to ensure that no rustflags are passed is to set the RUSTFLAGS environment variable to the empty string, exploiting the fact that it takes precedence over any `build.rustflags` key.\r\n\r\nFixes https://github.com/phil-opp/blog_os/issues/770\r\n", "reactions": {"url": "https://api.github.com/repos/rust-osdev/bootimage/issues/51/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rust-osdev/bootimage/issues/51/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]