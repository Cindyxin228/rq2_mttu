{"url": "https://api.github.com/repos/nannou-org/nannou/pulls/452", "id": 375878104, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc1ODc4MTA0", "html_url": "https://github.com/nannou-org/nannou/pull/452", "diff_url": "https://github.com/nannou-org/nannou/pull/452.diff", "patch_url": "https://github.com/nannou-org/nannou/pull/452.patch", "issue_url": "https://api.github.com/repos/nannou-org/nannou/issues/452", "number": 452, "state": "closed", "locked": false, "title": "WIP - Transition graphics backend from vulkano to wgpu", "user": {"login": "mitchmindtree", "id": 4587373, "node_id": "MDQ6VXNlcjQ1ODczNzM=", "avatar_url": "https://avatars.githubusercontent.com/u/4587373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mitchmindtree", "html_url": "https://github.com/mitchmindtree", "followers_url": "https://api.github.com/users/mitchmindtree/followers", "following_url": "https://api.github.com/users/mitchmindtree/following{/other_user}", "gists_url": "https://api.github.com/users/mitchmindtree/gists{/gist_id}", "starred_url": "https://api.github.com/users/mitchmindtree/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mitchmindtree/subscriptions", "organizations_url": "https://api.github.com/users/mitchmindtree/orgs", "repos_url": "https://api.github.com/users/mitchmindtree/repos", "events_url": "https://api.github.com/users/mitchmindtree/events{/privacy}", "received_events_url": "https://api.github.com/users/mitchmindtree/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "body": "This PR is a WIP overhaul of the graphics backend used throughout nannou! :birthday: :tada: :balloon: \r\n\r\nSee #446, #374, #408 for related issues and motivation.\r\n\r\nProgress:\r\n\r\n- [x] Create a `wgpu` branch.\r\n- [x] Update nannou's `winit` dependency to version 0.21.\r\n- [x] Add `wgpu.rs` module. Re-export `wgpu` and extend with helper items as we go.\r\n- [x] Remove `vk` related state from `App`. Comment out loop functions for now.\r\n- [x] Add `draw::backend::wgpu` with placeholder types.\r\n- [x] Update `window.rs` swapchain and surface code to switch from vk to wgpu items.\r\n- [x] Update the `frame.rs` module.\r\n- [x] Remove `vk.rs` module.\r\n- [x] Re-write the `run_loop` for changes to `winit::EventLoop`. *We should no longer use `poll_events`, but instead use `MainEventsCleared` and `RedrawRequested`. This will likely require a full re-write. May be easiest to introduce one `LoopMode` at a time.*\r\n- [x] Update `ui.rs` module to use `conrod_wgpu` rather than `conrod_vulkano`.\r\n- [x] Update `draw.rs` module. #440.\r\n- [x] Check for DPI correctness in event conversion logic in event.rs. Some winit events have changed from emitting logical to physical positions/sizes.\r\n- [x] Reconstruct swap chain and render data on resize.\r\n- [x] Check dpi handling on hidpi display.\r\n- [x] Add a `wgpu::SamplerBuilder`.\r\n- [x] Add a `wgpu::TextureBuilder`.\r\n- [x] Add map of `wgpu::Device`s to `App`. *Allows for use of a single device across multiple windows. This is necessary to support sharing resources between windows.*\r\n- [x] Re-add depth buffer to `Draw` `Renderer` and test with 3D vertices.\r\n- [x] Enable logging (this is how wgpu emits validation layer info). *wgpu uses `log`, so users can add a logger like `env_logger` if they want to receive output for now.*\r\n- [x] Check that window and builder APIs are on par with latest winit.\r\n- [x] Test moving window between different displays with different DPI scale factors.\r\n- Change `vk` examples directory to `wgpu` and update all examples.\r\n    - [x] wgpu_compute_shader\r\n    - [x] wgpu_image\r\n    - [x] wgpu_image_sequence\r\n    - [x] wgpu_teapot\r\n    - [x] wgpu_teapot_camera\r\n    - [x] wgpu_triangle\r\n    - [x] wgpu_triangle_raw_frame\r\n    - [ ] wgpu_images\r\n    - [ ] wgpu_compute_fractal (vk_compute_shader_rendering)\r\n    - [ ] wgpu_hotload (vk_hotload)\r\n    - [ ] wgpu_quad_warp (vk_quad_warp)\r\n    - [ ] wgpu_debug (vk_debug - could probably just show how to enable logging here).\r\n    - [ ] wgpu_shader_include (vk_shader_include)\r\n- [x] Create `screenshot.rs` example.\r\n- [x] Create `screenshot_hi_res.rs` example - drawing to a larger image independent of window size.\r\n- [x] Module level docs for `wgpu` module.\r\n- [x] Search for references to \"vulkan\"/\"vulkano\" throughout codebase.\r\n- [x] Ensure CHANGELOG is up-to-date.\r\n- [x] Test behaviour on all platforms. *Take note of any build dependency changes since removal of shaderc/macos-vk and addition of spirv-cross.*\r\n- [x] Open a PR to update the guide with some info on wgpu. Refer to the [existing wgpu tutorial](https://sotrh.github.io/learn-wgpu/#what-is-wgpu) and describe how the wgpu API is exposed through nannou, what nannou takes care of for you, etc.\r\n- [x] Publish new version of `nannou`.\r\n- ~Improve application loop update timing. Find more info on `get_next_texture()` delays and wgpu swap chain behaviour. Consider semantic differences between `RefreshSync` and `Rate` now that `PresentMode` toggle is exposed in window builder.~ *Will address this in a follow-up PR - see #456.*\r\n- ~Add GL support feature to match wgpu examples. Test GL backend.~ This can wait - should keep track of gfx-rs/wgpu-rs#182.\r\n\r\n---\r\n\r\nCloses #187 \r\nCloses #197 \r\nCloses #261 \r\nCloses #293 \r\nCloses #306 \r\nCloses #307 \r\nCloses #312 \r\nCloses #314 \r\nCloses #319 \r\nCloses #336 \r\nCloses #348 \r\nCloses #350  \r\nCloses #352 \r\nCloses #354 \r\nCloses #356 \r\nCloses #357 \r\nCloses #365 \r\nCloses #372 \r\nCloses #373 \r\nCloses #374 \r\nCloses #392 \r\nCloses #408 \r\nCloses #412 \r\nCloses #422 \r\nCloses #433 \r\nCloses #438 \r\nCloses #440 \r\nCloses #446 \r\n\r\n----\r\n\r\nCurrently nannou compiles! That said, only a handful of the examples are working. The `frame`, `app`, `window`,  `event` and `vk` (now `wgpu`) modules have been updated for `wgpu` and the latest version of `winit`. The `draw` and `ui` modules are yet to be updated, but shouldn't be too tricky considering we have the [`conrod_wgpu` implementation](https://github.com/PistonDevelopers/conrod/pull/1331) as a reference.\r\n\r\ncc @DavidPartouche @freesig \r\n\r\n---\r\n\r\nUpdate: `ui` and `draw` modules now updated!\r\n\r\n![Screenshot from 2020-02-18 07-28-10](https://user-images.githubusercontent.com/4587373/74717159-3176d280-5230-11ea-8015-d0c698b21921.png)\r\n", "created_at": "2020-02-16T21:55:37Z", "updated_at": "2020-03-31T17:01:17Z", "closed_at": "2020-03-03T12:35:08Z", "merged_at": "2020-03-03T12:35:02Z", "merge_commit_sha": "95c8dbd314726e65ddfef0d7a7be091c8b9fbb56", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "draft": false, "commits_url": "https://api.github.com/repos/nannou-org/nannou/pulls/452/commits", "review_comments_url": "https://api.github.com/repos/nannou-org/nannou/pulls/452/comments", "review_comment_url": "https://api.github.com/repos/nannou-org/nannou/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/nannou-org/nannou/issues/452/comments", "statuses_url": "https://api.github.com/repos/nannou-org/nannou/statuses/888928844893d318b4e5940fc9ba2dd6c45f8d1e", "head": {"label": "mitchmindtree:wgpu", "ref": "wgpu", "sha": "888928844893d318b4e5940fc9ba2dd6c45f8d1e", "user": {"login": "mitchmindtree", "id": 4587373, "node_id": "MDQ6VXNlcjQ1ODczNzM=", "avatar_url": "https://avatars.githubusercontent.com/u/4587373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mitchmindtree", "html_url": "https://github.com/mitchmindtree", "followers_url": "https://api.github.com/users/mitchmindtree/followers", "following_url": "https://api.github.com/users/mitchmindtree/following{/other_user}", "gists_url": "https://api.github.com/users/mitchmindtree/gists{/gist_id}", "starred_url": "https://api.github.com/users/mitchmindtree/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mitchmindtree/subscriptions", "organizations_url": "https://api.github.com/users/mitchmindtree/orgs", "repos_url": "https://api.github.com/users/mitchmindtree/repos", "events_url": "https://api.github.com/users/mitchmindtree/events{/privacy}", "received_events_url": "https://api.github.com/users/mitchmindtree/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "repo": {"id": 107120162, "node_id": "MDEwOlJlcG9zaXRvcnkxMDcxMjAxNjI=", "name": "nannou", "full_name": "mitchmindtree/nannou", "private": false, "owner": {"login": "mitchmindtree", "id": 4587373, "node_id": "MDQ6VXNlcjQ1ODczNzM=", "avatar_url": "https://avatars.githubusercontent.com/u/4587373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mitchmindtree", "html_url": "https://github.com/mitchmindtree", "followers_url": "https://api.github.com/users/mitchmindtree/followers", "following_url": "https://api.github.com/users/mitchmindtree/following{/other_user}", "gists_url": "https://api.github.com/users/mitchmindtree/gists{/gist_id}", "starred_url": "https://api.github.com/users/mitchmindtree/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mitchmindtree/subscriptions", "organizations_url": "https://api.github.com/users/mitchmindtree/orgs", "repos_url": "https://api.github.com/users/mitchmindtree/repos", "events_url": "https://api.github.com/users/mitchmindtree/events{/privacy}", "received_events_url": "https://api.github.com/users/mitchmindtree/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/mitchmindtree/nannou", "description": "A Creative Coding Framework for Rust", "fork": true, "url": "https://api.github.com/repos/mitchmindtree/nannou", "forks_url": "https://api.github.com/repos/mitchmindtree/nannou/forks", "keys_url": "https://api.github.com/repos/mitchmindtree/nannou/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/mitchmindtree/nannou/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/mitchmindtree/nannou/teams", "hooks_url": "https://api.github.com/repos/mitchmindtree/nannou/hooks", "issue_events_url": "https://api.github.com/repos/mitchmindtree/nannou/issues/events{/number}", "events_url": "https://api.github.com/repos/mitchmindtree/nannou/events", "assignees_url": "https://api.github.com/repos/mitchmindtree/nannou/assignees{/user}", "branches_url": "https://api.github.com/repos/mitchmindtree/nannou/branches{/branch}", "tags_url": "https://api.github.com/repos/mitchmindtree/nannou/tags", "blobs_url": "https://api.github.com/repos/mitchmindtree/nannou/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/mitchmindtree/nannou/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/mitchmindtree/nannou/git/refs{/sha}", "trees_url": "https://api.github.com/repos/mitchmindtree/nannou/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/mitchmindtree/nannou/statuses/{sha}", "languages_url": "https://api.github.com/repos/mitchmindtree/nannou/languages", "stargazers_url": "https://api.github.com/repos/mitchmindtree/nannou/stargazers", "contributors_url": "https://api.github.com/repos/mitchmindtree/nannou/contributors", "subscribers_url": "https://api.github.com/repos/mitchmindtree/nannou/subscribers", "subscription_url": "https://api.github.com/repos/mitchmindtree/nannou/subscription", "commits_url": "https://api.github.com/repos/mitchmindtree/nannou/commits{/sha}", "git_commits_url": "https://api.github.com/repos/mitchmindtree/nannou/git/commits{/sha}", "comments_url": "https://api.github.com/repos/mitchmindtree/nannou/comments{/number}", "issue_comment_url": "https://api.github.com/repos/mitchmindtree/nannou/issues/comments{/number}", "contents_url": "https://api.github.com/repos/mitchmindtree/nannou/contents/{+path}", "compare_url": "https://api.github.com/repos/mitchmindtree/nannou/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/mitchmindtree/nannou/merges", "archive_url": "https://api.github.com/repos/mitchmindtree/nannou/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/mitchmindtree/nannou/downloads", "issues_url": "https://api.github.com/repos/mitchmindtree/nannou/issues{/number}", "pulls_url": "https://api.github.com/repos/mitchmindtree/nannou/pulls{/number}", "milestones_url": "https://api.github.com/repos/mitchmindtree/nannou/milestones{/number}", "notifications_url": "https://api.github.com/repos/mitchmindtree/nannou/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/mitchmindtree/nannou/labels{/name}", "releases_url": "https://api.github.com/repos/mitchmindtree/nannou/releases{/id}", "deployments_url": "https://api.github.com/repos/mitchmindtree/nannou/deployments", "created_at": "2017-10-16T11:46:57Z", "updated_at": "2023-09-17T11:33:33Z", "pushed_at": "2025-04-02T13:48:25Z", "git_url": "git://github.com/mitchmindtree/nannou.git", "ssh_url": "git@github.com:mitchmindtree/nannou.git", "clone_url": "https://github.com/mitchmindtree/nannou.git", "svn_url": "https://github.com/mitchmindtree/nannou", "homepage": null, "size": 30626, "stargazers_count": 7, "watchers_count": 7, "language": "Rust", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": false, "forks_count": 0, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 0, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 0, "open_issues": 0, "watchers": 7, "default_branch": "master"}}, "base": {"label": "nannou-org:master", "ref": "master", "sha": "f6c3e8f28114d2ea96348e96f94879ec224d94e6", "user": {"login": "nannou-org", "id": 38399209, "node_id": "MDEyOk9yZ2FuaXphdGlvbjM4Mzk5MjA5", "avatar_url": "https://avatars.githubusercontent.com/u/38399209?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nannou-org", "html_url": "https://github.com/nannou-org", "followers_url": "https://api.github.com/users/nannou-org/followers", "following_url": "https://api.github.com/users/nannou-org/following{/other_user}", "gists_url": "https://api.github.com/users/nannou-org/gists{/gist_id}", "starred_url": "https://api.github.com/users/nannou-org/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nannou-org/subscriptions", "organizations_url": "https://api.github.com/users/nannou-org/orgs", "repos_url": "https://api.github.com/users/nannou-org/repos", "events_url": "https://api.github.com/users/nannou-org/events{/privacy}", "received_events_url": "https://api.github.com/users/nannou-org/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "repo": {"id": 102113773, "node_id": "MDEwOlJlcG9zaXRvcnkxMDIxMTM3NzM=", "name": "nannou", "full_name": "nannou-org/nannou", "private": false, "owner": {"login": "nannou-org", "id": 38399209, "node_id": "MDEyOk9yZ2FuaXphdGlvbjM4Mzk5MjA5", "avatar_url": "https://avatars.githubusercontent.com/u/38399209?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nannou-org", "html_url": "https://github.com/nannou-org", "followers_url": "https://api.github.com/users/nannou-org/followers", "following_url": "https://api.github.com/users/nannou-org/following{/other_user}", "gists_url": "https://api.github.com/users/nannou-org/gists{/gist_id}", "starred_url": "https://api.github.com/users/nannou-org/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nannou-org/subscriptions", "organizations_url": "https://api.github.com/users/nannou-org/orgs", "repos_url": "https://api.github.com/users/nannou-org/repos", "events_url": "https://api.github.com/users/nannou-org/events{/privacy}", "received_events_url": "https://api.github.com/users/nannou-org/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/nannou-org/nannou", "description": "A Creative Coding Framework for Rust.", "fork": false, "url": "https://api.github.com/repos/nannou-org/nannou", "forks_url": "https://api.github.com/repos/nannou-org/nannou/forks", "keys_url": "https://api.github.com/repos/nannou-org/nannou/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/nannou-org/nannou/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/nannou-org/nannou/teams", "hooks_url": "https://api.github.com/repos/nannou-org/nannou/hooks", "issue_events_url": "https://api.github.com/repos/nannou-org/nannou/issues/events{/number}", "events_url": "https://api.github.com/repos/nannou-org/nannou/events", "assignees_url": "https://api.github.com/repos/nannou-org/nannou/assignees{/user}", "branches_url": "https://api.github.com/repos/nannou-org/nannou/branches{/branch}", "tags_url": "https://api.github.com/repos/nannou-org/nannou/tags", "blobs_url": "https://api.github.com/repos/nannou-org/nannou/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/nannou-org/nannou/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/nannou-org/nannou/git/refs{/sha}", "trees_url": "https://api.github.com/repos/nannou-org/nannou/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/nannou-org/nannou/statuses/{sha}", "languages_url": "https://api.github.com/repos/nannou-org/nannou/languages", "stargazers_url": "https://api.github.com/repos/nannou-org/nannou/stargazers", "contributors_url": "https://api.github.com/repos/nannou-org/nannou/contributors", "subscribers_url": "https://api.github.com/repos/nannou-org/nannou/subscribers", "subscription_url": "https://api.github.com/repos/nannou-org/nannou/subscription", "commits_url": "https://api.github.com/repos/nannou-org/nannou/commits{/sha}", "git_commits_url": "https://api.github.com/repos/nannou-org/nannou/git/commits{/sha}", "comments_url": "https://api.github.com/repos/nannou-org/nannou/comments{/number}", "issue_comment_url": "https://api.github.com/repos/nannou-org/nannou/issues/comments{/number}", "contents_url": "https://api.github.com/repos/nannou-org/nannou/contents/{+path}", "compare_url": "https://api.github.com/repos/nannou-org/nannou/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/nannou-org/nannou/merges", "archive_url": "https://api.github.com/repos/nannou-org/nannou/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/nannou-org/nannou/downloads", "issues_url": "https://api.github.com/repos/nannou-org/nannou/issues{/number}", "pulls_url": "https://api.github.com/repos/nannou-org/nannou/pulls{/number}", "milestones_url": "https://api.github.com/repos/nannou-org/nannou/milestones{/number}", "notifications_url": "https://api.github.com/repos/nannou-org/nannou/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/nannou-org/nannou/labels{/name}", "releases_url": "https://api.github.com/repos/nannou-org/nannou/releases{/id}", "deployments_url": "https://api.github.com/repos/nannou-org/nannou/deployments", "created_at": "2017-09-01T13:07:25Z", "updated_at": "2026-01-20T13:00:21Z", "pushed_at": "2025-11-13T02:18:40Z", "git_url": "git://github.com/nannou-org/nannou.git", "ssh_url": "git@github.com:nannou-org/nannou.git", "clone_url": "https://github.com/nannou-org/nannou.git", "svn_url": "https://github.com/nannou-org/nannou", "homepage": "https://nannou.cc/", "size": 33433, "stargazers_count": 6475, "watchers_count": 6475, "language": "Rust", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": false, "forks_count": 329, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 281, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": ["creative-coding"], "visibility": "public", "forks": 329, "open_issues": 281, "watchers": 6475, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/nannou-org/nannou/pulls/452"}, "html": {"href": "https://github.com/nannou-org/nannou/pull/452"}, "issue": {"href": "https://api.github.com/repos/nannou-org/nannou/issues/452"}, "comments": {"href": "https://api.github.com/repos/nannou-org/nannou/issues/452/comments"}, "review_comments": {"href": "https://api.github.com/repos/nannou-org/nannou/pulls/452/comments"}, "review_comment": {"href": "https://api.github.com/repos/nannou-org/nannou/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/nannou-org/nannou/pulls/452/commits"}, "statuses": {"href": "https://api.github.com/repos/nannou-org/nannou/statuses/888928844893d318b4e5940fc9ba2dd6c45f8d1e"}}, "author_association": "MEMBER", "auto_merge": null, "active_lock_reason": null, "merged": true, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": {"login": "mitchmindtree", "id": 4587373, "node_id": "MDQ6VXNlcjQ1ODczNzM=", "avatar_url": "https://avatars.githubusercontent.com/u/4587373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mitchmindtree", "html_url": "https://github.com/mitchmindtree", "followers_url": "https://api.github.com/users/mitchmindtree/followers", "following_url": "https://api.github.com/users/mitchmindtree/following{/other_user}", "gists_url": "https://api.github.com/users/mitchmindtree/gists{/gist_id}", "starred_url": "https://api.github.com/users/mitchmindtree/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mitchmindtree/subscriptions", "organizations_url": "https://api.github.com/users/mitchmindtree/orgs", "repos_url": "https://api.github.com/users/mitchmindtree/repos", "events_url": "https://api.github.com/users/mitchmindtree/events{/privacy}", "received_events_url": "https://api.github.com/users/mitchmindtree/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "comments": 2, "review_comments": 0, "maintainer_can_modify": false, "commits": 56, "additions": 7385, "deletions": 12665, "changed_files": 363}