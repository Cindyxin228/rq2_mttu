{"url": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/1734", "id": 764645326, "node_id": "PR_kwDOAk0cF84tk4_O", "html_url": "https://github.com/vulkano-rs/vulkano/pull/1734", "diff_url": "https://github.com/vulkano-rs/vulkano/pull/1734.diff", "patch_url": "https://github.com/vulkano-rs/vulkano/pull/1734.patch", "issue_url": "https://api.github.com/repos/vulkano-rs/vulkano/issues/1734", "number": 1734, "state": "closed", "locked": false, "title": "Fixes related to Image export & OpenGL Interop", "user": {"login": "fayalalebrun", "id": 2482295, "node_id": "MDQ6VXNlcjI0ODIyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2482295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fayalalebrun", "html_url": "https://github.com/fayalalebrun", "followers_url": "https://api.github.com/users/fayalalebrun/followers", "following_url": "https://api.github.com/users/fayalalebrun/following{/other_user}", "gists_url": "https://api.github.com/users/fayalalebrun/gists{/gist_id}", "starred_url": "https://api.github.com/users/fayalalebrun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fayalalebrun/subscriptions", "organizations_url": "https://api.github.com/users/fayalalebrun/orgs", "repos_url": "https://api.github.com/users/fayalalebrun/repos", "events_url": "https://api.github.com/users/fayalalebrun/events{/privacy}", "received_events_url": "https://api.github.com/users/fayalalebrun/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "body": "As a continuation of my previous work, where I added semaphore export  #1606, I've been working on adding the possibility to import Vulkano textures into OpenGL.\r\n\r\nHowever, a few bugs in Vulkano currently prevent this functionality from working correctly:\r\n\r\n- The memory builder was not populating its p_next structures at all, meaning memory was created neither as exportable or dedicated. I fixed this by getting rid of the old method of populating the p_next structures and instead using the Ash functionality.\r\n- The exportable image must also be created with an additional structure [VkExternalImageCreateInfo](https://www.khronos.org/registry/vulkan/specs/1.2-extensions/man/html/VkExternalMemoryImageCreateInfo.html). I added a method to `UnsafeImage` which does this, and I used it accordingly in `AttachmentImage`.\r\n- Issue 17 of OpenGL [EXT_external_objects](https://www.khronos.org/registry/OpenGL/extensions/EXT/EXT_external_objects.txt) demands that the mutable bit be set when some common extensions are present. I thus set it to true by default, but perhaps @hakolao can provide his input on whether this would make sense when sharing images with CUDA.\r\n\r\nThe result of these issues was heavy visual corruption on the AMD radeonsi driver. Interestingly, the Intel Iris driver does not suffer from visual corruptions even with the p_next creation structures missing.\r\n\r\nThe only remaining issue at the moment is a crash happening with the Intel Iris driver, when flushing the signal semaphore command from the OpenGL side. Running a debug version of the driver, it prints out `Failed to submit batchbuffer: Invalid argument`. Given that the driver does not pass the piglit `vk-semaphores-2` test, this is probably a problem within the Iris driver. I will submit a bug report to the Mesa repository.\r\n\r\nI have created some [sample code](https://gist.github.com/fayalalebrun/8845ba4464af687895cf49ba96b105d6). This program draws to a shared texture with Glium from another thread, which is the drawn to the window by Vulkano. This texture oscillates between a black and green color. I'm interested to hear how well it works on Nvidia or with other Intel/AMD drivers.\r\n\r\nChangelog:\r\n- `Fix device memory builder not including p_next structures.`\r\n- `Fix exportable image not created with VkExternalMemoryImageCreateInfo.`\r\n- `Fix mutable bit not set on exportable image.`\r\n[\r\nRelated Glium MR](https://github.com/glium/glium/pull/1965)", "created_at": "2021-10-23T08:54:45Z", "updated_at": "2021-12-19T20:31:38Z", "closed_at": "2021-11-23T12:55:33Z", "merged_at": "2021-11-23T12:55:33Z", "merge_commit_sha": "4d0e709c18d3920d2aa6bffe6385237e404b8a78", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "draft": false, "commits_url": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/1734/commits", "review_comments_url": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/1734/comments", "review_comment_url": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/vulkano-rs/vulkano/issues/1734/comments", "statuses_url": "https://api.github.com/repos/vulkano-rs/vulkano/statuses/2a245c966a0611e38f85bd288dc74ccb69c5f72e", "head": {"label": "fayalalebrun:export_fix", "ref": "export_fix", "sha": "2a245c966a0611e38f85bd288dc74ccb69c5f72e", "user": {"login": "fayalalebrun", "id": 2482295, "node_id": "MDQ6VXNlcjI0ODIyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2482295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fayalalebrun", "html_url": "https://github.com/fayalalebrun", "followers_url": "https://api.github.com/users/fayalalebrun/followers", "following_url": "https://api.github.com/users/fayalalebrun/following{/other_user}", "gists_url": "https://api.github.com/users/fayalalebrun/gists{/gist_id}", "starred_url": "https://api.github.com/users/fayalalebrun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fayalalebrun/subscriptions", "organizations_url": "https://api.github.com/users/fayalalebrun/orgs", "repos_url": "https://api.github.com/users/fayalalebrun/repos", "events_url": "https://api.github.com/users/fayalalebrun/events{/privacy}", "received_events_url": "https://api.github.com/users/fayalalebrun/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "repo": {"id": 374924548, "node_id": "MDEwOlJlcG9zaXRvcnkzNzQ5MjQ1NDg=", "name": "vulkano", "full_name": "fayalalebrun/vulkano", "private": false, "owner": {"login": "fayalalebrun", "id": 2482295, "node_id": "MDQ6VXNlcjI0ODIyOTU=", "avatar_url": "https://avatars.githubusercontent.com/u/2482295?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fayalalebrun", "html_url": "https://github.com/fayalalebrun", "followers_url": "https://api.github.com/users/fayalalebrun/followers", "following_url": "https://api.github.com/users/fayalalebrun/following{/other_user}", "gists_url": "https://api.github.com/users/fayalalebrun/gists{/gist_id}", "starred_url": "https://api.github.com/users/fayalalebrun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fayalalebrun/subscriptions", "organizations_url": "https://api.github.com/users/fayalalebrun/orgs", "repos_url": "https://api.github.com/users/fayalalebrun/repos", "events_url": "https://api.github.com/users/fayalalebrun/events{/privacy}", "received_events_url": "https://api.github.com/users/fayalalebrun/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/fayalalebrun/vulkano", "description": "Safe and rich Rust wrapper around the Vulkan API", "fork": true, "url": "https://api.github.com/repos/fayalalebrun/vulkano", "forks_url": "https://api.github.com/repos/fayalalebrun/vulkano/forks", "keys_url": "https://api.github.com/repos/fayalalebrun/vulkano/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/fayalalebrun/vulkano/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/fayalalebrun/vulkano/teams", "hooks_url": "https://api.github.com/repos/fayalalebrun/vulkano/hooks", "issue_events_url": "https://api.github.com/repos/fayalalebrun/vulkano/issues/events{/number}", "events_url": "https://api.github.com/repos/fayalalebrun/vulkano/events", "assignees_url": "https://api.github.com/repos/fayalalebrun/vulkano/assignees{/user}", "branches_url": "https://api.github.com/repos/fayalalebrun/vulkano/branches{/branch}", "tags_url": "https://api.github.com/repos/fayalalebrun/vulkano/tags", "blobs_url": "https://api.github.com/repos/fayalalebrun/vulkano/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/fayalalebrun/vulkano/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/fayalalebrun/vulkano/git/refs{/sha}", "trees_url": "https://api.github.com/repos/fayalalebrun/vulkano/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/fayalalebrun/vulkano/statuses/{sha}", "languages_url": "https://api.github.com/repos/fayalalebrun/vulkano/languages", "stargazers_url": "https://api.github.com/repos/fayalalebrun/vulkano/stargazers", "contributors_url": "https://api.github.com/repos/fayalalebrun/vulkano/contributors", "subscribers_url": "https://api.github.com/repos/fayalalebrun/vulkano/subscribers", "subscription_url": "https://api.github.com/repos/fayalalebrun/vulkano/subscription", "commits_url": "https://api.github.com/repos/fayalalebrun/vulkano/commits{/sha}", "git_commits_url": "https://api.github.com/repos/fayalalebrun/vulkano/git/commits{/sha}", "comments_url": "https://api.github.com/repos/fayalalebrun/vulkano/comments{/number}", "issue_comment_url": "https://api.github.com/repos/fayalalebrun/vulkano/issues/comments{/number}", "contents_url": "https://api.github.com/repos/fayalalebrun/vulkano/contents/{+path}", "compare_url": "https://api.github.com/repos/fayalalebrun/vulkano/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/fayalalebrun/vulkano/merges", "archive_url": "https://api.github.com/repos/fayalalebrun/vulkano/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/fayalalebrun/vulkano/downloads", "issues_url": "https://api.github.com/repos/fayalalebrun/vulkano/issues{/number}", "pulls_url": "https://api.github.com/repos/fayalalebrun/vulkano/pulls{/number}", "milestones_url": "https://api.github.com/repos/fayalalebrun/vulkano/milestones{/number}", "notifications_url": "https://api.github.com/repos/fayalalebrun/vulkano/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/fayalalebrun/vulkano/labels{/name}", "releases_url": "https://api.github.com/repos/fayalalebrun/vulkano/releases{/id}", "deployments_url": "https://api.github.com/repos/fayalalebrun/vulkano/deployments", "created_at": "2021-06-08T07:41:41Z", "updated_at": "2021-12-30T13:21:05Z", "pushed_at": "2023-03-10T19:30:25Z", "git_url": "git://github.com/fayalalebrun/vulkano.git", "ssh_url": "git@github.com:fayalalebrun/vulkano.git", "clone_url": "https://github.com/fayalalebrun/vulkano.git", "svn_url": "https://github.com/fayalalebrun/vulkano", "homepage": "", "size": 26491, "stargazers_count": 0, "watchers_count": 0, "language": "Rust", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 0, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 0, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "vulkano-rs:master", "ref": "master", "sha": "6ff023e5af2c06abdd80edfce3aeb76ac40e21c0", "user": {"login": "vulkano-rs", "id": 30721485, "node_id": "MDEyOk9yZ2FuaXphdGlvbjMwNzIxNDg1", "avatar_url": "https://avatars.githubusercontent.com/u/30721485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vulkano-rs", "html_url": "https://github.com/vulkano-rs", "followers_url": "https://api.github.com/users/vulkano-rs/followers", "following_url": "https://api.github.com/users/vulkano-rs/following{/other_user}", "gists_url": "https://api.github.com/users/vulkano-rs/gists{/gist_id}", "starred_url": "https://api.github.com/users/vulkano-rs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vulkano-rs/subscriptions", "organizations_url": "https://api.github.com/users/vulkano-rs/orgs", "repos_url": "https://api.github.com/users/vulkano-rs/repos", "events_url": "https://api.github.com/users/vulkano-rs/events{/privacy}", "received_events_url": "https://api.github.com/users/vulkano-rs/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "repo": {"id": 38607895, "node_id": "MDEwOlJlcG9zaXRvcnkzODYwNzg5NQ==", "name": "vulkano", "full_name": "vulkano-rs/vulkano", "private": false, "owner": {"login": "vulkano-rs", "id": 30721485, "node_id": "MDEyOk9yZ2FuaXphdGlvbjMwNzIxNDg1", "avatar_url": "https://avatars.githubusercontent.com/u/30721485?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vulkano-rs", "html_url": "https://github.com/vulkano-rs", "followers_url": "https://api.github.com/users/vulkano-rs/followers", "following_url": "https://api.github.com/users/vulkano-rs/following{/other_user}", "gists_url": "https://api.github.com/users/vulkano-rs/gists{/gist_id}", "starred_url": "https://api.github.com/users/vulkano-rs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vulkano-rs/subscriptions", "organizations_url": "https://api.github.com/users/vulkano-rs/orgs", "repos_url": "https://api.github.com/users/vulkano-rs/repos", "events_url": "https://api.github.com/users/vulkano-rs/events{/privacy}", "received_events_url": "https://api.github.com/users/vulkano-rs/received_events", "type": "Organization", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/vulkano-rs/vulkano", "description": "Safe and rich Rust wrapper around the Vulkan API", "fork": false, "url": "https://api.github.com/repos/vulkano-rs/vulkano", "forks_url": "https://api.github.com/repos/vulkano-rs/vulkano/forks", "keys_url": "https://api.github.com/repos/vulkano-rs/vulkano/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/vulkano-rs/vulkano/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/vulkano-rs/vulkano/teams", "hooks_url": "https://api.github.com/repos/vulkano-rs/vulkano/hooks", "issue_events_url": "https://api.github.com/repos/vulkano-rs/vulkano/issues/events{/number}", "events_url": "https://api.github.com/repos/vulkano-rs/vulkano/events", "assignees_url": "https://api.github.com/repos/vulkano-rs/vulkano/assignees{/user}", "branches_url": "https://api.github.com/repos/vulkano-rs/vulkano/branches{/branch}", "tags_url": "https://api.github.com/repos/vulkano-rs/vulkano/tags", "blobs_url": "https://api.github.com/repos/vulkano-rs/vulkano/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/vulkano-rs/vulkano/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/vulkano-rs/vulkano/git/refs{/sha}", "trees_url": "https://api.github.com/repos/vulkano-rs/vulkano/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/vulkano-rs/vulkano/statuses/{sha}", "languages_url": "https://api.github.com/repos/vulkano-rs/vulkano/languages", "stargazers_url": "https://api.github.com/repos/vulkano-rs/vulkano/stargazers", "contributors_url": "https://api.github.com/repos/vulkano-rs/vulkano/contributors", "subscribers_url": "https://api.github.com/repos/vulkano-rs/vulkano/subscribers", "subscription_url": "https://api.github.com/repos/vulkano-rs/vulkano/subscription", "commits_url": "https://api.github.com/repos/vulkano-rs/vulkano/commits{/sha}", "git_commits_url": "https://api.github.com/repos/vulkano-rs/vulkano/git/commits{/sha}", "comments_url": "https://api.github.com/repos/vulkano-rs/vulkano/comments{/number}", "issue_comment_url": "https://api.github.com/repos/vulkano-rs/vulkano/issues/comments{/number}", "contents_url": "https://api.github.com/repos/vulkano-rs/vulkano/contents/{+path}", "compare_url": "https://api.github.com/repos/vulkano-rs/vulkano/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/vulkano-rs/vulkano/merges", "archive_url": "https://api.github.com/repos/vulkano-rs/vulkano/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/vulkano-rs/vulkano/downloads", "issues_url": "https://api.github.com/repos/vulkano-rs/vulkano/issues{/number}", "pulls_url": "https://api.github.com/repos/vulkano-rs/vulkano/pulls{/number}", "milestones_url": "https://api.github.com/repos/vulkano-rs/vulkano/milestones{/number}", "notifications_url": "https://api.github.com/repos/vulkano-rs/vulkano/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/vulkano-rs/vulkano/labels{/name}", "releases_url": "https://api.github.com/repos/vulkano-rs/vulkano/releases{/id}", "deployments_url": "https://api.github.com/repos/vulkano-rs/vulkano/deployments", "created_at": "2015-07-06T08:54:43Z", "updated_at": "2026-01-21T14:46:39Z", "pushed_at": "2026-01-14T22:04:58Z", "git_url": "git://github.com/vulkano-rs/vulkano.git", "ssh_url": "git@github.com:vulkano-rs/vulkano.git", "clone_url": "https://github.com/vulkano-rs/vulkano.git", "svn_url": "https://github.com/vulkano-rs/vulkano", "homepage": "", "size": 34058, "stargazers_count": 4990, "watchers_count": 4990, "language": "Rust", "has_issues": true, "has_projects": false, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 464, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 89, "license": {"key": "apache-2.0", "name": "Apache License 2.0", "spdx_id": "Apache-2.0", "url": "https://api.github.com/licenses/apache-2.0", "node_id": "MDc6TGljZW5zZTI="}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": ["graphics-programming", "rust", "spir-v", "vulkan", "vulkan-api"], "visibility": "public", "forks": 464, "open_issues": 89, "watchers": 4990, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/1734"}, "html": {"href": "https://github.com/vulkano-rs/vulkano/pull/1734"}, "issue": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/issues/1734"}, "comments": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/issues/1734/comments"}, "review_comments": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/1734/comments"}, "review_comment": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/pulls/1734/commits"}, "statuses": {"href": "https://api.github.com/repos/vulkano-rs/vulkano/statuses/2a245c966a0611e38f85bd288dc74ccb69c5f72e"}}, "author_association": "CONTRIBUTOR", "auto_merge": null, "active_lock_reason": null, "merged": true, "mergeable": null, "rebaseable": null, "mergeable_state": "unknown", "merged_by": {"login": "Eliah-Lakhin", "id": 223986, "node_id": "MDQ6VXNlcjIyMzk4Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/223986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Eliah-Lakhin", "html_url": "https://github.com/Eliah-Lakhin", "followers_url": "https://api.github.com/users/Eliah-Lakhin/followers", "following_url": "https://api.github.com/users/Eliah-Lakhin/following{/other_user}", "gists_url": "https://api.github.com/users/Eliah-Lakhin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Eliah-Lakhin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Eliah-Lakhin/subscriptions", "organizations_url": "https://api.github.com/users/Eliah-Lakhin/orgs", "repos_url": "https://api.github.com/users/Eliah-Lakhin/repos", "events_url": "https://api.github.com/users/Eliah-Lakhin/events{/privacy}", "received_events_url": "https://api.github.com/users/Eliah-Lakhin/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "comments": 9, "review_comments": 6, "maintainer_can_modify": false, "commits": 8, "additions": 686, "deletions": 57, "changed_files": 6}