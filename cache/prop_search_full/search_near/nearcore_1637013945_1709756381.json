[{"url": "https://api.github.com/repos/near/nearcore/issues/10716", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10716/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10716/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10716/events", "html_url": "https://github.com/near/nearcore/pull/10716", "id": 2172235264, "node_id": "PR_kwDOCQUkYs5o4PmL", "number": 10716, "title": "[fix] Fix Lychee lint test (again)", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-03-06T19:15:04Z", "updated_at": "2024-03-06T20:13:22Z", "closed_at": "2024-03-06T20:13:21Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10716", "html_url": "https://github.com/near/nearcore/pull/10716", "diff_url": "https://github.com/near/nearcore/pull/10716.diff", "patch_url": "https://github.com/near/nearcore/pull/10716.patch", "merged_at": "2024-03-06T20:13:21Z"}, "body": "-_-", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10716/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10716/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10714", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10714/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10714/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10714/events", "html_url": "https://github.com/near/nearcore/pull/10714", "id": 2171563525, "node_id": "PR_kwDOCQUkYs5o17s2", "number": 10714, "title": "bump protocol version for 1.38.0", "user": {"login": "VanBarbascu", "id": 8384611, "node_id": "MDQ6VXNlcjgzODQ2MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/8384611?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VanBarbascu", "html_url": "https://github.com/VanBarbascu", "followers_url": "https://api.github.com/users/VanBarbascu/followers", "following_url": "https://api.github.com/users/VanBarbascu/following{/other_user}", "gists_url": "https://api.github.com/users/VanBarbascu/gists{/gist_id}", "starred_url": "https://api.github.com/users/VanBarbascu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VanBarbascu/subscriptions", "organizations_url": "https://api.github.com/users/VanBarbascu/orgs", "repos_url": "https://api.github.com/users/VanBarbascu/repos", "events_url": "https://api.github.com/users/VanBarbascu/events{/privacy}", "received_events_url": "https://api.github.com/users/VanBarbascu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-06T13:50:17Z", "updated_at": "2024-03-06T15:46:02Z", "closed_at": "2024-03-06T15:46:00Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10714", "html_url": "https://github.com/near/nearcore/pull/10714", "diff_url": "https://github.com/near/nearcore/pull/10714.diff", "patch_url": "https://github.com/near/nearcore/pull/10714.patch", "merged_at": "2024-03-06T15:46:00Z"}, "body": "Bump protocol version to 35", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10714/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10714/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10712", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10712/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10712/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10712/events", "html_url": "https://github.com/near/nearcore/pull/10712", "id": 2171320921, "node_id": "PR_kwDOCQUkYs5o1Gam", "number": 10712, "title": "Cut 1.37.0 CHANGELOG", "user": {"login": "posvyatokum", "id": 10712048, "node_id": "MDQ6VXNlcjEwNzEyMDQ4", "avatar_url": "https://avatars.githubusercontent.com/u/10712048?v=4", "gravatar_id": "", "url": "https://api.github.com/users/posvyatokum", "html_url": "https://github.com/posvyatokum", "followers_url": "https://api.github.com/users/posvyatokum/followers", "following_url": "https://api.github.com/users/posvyatokum/following{/other_user}", "gists_url": "https://api.github.com/users/posvyatokum/gists{/gist_id}", "starred_url": "https://api.github.com/users/posvyatokum/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/posvyatokum/subscriptions", "organizations_url": "https://api.github.com/users/posvyatokum/orgs", "repos_url": "https://api.github.com/users/posvyatokum/repos", "events_url": "https://api.github.com/users/posvyatokum/events{/privacy}", "received_events_url": "https://api.github.com/users/posvyatokum/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-06T11:48:55Z", "updated_at": "2024-03-06T12:30:22Z", "closed_at": "2024-03-06T12:30:21Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10712", "html_url": "https://github.com/near/nearcore/pull/10712", "diff_url": "https://github.com/near/nearcore/pull/10712.diff", "patch_url": "https://github.com/near/nearcore/pull/10712.patch", "merged_at": "2024-03-06T12:30:21Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10712/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10712/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10709", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10709/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10709/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10709/events", "html_url": "https://github.com/near/nearcore/pull/10709", "id": 2170601868, "node_id": "PR_kwDOCQUkYs5oypSL", "number": 10709, "title": "fix some comments", "user": {"login": "teslaedison", "id": 156734008, "node_id": "U_kgDOCVeSOA", "avatar_url": "https://avatars.githubusercontent.com/u/156734008?v=4", "gravatar_id": "", "url": "https://api.github.com/users/teslaedison", "html_url": "https://github.com/teslaedison", "followers_url": "https://api.github.com/users/teslaedison/followers", "following_url": "https://api.github.com/users/teslaedison/following{/other_user}", "gists_url": "https://api.github.com/users/teslaedison/gists{/gist_id}", "starred_url": "https://api.github.com/users/teslaedison/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/teslaedison/subscriptions", "organizations_url": "https://api.github.com/users/teslaedison/orgs", "repos_url": "https://api.github.com/users/teslaedison/repos", "events_url": "https://api.github.com/users/teslaedison/events{/privacy}", "received_events_url": "https://api.github.com/users/teslaedison/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-03-06T04:15:07Z", "updated_at": "2024-03-06T09:15:46Z", "closed_at": "2024-03-06T09:15:46Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10709", "html_url": "https://github.com/near/nearcore/pull/10709", "diff_url": "https://github.com/near/nearcore/pull/10709.diff", "patch_url": "https://github.com/near/nearcore/pull/10709.patch", "merged_at": "2024-03-06T09:15:46Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10709/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10709/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10708", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10708/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10708/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10708/events", "html_url": "https://github.com/near/nearcore/pull/10708", "id": 2170516772, "node_id": "PR_kwDOCQUkYs5oyWyW", "number": 10708, "title": "Fix compilation error due to missing time crate feature.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-03-06T02:46:16Z", "updated_at": "2024-03-06T08:43:19Z", "closed_at": "2024-03-06T08:43:19Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10708", "html_url": "https://github.com/near/nearcore/pull/10708", "diff_url": "https://github.com/near/nearcore/pull/10708.diff", "patch_url": "https://github.com/near/nearcore/pull/10708.patch", "merged_at": "2024-03-06T08:43:19Z"}, "body": "https://near.zulipchat.com/#narrow/stream/300659-Rust-.F0.9F.A6.80/topic/Unable.20to.20compile.20.60core.2Fchain-configs.2Fsrc.2Fclient_config.2Ers.60/near/424938946", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10708/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10708/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10702", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10702/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10702/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10702/events", "html_url": "https://github.com/near/nearcore/pull/10702", "id": 2169609804, "node_id": "PR_kwDOCQUkYs5ovPkm", "number": 10702, "title": "yield/resume: rework receipt manager", "user": {"login": "saketh-are", "id": 3241341, "node_id": "MDQ6VXNlcjMyNDEzNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3241341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saketh-are", "html_url": "https://github.com/saketh-are", "followers_url": "https://api.github.com/users/saketh-are/followers", "following_url": "https://api.github.com/users/saketh-are/following{/other_user}", "gists_url": "https://api.github.com/users/saketh-are/gists{/gist_id}", "starred_url": "https://api.github.com/users/saketh-are/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saketh-are/subscriptions", "organizations_url": "https://api.github.com/users/saketh-are/orgs", "repos_url": "https://api.github.com/users/saketh-are/repos", "events_url": "https://api.github.com/users/saketh-are/events{/privacy}", "received_events_url": "https://api.github.com/users/saketh-are/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-05T16:06:30Z", "updated_at": "2024-03-05T23:30:42Z", "closed_at": "2024-03-05T23:30:41Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10702", "html_url": "https://github.com/near/nearcore/pull/10702", "diff_url": "https://github.com/near/nearcore/pull/10702.diff", "patch_url": "https://github.com/near/nearcore/pull/10702.patch", "merged_at": "2024-03-05T23:30:41Z"}, "body": "By commit:\r\n1. Renames receipt creation functions of the ReceiptManager and in downstream files for clarity.\r\n2. Refactors action receipt representation in ReceiptManager from `(AccountId, ReceiptMetadata)` by moving the receiver account id inside the metadata struct.\r\n3. Similarly refactors data receipt representation from tuple `(CryptoHash, Vec<u8>)` into a struct.\r\n4. Changes behavior in the case that a promise yield is resumed within the same transaction in which it is created. This case is now handled by converting the `PromiseYield` to a standard `Action` receipt and delivering the resume payload as a standard `Data` receipt. \r\n\r\n(4) is important because unlike `PromiseYield` and `PromiseResume` receipts, standard `Action` and `Data` receipts are robust to delivery order (see [process_receipt](https://github.com/near/nearcore/blob/00d51bde97378995d2adc058fa30fe299e18dc38/runtime/runtime/src/lib.rs#L898-L1094)). By making this change, we lift an implicit requirement that the local receipts created as a result of a single transaction would be applied in the order in which they were created.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10702/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10702/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10700", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10700/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10700/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10700/events", "html_url": "https://github.com/near/nearcore/pull/10700", "id": 2168947830, "node_id": "PR_kwDOCQUkYs5os9PO", "number": 10700, "title": "fix(resharding): fixed the resharding_rpc_tx nayduck test", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-05T11:21:11Z", "updated_at": "2024-03-05T11:59:43Z", "closed_at": "2024-03-05T11:59:42Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10700", "html_url": "https://github.com/near/nearcore/pull/10700", "diff_url": "https://github.com/near/nearcore/pull/10700.diff", "patch_url": "https://github.com/near/nearcore/pull/10700.patch", "merged_at": "2024-03-05T11:59:42Z"}, "body": "Something's changed and now when submitting the transaction the result has status \"EXECUTED\" and when getting the status later via RPC the result has status \"FINAL\". Previously the test was asserting equality of those, now adjusted to accomodate the different statuses. \r\n\r\nFirst commit is just a minor refactor and the second one is the actual fix. Best reviewed separately. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10700/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10700/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10699", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10699/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10699/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10699/events", "html_url": "https://github.com/near/nearcore/pull/10699", "id": 2167834246, "node_id": "PR_kwDOCQUkYs5opLS6", "number": 10699, "title": "build(deps): bump mio from 0.8.6 to 0.8.11", "user": {"login": "dependabot[bot]", "id": 49699333, "node_id": "MDM6Qm90NDk2OTkzMzM=", "avatar_url": "https://avatars.githubusercontent.com/in/29110?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dependabot%5Bbot%5D", "html_url": "https://github.com/apps/dependabot", "followers_url": "https://api.github.com/users/dependabot%5Bbot%5D/followers", "following_url": "https://api.github.com/users/dependabot%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/dependabot%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/dependabot%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dependabot%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/dependabot%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/dependabot%5Bbot%5D/repos", "events_url": "https://api.github.com/users/dependabot%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/dependabot%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 2460145996, "node_id": "MDU6TGFiZWwyNDYwMTQ1OTk2", "url": "https://api.github.com/repos/near/nearcore/labels/C-dependencies", "name": "C-dependencies", "color": "9745C6", "default": false, "description": "Category: Pull requests that update a dependency file"}, {"id": 4889058171, "node_id": "LA_kwDOCQUkYs8AAAABI2kbew", "url": "https://api.github.com/repos/near/nearcore/labels/rust", "name": "rust", "color": "000000", "default": false, "description": "Pull requests that update Rust code"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-03-04T21:49:37Z", "updated_at": "2024-03-04T23:37:12Z", "closed_at": "2024-03-04T23:37:11Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10699", "html_url": "https://github.com/near/nearcore/pull/10699", "diff_url": "https://github.com/near/nearcore/pull/10699.diff", "patch_url": "https://github.com/near/nearcore/pull/10699.patch", "merged_at": "2024-03-04T23:37:11Z"}, "body": "Bumps [mio](https://github.com/tokio-rs/mio) from 0.8.6 to 0.8.11.\n<details>\n<summary>Changelog</summary>\n<p><em>Sourced from <a href=\"https://github.com/tokio-rs/mio/blob/master/CHANGELOG.md\">mio's changelog</a>.</em></p>\n<blockquote>\n<h1>0.8.11</h1>\n<ul>\n<li>Fix receiving IOCP events after deregistering a Windows named pipe\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1760\">tokio-rs/mio#1760</a>, backport pr:\n<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1761\">tokio-rs/mio#1761</a>).</li>\n</ul>\n<h1>0.8.10</h1>\n<h2>Added</h2>\n<ul>\n<li>Solaris support\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1724\">tokio-rs/mio#1724</a>).</li>\n</ul>\n<h1>0.8.9</h1>\n<h2>Added</h2>\n<ul>\n<li>ESP-IDF framework support\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1692\">tokio-rs/mio#1692</a>).</li>\n<li>AIX operating system support\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1704\">tokio-rs/mio#1704</a>).</li>\n<li>Vita support\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1721\">tokio-rs/mio#1721</a>).</li>\n<li><code>{UnixListener,UnixStream}:bind_addr</code>\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1630\">tokio-rs/mio#1630</a>).</li>\n<li><code>mio_unsupported_force_poll_poll</code> and <code>mio_unsupported_force_waker_pipe</code>\n<strong>unsupported</strong> configuration flags to force a specific poll or waker\nimplementation\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1684\">tokio-rs/mio#1684</a>,\n<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1685\">tokio-rs/mio#1685</a>,\n<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1692\">tokio-rs/mio#1692</a>).</li>\n</ul>\n<h2>Fixed</h2>\n<ul>\n<li>The <code>pipe(2)</code> based waker (swapped file descriptors)\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1722\">tokio-rs/mio#1722</a>).</li>\n<li>The duplicate waker check to work correctly with cloned <code>Registry</code>s.\n(<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1706\">tokio-rs/mio#1706</a>).</li>\n</ul>\n<h1>0.8.8</h1>\n<h2>Fixed</h2>\n<ul>\n<li>Fix compilation on WASI (<a href=\"https://redirect.github.com/tokio-rs/mio/pull/1676\">tokio-rs/mio#1676</a>).</li>\n</ul>\n<h1>0.8.7</h1>\n<h2>Added</h2>\n<ul>\n<li>Add/fix support for tvOS and watchOS, Mio should now build for tvOS and</li>\n</ul>\n<!-- raw HTML omitted -->\n</blockquote>\n<p>... (truncated)</p>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/0328bdef900b6396b8d00d33c825cd8af748553d\"><code>0328bde</code></a> Release v0.8.11</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/708449851283b57eb6f514c8f289b66e982720b3\"><code>7084498</code></a> Fix warnings</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/90d4fe00df870acd3d38f3dc4face9aacab8fbb9\"><code>90d4fe0</code></a> named-pipes: fix receiving IOCP events after deregister</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/c710a307f8627c4d63ac1003252aa45175e08399\"><code>c710a30</code></a> Add v0.8.x to the CI</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/c29e21c244b2b835e8b3e015b92c708c33c7d70a\"><code>c29e21c</code></a> Release v0.8.10</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/f6a20da1c81c2d56a78bc6f6832b9904b9215914\"><code>f6a20da</code></a> Add Solaris operating system support (<a href=\"https://redirect.github.com/tokio-rs/mio/issues/1724\">#1724</a>)</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/e80c3b21b59b92238f4c8c331fcfc4a71508d1c5\"><code>e80c3b2</code></a> Release v0.8.9</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/862786bbbf719886be55631c0d150d4813a9a1b6\"><code>862786b</code></a> Fix importing of IoSourceState</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/40348728e4f06f5e150783d8f1559ee974e5e834\"><code>4034872</code></a> Add support for vita target</li>\n<li><a href=\"https://github.com/tokio-rs/mio/commit/8eb4010a92bede550850e177d3dd7c4c76eb90ba\"><code>8eb4010</code></a> Fix receiver and sender fd in pipe based waker</li>\n<li>Additional commits viewable in <a href=\"https://github.com/tokio-rs/mio/compare/v0.8.6...v0.8.11\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=mio&package-manager=cargo&previous-version=0.8.6&new-version=0.8.11)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\nYou can disable automated security fix PRs for this repo from the [Security Alerts page](https://github.com/near/nearcore/network/alerts).\n\n</details>", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10699/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10699/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10698", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10698/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10698/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10698/events", "html_url": "https://github.com/near/nearcore/pull/10698", "id": 2167780489, "node_id": "PR_kwDOCQUkYs5oo_Rc", "number": 10698, "title": "refactor: erase ReceiptEnum::is_action and ::action", "user": {"login": "saketh-are", "id": 3241341, "node_id": "MDQ6VXNlcjMyNDEzNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3241341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saketh-are", "html_url": "https://github.com/saketh-are", "followers_url": "https://api.github.com/users/saketh-are/followers", "following_url": "https://api.github.com/users/saketh-are/following{/other_user}", "gists_url": "https://api.github.com/users/saketh-are/gists{/gist_id}", "starred_url": "https://api.github.com/users/saketh-are/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saketh-are/subscriptions", "organizations_url": "https://api.github.com/users/saketh-are/orgs", "repos_url": "https://api.github.com/users/saketh-are/repos", "events_url": "https://api.github.com/users/saketh-are/events{/privacy}", "received_events_url": "https://api.github.com/users/saketh-are/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-04T21:20:11Z", "updated_at": "2024-03-05T03:33:16Z", "closed_at": "2024-03-05T03:33:15Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10698", "html_url": "https://github.com/near/nearcore/pull/10698", "diff_url": "https://github.com/near/nearcore/pull/10698.diff", "patch_url": "https://github.com/near/nearcore/pull/10698.patch", "merged_at": "2024-03-05T03:33:15Z"}, "body": "In #10676 we introduced ReceiptEnum variants `PromiseYield` and `PromiseResume`.\r\n\r\nAt the time `Action` and `PromiseYield` receipts were treated identically through the protocol, so it was reasonable to have unified helpers `is_action` and `action`.\r\n\r\nAfter #10689 there are fundamental  and subtle differences between `Action` receipts and`PromiseYield` receipts (for example how they are handled in [apply_receipt](https://github.com/near/nearcore/blob/6a68a2b18a8e17c9f1946d5ccd49742e7e14b587/runtime/runtime/src/lib.rs#L1039)). It seems safer now to explicitly specify behavior everywhere.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10698/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10698/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10696", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10696/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10696/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10696/events", "html_url": "https://github.com/near/nearcore/pull/10696", "id": 2166582721, "node_id": "PR_kwDOCQUkYs5ok3FR", "number": 10696, "title": "fix(resharding): Allow creating the flat storage multiple times for a shard. ", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-03-04T11:11:23Z", "updated_at": "2024-03-04T16:20:40Z", "closed_at": "2024-03-04T12:05:59Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10696", "html_url": "https://github.com/near/nearcore/pull/10696", "diff_url": "https://github.com/near/nearcore/pull/10696.diff", "patch_url": "https://github.com/near/nearcore/pull/10696.patch", "merged_at": "2024-03-04T12:05:59Z"}, "body": "Removing the assertion and allowing flat storage to be created multiple times for a shard. This is needed so fix an issue when node is restarted in the middle of resharding. The flat storage may be created already for a subset of shards but unless all are finished resharding will get restarted. Becuase the flat storage was created, for those shards, it will be created on node startup as well as after the second resharding is finished. \r\n\r\nThis is not a perfect solution and not particularly clean. The best alternative seems to be to implement resuming of resharding where we don't restart resharding for shards that were finished. This is more a comlex change and we want to get this PR in to the release so for now I'm sticking to the simplest approach. \r\n\r\nThis seems to be safe because even though the flat storage for children shards is created it's not used anywhere. \r\n\r\nSanity check - do we ever check the existance of flat storage for a shard for anything? ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10696/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10696/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10695", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10695/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10695/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10695/events", "html_url": "https://github.com/near/nearcore/pull/10695", "id": 2166075279, "node_id": "PR_kwDOCQUkYs5ojHPH", "number": 10695, "title": "congestion: create congestion modelling framework", "user": {"login": "jakmeier", "id": 6342444, "node_id": "MDQ6VXNlcjYzNDI0NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/6342444?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakmeier", "html_url": "https://github.com/jakmeier", "followers_url": "https://api.github.com/users/jakmeier/followers", "following_url": "https://api.github.com/users/jakmeier/following{/other_user}", "gists_url": "https://api.github.com/users/jakmeier/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakmeier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakmeier/subscriptions", "organizations_url": "https://api.github.com/users/jakmeier/orgs", "repos_url": "https://api.github.com/users/jakmeier/repos", "events_url": "https://api.github.com/users/jakmeier/events{/privacy}", "received_events_url": "https://api.github.com/users/jakmeier/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2024-03-04T06:54:03Z", "updated_at": "2024-03-05T17:45:49Z", "closed_at": "2024-03-05T17:19:08Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10695", "html_url": "https://github.com/near/nearcore/pull/10695", "diff_url": "https://github.com/near/nearcore/pull/10695.diff", "patch_url": "https://github.com/near/nearcore/pull/10695.patch", "merged_at": "2024-03-05T17:19:08Z"}, "body": "This tool let's us model different workloads and congestion control strategies. See the added READEME.md for how it works.\r\n\r\nThis is part of the first milestone in [near-one-project-tracking/issues/48](https://github.com/near/near-one-project-tracking/issues/48)", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10695/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10695/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10694", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10694/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10694/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10694/events", "html_url": "https://github.com/near/nearcore/pull/10694", "id": 2165586838, "node_id": "PR_kwDOCQUkYs5ohdL-", "number": 10694, "title": "refactor: use NightshadeRuntime for chain garabage collection tests ", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-03T21:56:24Z", "updated_at": "2024-03-04T23:18:19Z", "closed_at": "2024-03-04T18:50:46Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10694", "html_url": "https://github.com/near/nearcore/pull/10694", "diff_url": "https://github.com/near/nearcore/pull/10694.diff", "patch_url": "https://github.com/near/nearcore/pull/10694.patch", "merged_at": "2024-03-04T18:50:46Z"}, "body": "Part of https://github.com/near/nearcore/issues/10678 and https://github.com/near/nearcore/issues/10634.\r\n\r\nTests are updated to reflect the actual behaviour of chain garbage collection.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10694/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10694/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10693", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10693/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10693/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10693/events", "html_url": "https://github.com/near/nearcore/pull/10693", "id": 2163776014, "node_id": "PR_kwDOCQUkYs5obfGZ", "number": 10693, "title": "feat(resharding): Added checks for flat storage in the resharding restart test", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-03-01T16:41:58Z", "updated_at": "2024-03-04T11:46:01Z", "closed_at": "2024-03-04T11:46:00Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10693", "html_url": "https://github.com/near/nearcore/pull/10693", "diff_url": "https://github.com/near/nearcore/pull/10693.diff", "patch_url": "https://github.com/near/nearcore/pull/10693.patch", "merged_at": "2024-03-04T11:46:00Z"}, "body": "Checking that flat storage exists for the right shards at right times before and after the restart. \r\n\r\nAgain, I couldn't actually trigger the error condition from mocknet but this is better than nothing. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10693/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10693/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10692", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10692/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10692/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10692/events", "html_url": "https://github.com/near/nearcore/pull/10692", "id": 2163653640, "node_id": "PR_kwDOCQUkYs5obELp", "number": 10692, "title": "Enhancements for Read RPC: Compatibility with near-indexer and Handling Optimistic Blocks", "user": {"login": "kobayurii", "id": 20987138, "node_id": "MDQ6VXNlcjIwOTg3MTM4", "avatar_url": "https://avatars.githubusercontent.com/u/20987138?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kobayurii", "html_url": "https://github.com/kobayurii", "followers_url": "https://api.github.com/users/kobayurii/followers", "following_url": "https://api.github.com/users/kobayurii/following{/other_user}", "gists_url": "https://api.github.com/users/kobayurii/gists{/gist_id}", "starred_url": "https://api.github.com/users/kobayurii/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kobayurii/subscriptions", "organizations_url": "https://api.github.com/users/kobayurii/orgs", "repos_url": "https://api.github.com/users/kobayurii/repos", "events_url": "https://api.github.com/users/kobayurii/events{/privacy}", "received_events_url": "https://api.github.com/users/kobayurii/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2024-03-01T15:35:35Z", "updated_at": "2024-03-01T17:21:20Z", "closed_at": "2024-03-01T17:21:20Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10692", "html_url": "https://github.com/near/nearcore/pull/10692", "diff_url": "https://github.com/near/nearcore/pull/10692.diff", "patch_url": "https://github.com/near/nearcore/pull/10692.patch", "merged_at": "2024-03-01T17:21:20Z"}, "body": "Hello everyone!\r\n\r\nThis pull request addresses two urgent tasks related to our project's [Read RPC](https://github.com/near/read-rpc) functionality.\r\n\r\n[Issue 1](https://github.com/near/read-rpc/issues/188): \r\nMaking our state-indexer compatible with the near-indexer to eliminate the 3-second delay caused by [Lake-framework](https://github.com/near/near-lake-framework-rs). This compatibility enhancement ensures smoother and more efficient operation of our system by removing unnecessary delays.\r\n\r\n[Issue 2](https://github.com/near/read-rpc/issues/186): \r\nEnhancing our service to handle requests for optimistic blocks directly, without proxying to nodes. This optimization streamlines the process, improving response times and overall system performance.\r\n\r\nTo achieve these tasks, modifications have been made to the near-indexer. Specifically, the `build_streamer_message` method has been made public to facilitate the creation of `StreamerMessage` for optimistic blocks.\r\n\r\nThis pull request aims to enhance the reliability, efficiency, and performance of our Read RPC functionality, addressing critical needs within our project.\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10692/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10692/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10691", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10691/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10691/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10691/events", "html_url": "https://github.com/near/nearcore/pull/10691", "id": 2163631681, "node_id": "PR_kwDOCQUkYs5oa_Wt", "number": 10691, "title": "refactor(resharding): refactoring the resharding nayduck tests", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-01T15:23:03Z", "updated_at": "2024-03-03T16:09:55Z", "closed_at": "2024-03-03T16:09:54Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10691", "html_url": "https://github.com/near/nearcore/pull/10691", "diff_url": "https://github.com/near/nearcore/pull/10691.diff", "patch_url": "https://github.com/near/nearcore/pull/10691.patch", "merged_at": "2024-03-03T16:09:54Z"}, "body": "Small refactoring before I add more checks for the flat storage issues. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10691/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10691/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10690", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10690/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10690/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10690/events", "html_url": "https://github.com/near/nearcore/pull/10690", "id": 2163520796, "node_id": "PR_kwDOCQUkYs5oam68", "number": 10690, "title": "refactor: use NightshadeRuntime in store_validator tests", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1136018846, "node_id": "MDU6TGFiZWwxMTM2MDE4ODQ2", "url": "https://api.github.com/repos/near/nearcore/labels/C-housekeeping", "name": "C-housekeeping", "color": "9745C6", "default": false, "description": "Category: Refactoring, cleanups, code quality"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-01T14:22:46Z", "updated_at": "2024-03-04T12:21:27Z", "closed_at": "2024-03-04T12:21:26Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10690", "html_url": "https://github.com/near/nearcore/pull/10690", "diff_url": "https://github.com/near/nearcore/pull/10690.diff", "patch_url": "https://github.com/near/nearcore/pull/10690.patch", "merged_at": "2024-03-04T12:21:26Z"}, "body": "Part of #10678 and #10634.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10690/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10690/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10689", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10689/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10689/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10689/events", "html_url": "https://github.com/near/nearcore/pull/10689", "id": 2162611788, "node_id": "PR_kwDOCQUkYs5oXd-d", "number": 10689, "title": "yield/resume: simplify trie state", "user": {"login": "saketh-are", "id": 3241341, "node_id": "MDQ6VXNlcjMyNDEzNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3241341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saketh-are", "html_url": "https://github.com/saketh-are", "followers_url": "https://api.github.com/users/saketh-are/followers", "following_url": "https://api.github.com/users/saketh-are/following{/other_user}", "gists_url": "https://api.github.com/users/saketh-are/gists{/gist_id}", "starred_url": "https://api.github.com/users/saketh-are/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saketh-are/subscriptions", "organizations_url": "https://api.github.com/users/saketh-are/orgs", "repos_url": "https://api.github.com/users/saketh-are/repos", "events_url": "https://api.github.com/users/saketh-are/events{/privacy}", "received_events_url": "https://api.github.com/users/saketh-are/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-03-01T05:00:20Z", "updated_at": "2024-03-04T18:04:59Z", "closed_at": "2024-03-04T18:04:58Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10689", "html_url": "https://github.com/near/nearcore/pull/10689", "diff_url": "https://github.com/near/nearcore/pull/10689.diff", "patch_url": "https://github.com/near/nearcore/pull/10689.patch", "merged_at": "2024-03-04T18:04:58Z"}, "body": "This PR moves PromiseYield receipts to their own DB column, whereas previously they were commingled into the postponed receipts column. \r\n\r\nTrie state for postponed receipts is complex because it supports a many-to-one relationship between data receipts and action receipts. It involves:\r\n* `POSTPONED_RECEIPT_ID`: Mapping from data id to the id of the action receipt which consumes it.\r\n* `PENDING_DATA_COUNT`: Mapping from action receipt id to the number of missing data inputs for it.\r\n* `POSTPONED_RECEIPT`: Mapping from action receipt id to the Action receipt itself.\r\n\r\nBecause yielded promise always have exactly one input data dependency, it is sufficient to maintain:\r\n* `PROMISE_YIELD_RECEIPT`: Mapping from data id to the PromiseYield receipt which consumes it.\r\n\r\nAlong with the state re-organization, the logic for processing PromiseYield and PromiseResume receipts is made explicit and separate from the logic for Action and Data receipts.\r\n\r\n---\r\n\r\nThe changes in this PR bring a few benefits:\r\n- The number of trie keys created and removed over the lifetime of a yielded promise is reduced.\r\n- The protocol is now robust to delivery of redundant PromiseResume receipts in the case that a user makes multiple calls to `promise_yield_resume` with the same data id.\r\n- We are able to eliminate the `YIELED_PROMISE` DB column, which was previous needed to enforce \"at most once\" delivery of YieldResume receipts.\r\n\r\n---\r\n\r\nNote that the DB layout changes are BC-breaking, but it's OK because yield execution is still a nightly feature.\r\n\r\nI think this PR may break the case in which `promise_yield_create` and `promise_yield_resume` are called within the same transaction due to the assumption that the PromiseYield is processed before the PromiseResume. I plan to completely rework how we handle that case but it turned out to be more significant than expected. To keep this PR manageable, I'll send another one with those changes.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10689/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10689/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10688", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10688/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10688/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10688/events", "html_url": "https://github.com/near/nearcore/pull/10688", "id": 2162024939, "node_id": "PR_kwDOCQUkYs5oVeKf", "number": 10688, "title": "fix: Deliver correct receipt type for yield timeouts", "user": {"login": "saketh-are", "id": 3241341, "node_id": "MDQ6VXNlcjMyNDEzNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3241341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saketh-are", "html_url": "https://github.com/saketh-are", "followers_url": "https://api.github.com/users/saketh-are/followers", "following_url": "https://api.github.com/users/saketh-are/following{/other_user}", "gists_url": "https://api.github.com/users/saketh-are/gists{/gist_id}", "starred_url": "https://api.github.com/users/saketh-are/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saketh-are/subscriptions", "organizations_url": "https://api.github.com/users/saketh-are/orgs", "repos_url": "https://api.github.com/users/saketh-are/repos", "events_url": "https://api.github.com/users/saketh-are/events{/privacy}", "received_events_url": "https://api.github.com/users/saketh-are/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-29T20:12:55Z", "updated_at": "2024-02-29T21:29:09Z", "closed_at": "2024-02-29T21:29:08Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10688", "html_url": "https://github.com/near/nearcore/pull/10688", "diff_url": "https://github.com/near/nearcore/pull/10688.diff", "patch_url": "https://github.com/near/nearcore/pull/10688.patch", "merged_at": "2024-02-29T21:29:08Z"}, "body": "#10676 introduced receipt variant `ReceiptEnum::PromiseResume` to distinguish yield resume receipts from normal data receipts. We should use that type not just for receipts submitted via `promise_yield_resume` but also for the receipts generated by yield timeouts.\r\n\r\nAlso in that PR, deserialization for the `PromiseResume` and `PromiseYield` types is gated behind a feature flag `yield_resume`. However, the flag was not properly configured everywhere.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10688/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10688/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10686", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10686/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10686/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10686/events", "html_url": "https://github.com/near/nearcore/pull/10686", "id": 2161224054, "node_id": "PR_kwDOCQUkYs5oSttE", "number": 10686, "title": "yield/resume: return status rather than failing if promise isn't found", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-29T13:10:13Z", "updated_at": "2024-03-01T15:50:45Z", "closed_at": "2024-03-01T15:50:45Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10686", "html_url": "https://github.com/near/nearcore/pull/10686", "diff_url": "https://github.com/near/nearcore/pull/10686.diff", "patch_url": "https://github.com/near/nearcore/pull/10686.patch", "merged_at": "2024-03-01T15:50:45Z"}, "body": "This allows users to reliably detect from the resumption function if the yield promise they are trying to has timed out already. This can be approximated with contract storage, but there is no good reason to just not give this information to the users right away?", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10686/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10686/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10685", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10685/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10685/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10685/events", "html_url": "https://github.com/near/nearcore/pull/10685", "id": 2161215917, "node_id": "PR_kwDOCQUkYs5oSr5p", "number": 10685, "title": "fix(metrics): changed shard id to shard uid in flat storage metrics", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-29T13:06:01Z", "updated_at": "2024-03-01T15:54:11Z", "closed_at": "2024-03-01T15:54:09Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10685", "html_url": "https://github.com/near/nearcore/pull/10685", "diff_url": "https://github.com/near/nearcore/pull/10685.diff", "patch_url": "https://github.com/near/nearcore/pull/10685.patch", "merged_at": "2024-03-01T15:54:09Z"}, "body": "During resharding we maintain flat storage for both the parent and children shards. In order to disambiguate and not mix the metrics for shards with the same ids we should use shard_uid instead of shard_id. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10685/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10685/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10684", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10684/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10684/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10684/events", "html_url": "https://github.com/near/nearcore/pull/10684", "id": 2161136680, "node_id": "PR_kwDOCQUkYs5oSagM", "number": 10684, "title": "fix(resharding): create flat storage for children shards after node restart", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-29T12:24:19Z", "updated_at": "2024-02-29T14:05:40Z", "closed_at": "2024-02-29T14:05:39Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10684", "html_url": "https://github.com/near/nearcore/pull/10684", "diff_url": "https://github.com/near/nearcore/pull/10684.diff", "patch_url": "https://github.com/near/nearcore/pull/10684.patch", "merged_at": "2024-02-29T14:05:39Z"}, "body": "The root cause of the resharding issue in mocknet testing seems to be that when the node is restarted the flat storage is not recreated. Without flat storage when applying the first block of the new epoch we get different state roots than the nodes that do have flat storage. \r\n\r\nThis PR introduces creating the flat storage for the children shards aka next epoch shards. This is depended on the flat storage status that is set at the end of resharding [here](https://github.com/near/nearcore-private/blob/1a4756e1acbebc073f312fde1457be47e1da3fc0/chain/chain/src/resharding.rs#L180). \r\n\r\nI failed to reproduce the issue so we'll need to test it in mocknet unfortunately. We should test all the cases (no restart, restart during resharding, restart during catchup, restart post catchup). cc @marcelo-gonzalez  \r\n\r\nIdeally we should also error out when trying to apply a chunk without flat storage but I'm not brave enough to do it in 1.37 :) \r\n\r\nI also changed shard_id to shard_uid in a few places but this needs to happen on a wider scale. I'll do that separately too. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10684/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10684/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10682", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10682/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10682/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10682/events", "html_url": "https://github.com/near/nearcore/pull/10682", "id": 2159912022, "node_id": "PR_kwDOCQUkYs5oOQmg", "number": 10682, "title": "refactor: Rename receipt id utils for clarity", "user": {"login": "saketh-are", "id": 3241341, "node_id": "MDQ6VXNlcjMyNDEzNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3241341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saketh-are", "html_url": "https://github.com/saketh-are", "followers_url": "https://api.github.com/users/saketh-are/followers", "following_url": "https://api.github.com/users/saketh-are/following{/other_user}", "gists_url": "https://api.github.com/users/saketh-are/gists{/gist_id}", "starred_url": "https://api.github.com/users/saketh-are/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saketh-are/subscriptions", "organizations_url": "https://api.github.com/users/saketh-are/orgs", "repos_url": "https://api.github.com/users/saketh-are/repos", "events_url": "https://api.github.com/users/saketh-are/events{/privacy}", "received_events_url": "https://api.github.com/users/saketh-are/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-28T21:38:23Z", "updated_at": "2024-02-29T23:02:51Z", "closed_at": "2024-02-29T23:02:50Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10682", "html_url": "https://github.com/near/nearcore/pull/10682", "diff_url": "https://github.com/near/nearcore/pull/10682.diff", "patch_url": "https://github.com/near/nearcore/pull/10682.patch", "merged_at": "2024-02-29T23:02:50Z"}, "body": "This PR renames the utility function `create_data_id` to `create_receipt_id_from_action_hash`.\r\n\r\nThe receipt id is a concept which exists at the Receipt level and is not specific to a kind of Receipt (whether action or data). Each id needs to be globally unique across receipts of all kinds, and the ids used for action and data receipts share the same properties. \r\n\r\nThere is no meaningful distinction to be made between \"data ids\" and other kinds of receipt ids, so I find the name of this low-level utility to be misleading.  In particular, it would not be incorrect to generate an id for an action receipt using the function in question.\r\n\r\nRenaming the function better reflects what it actually does rather than how it happens to be used. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10682/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10682/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10681", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10681/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10681/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10681/events", "html_url": "https://github.com/near/nearcore/pull/10681", "id": 2159645393, "node_id": "PR_kwDOCQUkYs5oNVcT", "number": 10681, "title": "refactor: deduplicate config-related code", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-28T18:59:23Z", "updated_at": "2024-02-29T21:02:01Z", "closed_at": "2024-02-29T21:02:00Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10681", "html_url": "https://github.com/near/nearcore/pull/10681", "diff_url": "https://github.com/near/nearcore/pull/10681.diff", "patch_url": "https://github.com/near/nearcore/pull/10681.patch", "merged_at": "2024-02-29T21:02:00Z"}, "body": "In #10675 some of the constants and testing-related methods from `nearcore::config` were copied to `near_chain_configs::test_utils`. This PR removes it from `nearcore::configs` and replaces all the usages to take it from `near_chain_configs`. Also some of the constants are used not only for testing, so those are moved directly to `near_chain_configs`.\r\n\r\nAlso wrap tests inside `nearcore::config` into `mod tests` because that is how it should be.\r\n\r\nThis change doesn't introduce any functional changes to the codebase, it only moves code around.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10681/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10681/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10680", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10680/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10680/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10680/events", "html_url": "https://github.com/near/nearcore/pull/10680", "id": 2159335045, "node_id": "PR_kwDOCQUkYs5oMRtK", "number": 10680, "title": "yield/resume: improve documentation of the host functions a lil bit", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-28T16:17:40Z", "updated_at": "2024-02-29T16:46:26Z", "closed_at": "2024-02-29T16:46:25Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10680", "html_url": "https://github.com/near/nearcore/pull/10680", "diff_url": "https://github.com/near/nearcore/pull/10680.diff", "patch_url": "https://github.com/near/nearcore/pull/10680.patch", "merged_at": "2024-02-29T16:46:25Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10680/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10680/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10679", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10679/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10679/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10679/events", "html_url": "https://github.com/near/nearcore/pull/10679", "id": 2159270418, "node_id": "PR_kwDOCQUkYs5oMD0k", "number": 10679, "title": "fix: fix feature = \"cargo-clippy\" deprecation", "user": {"login": "rex4539", "id": 227442, "node_id": "MDQ6VXNlcjIyNzQ0Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/227442?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rex4539", "html_url": "https://github.com/rex4539", "followers_url": "https://api.github.com/users/rex4539/followers", "following_url": "https://api.github.com/users/rex4539/following{/other_user}", "gists_url": "https://api.github.com/users/rex4539/gists{/gist_id}", "starred_url": "https://api.github.com/users/rex4539/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rex4539/subscriptions", "organizations_url": "https://api.github.com/users/rex4539/orgs", "repos_url": "https://api.github.com/users/rex4539/repos", "events_url": "https://api.github.com/users/rex4539/events{/privacy}", "received_events_url": "https://api.github.com/users/rex4539/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-02-28T15:47:05Z", "updated_at": "2024-02-28T18:24:12Z", "closed_at": "2024-02-28T18:24:12Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10679", "html_url": "https://github.com/near/nearcore/pull/10679", "diff_url": "https://github.com/near/nearcore/pull/10679.diff", "patch_url": "https://github.com/near/nearcore/pull/10679.patch", "merged_at": "2024-02-28T18:24:12Z"}, "body": "https://blog.rust-lang.org/2024/02/28/Clippy-deprecating-feature-cargo-clippy.html", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10679/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10679/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10677", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10677/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10677/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10677/events", "html_url": "https://github.com/near/nearcore/pull/10677", "id": 2158167223, "node_id": "PR_kwDOCQUkYs5oIRmm", "number": 10677, "title": "Standardize most of the codebase to use near_async::time.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-28T05:45:16Z", "updated_at": "2024-03-05T02:01:28Z", "closed_at": "2024-03-05T00:51:43Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10677", "html_url": "https://github.com/near/nearcore/pull/10677", "diff_url": "https://github.com/near/nearcore/pull/10677.diff", "patch_url": "https://github.com/near/nearcore/pull/10677.patch", "merged_at": "2024-03-05T00:51:43Z"}, "body": "Replace the uses of\r\n * `chrono::{Instant, Duration, DateTime<Utc>}`\r\n * `std::time::{Duration, Instant}`\r\n * `StaticClock`\r\nwith `near_async::time::{Duration, Instant, Utc, Clock}`, the first three of which are aliases for `time::{Duration, Instant, OffsetDateTime}`.\r\n\r\nWhy?\r\n * It's very inflexible to use several time libraries and then having to convert between them.\r\n * `StaticClock` is terrible because it's static, it's not even possible to directly adapt TestLoop to also affect `StaticClock`, because `StaticClock` is thread-local, lol. But so many places use `StaticClock`, making fake-time-based integration testing impossible, so it's necessary to get rid of it.\r\n * `StaticClock` uses chrono, but `Clock` uses `near_async::time::...`\r\n\r\nThe replacement involves the following:\r\n * Introduce the use of Clock for Client, Chain, Doomslug, BlockDelayTracker, etc., and remove parameters that used to take timestamps directly and use the clock instead, replace usages of StaticClock with this clock, and replace usages of .elapsed() with a subtraction from clock.now().\r\n   * This replacement is almost complete but there are still remaining pieces that use .elapsed(), ::now(), etc., but they are not critical and will be addressed later.\r\n * `StaticClock` is completely deleted.\r\n * The `near_async::time::Duration` is signed, whereas `std::time::Duration` is unsigned. So some care is taken to preserve existing behavior. `a.saturating_duration_since(b)` is replaced with `(a - b).max(Duration::ZERO)` or depending on context, an equivalent form such as `(a - b).whole_milliseconds().max(0) as u64` or `(a - b).as_seconds_f64().max(0.0)`.\r\n   * Some APIs requires `std::time::Duration`, such as tokio::time::sleep, and aws APIs. This requires a conversion. When it is obvious that the source signed duration is non-negative, I directly use `unsigned_abs()`; otherwise, I use a `.max(Duration::ZERO).unsigned_abs()`.\r\n   * Some serialized structs must continue to use std::time::Duration, notably `GenesisConfig` and `Config`. For the latter, I've still switched to using `near_async::time::Duration`, but added a serde-with annotation so that they are serialized as `std::time::Duration`. An additional test is added to assert that all `Duration`s are annotated this way. This is important in ensuring that the config.json files remain compatible.\r\n * from_timestamp and to_timestamp is replaced with `Utc::from_unix_timestamp_nanos` and `unix_timestamp_nanos`.\r\n\r\nThere's also a side change to add more to the simple_test_loop_example.rs test.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10677/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10677/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10676", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10676/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10676/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10676/events", "html_url": "https://github.com/near/nearcore/pull/10676", "id": 2157939901, "node_id": "PR_kwDOCQUkYs5oHh9M", "number": 10676, "title": "refactor: Add ReceiptEnum variants for yield receipts", "user": {"login": "saketh-are", "id": 3241341, "node_id": "MDQ6VXNlcjMyNDEzNDE=", "avatar_url": "https://avatars.githubusercontent.com/u/3241341?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saketh-are", "html_url": "https://github.com/saketh-are", "followers_url": "https://api.github.com/users/saketh-are/followers", "following_url": "https://api.github.com/users/saketh-are/following{/other_user}", "gists_url": "https://api.github.com/users/saketh-are/gists{/gist_id}", "starred_url": "https://api.github.com/users/saketh-are/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saketh-are/subscriptions", "organizations_url": "https://api.github.com/users/saketh-are/orgs", "repos_url": "https://api.github.com/users/saketh-are/repos", "events_url": "https://api.github.com/users/saketh-are/events{/privacy}", "received_events_url": "https://api.github.com/users/saketh-are/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-28T02:12:46Z", "updated_at": "2024-03-20T12:44:10Z", "closed_at": "2024-02-28T17:25:42Z", "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10676", "html_url": "https://github.com/near/nearcore/pull/10676", "diff_url": "https://github.com/near/nearcore/pull/10676.diff", "patch_url": "https://github.com/near/nearcore/pull/10676.patch", "merged_at": "2024-02-28T17:25:42Z"}, "body": "Adds variant `ReceiptEnum::PromiseYield(Action)` to distinguish yield-created action receipts from normal ones. Adds variant `ReceiptEnum::PromiseResume(Data)` to distinguish yield-created data receipts from normal ones.\r\n\r\nThis PR does not change any behavior. It lays groundwork for further changes which will allow us to simplify and optimize yield execution, as discussed [here](https://near.zulipchat.com/#narrow/stream/295558-pagoda.2Fcore/topic/Yield.2Fresume.20implementation/near/421872763).", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10676/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10676/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10675", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10675/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10675/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10675/events", "html_url": "https://github.com/near/nearcore/pull/10675", "id": 2157588575, "node_id": "PR_kwDOCQUkYs5oGWpI", "number": 10675, "title": "refactor: move NightshadeRuntime to chain", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-02-27T20:59:48Z", "updated_at": "2024-02-28T18:15:11Z", "closed_at": "2024-02-28T18:15:10Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10675", "html_url": "https://github.com/near/nearcore/pull/10675", "diff_url": "https://github.com/near/nearcore/pull/10675.diff", "patch_url": "https://github.com/near/nearcore/pull/10675.patch", "merged_at": "2024-02-28T18:15:10Z"}, "body": "This PR is a part of getting rid of `KeyValueRuntime` (#10678) and `MockEpochManager` (#10634).\r\n\r\nCurrently `NightshadeRuntime` is part of `nearcore` which makes it impossible to use it in `chain` since `chain` depends on `nearcore`. We need to use `NightshadeRuntime` as a replacement for `KeyValueRuntime` in `chain` tests. Ideally it would be great to move it to `node-runtime` crate, but currently it has a lot of dependencies from `near_chain` which makes it very challenging, so as the first step let's move it to `chain`.\r\n\r\nThis PR includes:\r\n* move `nearcore::runtime` to `near_chain::runtime`\r\n* introduce `NightshadeRuntimeExt` to expose `NightshadeRuntime::from_config` separately since `NearConfig` is part of `nearcore`\r\n* move `GenesisExt` test methods directly to `Genesis`, also duplicate some constants for now (will be refactored separately to reduce size of this PR).\r\n* move the necessary migrations code to `chain`", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10675/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10675/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10674", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10674/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10674/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10674/events", "html_url": "https://github.com/near/nearcore/pull/10674", "id": 2157533506, "node_id": "PR_kwDOCQUkYs5oGKnL", "number": 10674, "title": "fuzz the handshake reception", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-27T20:20:24Z", "updated_at": "2024-03-05T20:14:48Z", "closed_at": "2024-03-01T19:54:35Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10674", "html_url": "https://github.com/near/nearcore/pull/10674", "diff_url": "https://github.com/near/nearcore/pull/10674.diff", "patch_url": "https://github.com/near/nearcore/pull/10674.patch", "merged_at": "2024-03-01T19:54:34Z"}, "body": "Part of:\r\n- https://github.com/near/near-one-project-tracking/issues/19", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10674/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10674/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10673", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10673/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10673/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10673/events", "html_url": "https://github.com/near/nearcore/pull/10673", "id": 2156985978, "node_id": "PR_kwDOCQUkYs5oEP8X", "number": 10673, "title": "fix: use `log_assert_fail` when creating state witness with missing proof", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-27T16:03:01Z", "updated_at": "2024-02-27T16:42:52Z", "closed_at": "2024-02-27T16:42:51Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10673", "html_url": "https://github.com/near/nearcore/pull/10673", "diff_url": "https://github.com/near/nearcore/pull/10673.diff", "patch_url": "https://github.com/near/nearcore/pull/10673.patch", "merged_at": "2024-02-27T16:42:51Z"}, "body": "Such situations indicate illegal state/programmatic error that will result in missing chunk. It is still better to avoid panic in such case, so we return `Err` instead. This PR adds `log_assert_fail` which was introduced specifically for such cases.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10673/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10673/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10671", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10671/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10671/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10671/events", "html_url": "https://github.com/near/nearcore/pull/10671", "id": 2156461838, "node_id": "PR_kwDOCQUkYs5oCcP9", "number": 10671, "title": "feat: remove flat storage creation params from the config", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-27T12:26:28Z", "updated_at": "2024-02-27T14:11:27Z", "closed_at": "2024-02-27T14:11:26Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10671", "html_url": "https://github.com/near/nearcore/pull/10671", "diff_url": "https://github.com/near/nearcore/pull/10671.diff", "patch_url": "https://github.com/near/nearcore/pull/10671.patch", "merged_at": "2024-02-27T14:11:26Z"}, "body": "At this point we expect flat storage to be created everywhere, so these params are no longer needed. \r\nWe still keep it as part of `ClientConfig`, it will be removed separately along with the rest of creation-related code.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10671/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10671/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10670", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10670/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10670/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10670/events", "html_url": "https://github.com/near/nearcore/pull/10670", "id": 2156376457, "node_id": "PR_kwDOCQUkYs5oCJbO", "number": 10670, "title": "[fix] Fix Lychee lint test", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-27T11:42:18Z", "updated_at": "2024-02-27T12:51:54Z", "closed_at": "2024-02-27T12:51:53Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10670", "html_url": "https://github.com/near/nearcore/pull/10670", "diff_url": "https://github.com/near/nearcore/pull/10670.diff", "patch_url": "https://github.com/near/nearcore/pull/10670.patch", "merged_at": "2024-02-27T12:51:53Z"}, "body": "Super irritating to see the Lychee lint test continuously failing", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10670/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10670/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10669", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10669/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10669/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10669/events", "html_url": "https://github.com/near/nearcore/pull/10669", "id": 2156339887, "node_id": "PR_kwDOCQUkYs5oCBQp", "number": 10669, "title": "[cleanup] Use `is_genesis` function where ever possible", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-27T11:23:22Z", "updated_at": "2024-02-27T12:54:09Z", "closed_at": "2024-02-27T12:54:08Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10669", "html_url": "https://github.com/near/nearcore/pull/10669", "diff_url": "https://github.com/near/nearcore/pull/10669.diff", "patch_url": "https://github.com/near/nearcore/pull/10669.patch", "merged_at": "2024-02-27T12:54:08Z"}, "body": "Noticed the introduction of `is_genesis` function in https://github.com/near/nearcore/pull/10633\r\n\r\nThis PR tries to use the `is_genesis` function in place of comparing prev_hash with CryptoHash::default()", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10669/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10669/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10667", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10667/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10667/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10667/events", "html_url": "https://github.com/near/nearcore/pull/10667", "id": 2156212350, "node_id": "PR_kwDOCQUkYs5oBlE4", "number": 10667, "title": "fix: Don't ban peers for invalid ChunkStateWitness messages", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-27T10:19:33Z", "updated_at": "2024-02-27T10:58:32Z", "closed_at": "2024-02-27T10:58:31Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10667", "html_url": "https://github.com/near/nearcore/pull/10667", "diff_url": "https://github.com/near/nearcore/pull/10667.diff", "patch_url": "https://github.com/near/nearcore/pull/10667.patch", "merged_at": "2024-02-27T10:58:31Z"}, "body": "The current logic of banning peers that sent a message with invalid ChunkStateWitness is flawed - it bans the peer that forwarded the message instead of the one that produced it, which means that innocent peers could be banned for forwarding a bad message.\r\n\r\nLet's remove the existing banning logic because it's invalid. Later it can be properly reimplemented in another PR.\r\n\r\nFixes: https://github.com/near/stakewars-iv/issues/17\r\nRefs: [zulip conversation](https://near.zulipchat.com/#narrow/stream/407237-pagoda.2Fcore.2Fstateless-validation/topic/StatelessNet.20monitoring/near/423565210)", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10667/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10667/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10666", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10666/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10666/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10666/events", "html_url": "https://github.com/near/nearcore/pull/10666", "id": 2156004464, "node_id": "PR_kwDOCQUkYs5oA3Vj", "number": 10666, "title": "refactor: wrote log_assert macro inline in primitives and remove o11y dependency", "user": {"login": "jaswinder6991", "id": 12672862, "node_id": "MDQ6VXNlcjEyNjcyODYy", "avatar_url": "https://avatars.githubusercontent.com/u/12672862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jaswinder6991", "html_url": "https://github.com/jaswinder6991", "followers_url": "https://api.github.com/users/jaswinder6991/followers", "following_url": "https://api.github.com/users/jaswinder6991/following{/other_user}", "gists_url": "https://api.github.com/users/jaswinder6991/gists{/gist_id}", "starred_url": "https://api.github.com/users/jaswinder6991/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jaswinder6991/subscriptions", "organizations_url": "https://api.github.com/users/jaswinder6991/orgs", "repos_url": "https://api.github.com/users/jaswinder6991/repos", "events_url": "https://api.github.com/users/jaswinder6991/events{/privacy}", "received_events_url": "https://api.github.com/users/jaswinder6991/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 15, "created_at": "2024-02-27T08:44:37Z", "updated_at": "2024-02-28T14:50:20Z", "closed_at": "2024-02-28T14:50:19Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10666", "html_url": "https://github.com/near/nearcore/pull/10666", "diff_url": "https://github.com/near/nearcore/pull/10666.diff", "patch_url": "https://github.com/near/nearcore/pull/10666.patch", "merged_at": "2024-02-28T14:50:19Z"}, "body": "This is part of the ongoing effort towards reducing dependencies in near-primitives.\r\nSee https://github.com/near/nearcore/issues/8888 for context.\r\n\r\nThe new crate near-log-utils is a light weight crate which has the log_assert and log_assert_fail macros that are used in primitives helping in dropping the o11y dependency from primitives completely.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10666/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10666/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10665", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10665/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10665/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10665/events", "html_url": "https://github.com/near/nearcore/pull/10665", "id": 2155958614, "node_id": "PR_kwDOCQUkYs5oAtOT", "number": 10665, "title": "fix: pytest staking tests and tracking shards", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-02-27T08:20:50Z", "updated_at": "2024-02-27T14:11:27Z", "closed_at": "2024-02-27T14:11:26Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10665", "html_url": "https://github.com/near/nearcore/pull/10665", "diff_url": "https://github.com/near/nearcore/pull/10665.diff", "patch_url": "https://github.com/near/nearcore/pull/10665.patch", "merged_at": "2024-02-27T14:11:26Z"}, "body": "Force tracking shard 0 for all nodes in staking-related pytests.\r\n\r\nCurrent failures are caused by stake of some nodes going to 0, which causes node to fall out of validator set and stop tracking shard 0. When it gets back, state sync is triggered, which is (currently?) supported only in state-sync related tests.\r\n\r\nWith that simple change, all staking tests pass now: https://nayduck.near.org/#/run/3398.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10665/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10665/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10664", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10664/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10664/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10664/events", "html_url": "https://github.com/near/nearcore/pull/10664", "id": 2155949915, "node_id": "PR_kwDOCQUkYs5oArVL", "number": 10664, "title": "fix: comment test_clear_old_data_too_many_heights", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-27T08:16:05Z", "updated_at": "2024-02-27T09:35:24Z", "closed_at": "2024-02-27T09:35:23Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10664", "html_url": "https://github.com/near/nearcore/pull/10664", "diff_url": "https://github.com/near/nearcore/pull/10664.diff", "patch_url": "https://github.com/near/nearcore/pull/10664.patch", "merged_at": "2024-02-27T09:35:23Z"}, "body": "Put correct path to this test in nayduck... and comment this test for now, because it doesn't work with resharding data and `MockEpochManager`.  cc #10634\r\n\r\nLater, we either should remove resharding scenario or make add_block scenario respect epoch manager.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10664/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10664/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10662", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10662/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10662/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10662/events", "html_url": "https://github.com/near/nearcore/pull/10662", "id": 2155406174, "node_id": "PR_kwDOCQUkYs5n-1G6", "number": 10662, "title": "Fix AsyncSender so that the callback does not panic when the response future is dropped.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-27T00:21:11Z", "updated_at": "2024-02-27T15:29:10Z", "closed_at": "2024-02-27T15:29:10Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10662", "html_url": "https://github.com/near/nearcore/pull/10662", "diff_url": "https://github.com/near/nearcore/pull/10662.diff", "patch_url": "https://github.com/near/nearcore/pull/10662.patch", "merged_at": "2024-02-27T15:29:10Z"}, "body": "Also add a test for this behavior.\r\n\r\nCloses #10660", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10662/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10662/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10661", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10661/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10661/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10661/events", "html_url": "https://github.com/near/nearcore/pull/10661", "id": 2155300587, "node_id": "PR_kwDOCQUkYs5n-eGJ", "number": 10661, "title": "[TestLoop Refactoring] (4/n) Further refactorings to allow ClientActions to be run in a TestLoop test", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-26T22:42:26Z", "updated_at": "2024-02-28T04:04:40Z", "closed_at": "2024-02-28T04:04:39Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10661", "html_url": "https://github.com/near/nearcore/pull/10661", "diff_url": "https://github.com/near/nearcore/pull/10661.diff", "patch_url": "https://github.com/near/nearcore/pull/10661.patch", "merged_at": "2024-02-28T04:04:39Z"}, "body": "A few changes:\r\n - Split SyncJobsActor into SyncJobsActions/SyncJobsActor, the same way it was done for the ClientActor.\r\n - Replace the `Box<dyn Fn(...)>` with `Sender<...>` for the SyncJobsActor message senders given to ClientActions and other functions\r\n - Replace the sync jobs `ArbiterHandle` with a `FutureSpawner`. Added a `ActixArbiterHandleFutureSpawner` that spawns the future onto the `ArbiterHandle` rather than the spawner's arbiter.\r\n - Replace `Addr<TelemetryActor>` with `Sender<TelemetryEvent>`.\r\n - Introduced some test utils for making event listeners for TestLoop-based tests that use ClientActions and SyncJobsActions.\r\n - A few minor improvements for the TestLoop API, and the log visualizer UI.\r\n - A WIP example on testing Client with TestLoop. It doesn't do anything useful yet, but it's an attempt to get started. The major TODO here is to make the network layer work.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10661/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10661/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10658", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10658/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10658/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10658/events", "html_url": "https://github.com/near/nearcore/pull/10658", "id": 2155104690, "node_id": "PR_kwDOCQUkYs5n9yBI", "number": 10658, "title": "feat: clean orphaned witnesses below the last final height", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-26T20:55:36Z", "updated_at": "2024-02-27T11:20:30Z", "closed_at": "2024-02-27T11:20:29Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10658", "html_url": "https://github.com/near/nearcore/pull/10658", "diff_url": "https://github.com/near/nearcore/pull/10658.diff", "patch_url": "https://github.com/near/nearcore/pull/10658.patch", "merged_at": "2024-02-27T11:20:29Z"}, "body": "Orphaned witnesses which are below the final height of the chain will never be processed, so let's remove them from the orphan pool to free up memory.\r\n\r\nFixes: https://github.com/near/nearcore/issues/10649", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10658/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10658/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10657", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10657/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10657/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10657/events", "html_url": "https://github.com/near/nearcore/pull/10657", "id": 2155039291, "node_id": "PR_kwDOCQUkYs5n9jxR", "number": 10657, "title": "fix: clippy lint in rosetta rpc", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-26T20:14:55Z", "updated_at": "2024-02-27T09:14:16Z", "closed_at": "2024-02-27T09:14:15Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10657", "html_url": "https://github.com/near/nearcore/pull/10657", "diff_url": "https://github.com/near/nearcore/pull/10657.diff", "patch_url": "https://github.com/near/nearcore/pull/10657.patch", "merged_at": "2024-02-27T09:14:15Z"}, "body": "A new clippy lint has recently been activated in https://github.com/near/nearcore/pull/10654, which caused `cargo clippy` to emit a warning because the rosetta rpc code uses `.or()` instead of `.or_else()`. Fix by changing it to `or_else()`:\r\n\r\n```console\r\n~/nearcore$ cargo clippy\r\n    Checking near-rosetta-rpc v0.0.0 (/home/ubuntu/nearcore/chain/rosetta-rpc)\r\nerror: use of `or` followed by a function call\r\n   --> chain/rosetta-rpc/src/adapters/nep141.rs:119:66\r\n    |\r\n119 |       let serde_call_result = serde_json::from_slice(&call_result).or(Err(\r\n    |  __________________________________________________________________^\r\n120 | |         crate::errors::ErrorKind::InternalInvariantError(format!(\r\n121 | |             \"Couldn't read the value from the contract {:?}, for the account {:?}\",\r\n122 | |             contract_address.clone(),\r\n123 | |             account_identifier.address.clone(),\r\n124 | |         )),\r\n125 | |     ))?;\r\n    | |______^\r\n    |\r\n    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#or_fun_call\r\n    = note: requested on the command line with `-D clippy::or-fun-call`\r\nhelp: try\r\n    |\r\n119 ~     let serde_call_result = serde_json::from_slice(&call_result).or_else(|_| Err(\r\n120 +         crate::errors::ErrorKind::InternalInvariantError(format!(\r\n121 +             \"Couldn't read the value from the contract {:?}, for the account {:?}\",\r\n122 +             contract_address.clone(),\r\n123 +             account_identifier.address.clone(),\r\n124 +         )),\r\n125 ~     ))?;\r\n    |\r\n\r\nerror: could not compile `near-rosetta-rpc` (lib) due to 1 previous error\r\n```\r\n\r\nInterestingly `clippy --tests` doesn't emit the warning, only running `clippy` by itself causes this warning to appear. I guess that's why the CI in the original PR didn't catch it.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10657/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10657/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10655", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10655/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10655/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10655/events", "html_url": "https://github.com/near/nearcore/pull/10655", "id": 2154821532, "node_id": "PR_kwDOCQUkYs5n8zYA", "number": 10655, "title": "revert broadcast_tx_commit checks", "user": {"login": "telezhnaya", "id": 11246099, "node_id": "MDQ6VXNlcjExMjQ2MDk5", "avatar_url": "https://avatars.githubusercontent.com/u/11246099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/telezhnaya", "html_url": "https://github.com/telezhnaya", "followers_url": "https://api.github.com/users/telezhnaya/followers", "following_url": "https://api.github.com/users/telezhnaya/following{/other_user}", "gists_url": "https://api.github.com/users/telezhnaya/gists{/gist_id}", "starred_url": "https://api.github.com/users/telezhnaya/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/telezhnaya/subscriptions", "organizations_url": "https://api.github.com/users/telezhnaya/orgs", "repos_url": "https://api.github.com/users/telezhnaya/repos", "events_url": "https://api.github.com/users/telezhnaya/events{/privacy}", "received_events_url": "https://api.github.com/users/telezhnaya/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-26T18:20:10Z", "updated_at": "2024-03-01T08:46:06Z", "closed_at": "2024-03-01T08:46:05Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10655", "html_url": "https://github.com/near/nearcore/pull/10655", "diff_url": "https://github.com/near/nearcore/pull/10655.diff", "patch_url": "https://github.com/near/nearcore/pull/10655.patch", "merged_at": "2024-03-01T08:46:05Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10655/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10655/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10654", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10654/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10654/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10654/events", "html_url": "https://github.com/near/nearcore/pull/10654", "id": 2154545195, "node_id": "PR_kwDOCQUkYs5n72kh", "number": 10654, "title": "[clippy] Add `or_fun_call` and `unnecessary_lazy_evaluations` lint rules", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-26T16:05:13Z", "updated_at": "2024-02-26T16:53:32Z", "closed_at": "2024-02-26T16:53:31Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10654", "html_url": "https://github.com/near/nearcore/pull/10654", "diff_url": "https://github.com/near/nearcore/pull/10654.diff", "patch_url": "https://github.com/near/nearcore/pull/10654.patch", "merged_at": "2024-02-26T16:53:31Z"}, "body": "Following up on PR https://github.com/near/nearcore/pull/10653\r\n\r\nRule: https://rust-lang.github.io/rust-clippy/master/index.html#/or_fun_call", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10654/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10654/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10653", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10653/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10653/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10653/events", "html_url": "https://github.com/near/nearcore/pull/10653", "id": 2153825575, "node_id": "PR_kwDOCQUkYs5n5Y2j", "number": 10653, "title": "fix: avoid unnecessary string interpolation", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-26T10:35:58Z", "updated_at": "2024-02-26T12:17:41Z", "closed_at": "2024-02-26T12:17:40Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10653", "html_url": "https://github.com/near/nearcore/pull/10653", "diff_url": "https://github.com/near/nearcore/pull/10653.diff", "patch_url": "https://github.com/near/nearcore/pull/10653.patch", "merged_at": "2024-02-26T12:17:39Z"}, "body": "With `ok_or` string interpolation is executed even when there is no error which is the prevalent case. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10653/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10653/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10652", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10652/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10652/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10652/events", "html_url": "https://github.com/near/nearcore/pull/10652", "id": 2153814920, "node_id": "PR_kwDOCQUkYs5n5Wc1", "number": 10652, "title": "fix: return an error instead of panic for missing transactions validation storage proof", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-26T10:32:09Z", "updated_at": "2024-02-26T16:49:56Z", "closed_at": "2024-02-26T16:49:55Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10652", "html_url": "https://github.com/near/nearcore/pull/10652", "diff_url": "https://github.com/near/nearcore/pull/10652.diff", "patch_url": "https://github.com/near/nearcore/pull/10652.patch", "merged_at": "2024-02-26T16:49:55Z"}, "body": "To be consistent with how we handle missing state transition data for applying chunks:\r\n```\r\n            let StoredChunkStateTransitionData { base_state, receipts_hash } = store\r\n                .get_ser(\r\n                    near_store::DBCol::StateTransitionData,\r\n                    &near_primitives::utils::get_block_shard_id(main_block, shard_id),\r\n                )?\r\n                .ok_or(Error::Other(format!(\r\n                    \"Missing main transition state proof for block {main_block} and shard {shard_id}\"\r\n                )))?;\r\n```", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10652/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10652/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10647", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10647/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10647/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10647/events", "html_url": "https://github.com/near/nearcore/pull/10647", "id": 2149053991, "node_id": "PR_kwDOCQUkYs5npYJ5", "number": 10647, "title": "refactor: add `FlatStateDeltaMetadata::has_changes`", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-22T13:15:16Z", "updated_at": "2024-02-22T14:29:07Z", "closed_at": "2024-02-22T14:29:06Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10647", "html_url": "https://github.com/near/nearcore/pull/10647", "diff_url": "https://github.com/near/nearcore/pull/10647.diff", "patch_url": "https://github.com/near/nearcore/pull/10647.patch", "merged_at": "2024-02-22T14:29:06Z"}, "body": "This PR is a follow-up for [this comment](https://github.com/near/nearcore/pull/10608/files#r1499133795).\r\n\r\nThis expresses the contract around `prev_block_with_changes` with a separate function since `prev_block_with_changes.is_none()` check is confusing\r\n```\r\n    /// `None` if the block itself has flat state changes.\r\n    /// `Some` if the block has no flat state changes, and contains\r\n    /// info of the last block with some flat state changes.\r\n```", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10647/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10647/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10646", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10646/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10646/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10646/events", "html_url": "https://github.com/near/nearcore/pull/10646", "id": 2147822840, "node_id": "PR_kwDOCQUkYs5nlLe5", "number": 10646, "title": "[TestLoop Refactoring] (3/n) Split ClientActions from ClientActor.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-21T22:30:00Z", "updated_at": "2024-02-26T08:38:55Z", "closed_at": "2024-02-23T17:26:24Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10646", "html_url": "https://github.com/near/nearcore/pull/10646", "diff_url": "https://github.com/near/nearcore/pull/10646.diff", "patch_url": "https://github.com/near/nearcore/pull/10646.patch", "merged_at": "2024-02-23T17:26:23Z"}, "body": "This makes it so that ClientActor has no logic, and is purely an Actix shell. This way, ClientActions can be independently tested.\r\n\r\nAlso, this adds another example to the core-async library that shows how to test an Actix component. It demonstrates the use of TestLoop to test both asynchronous actix requests and periodic timers. The same idea can be used to test the client actor by constructing and using ClientActions in a TestLoop test.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10646/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10646/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10645", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10645/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10645/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10645/events", "html_url": "https://github.com/near/nearcore/pull/10645", "id": 2147776724, "node_id": "PR_kwDOCQUkYs5nlBlH", "number": 10645, "title": "estimator: switch to Haswell-v4 architecture & podman work", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-21T21:52:41Z", "updated_at": "2024-02-29T14:48:54Z", "closed_at": "2024-02-29T14:48:53Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10645", "html_url": "https://github.com/near/nearcore/pull/10645", "diff_url": "https://github.com/near/nearcore/pull/10645.diff", "patch_url": "https://github.com/near/nearcore/pull/10645.patch", "merged_at": "2024-02-29T14:48:53Z"}, "body": "The previous CPU of choice does not support AVX, so the estimation does not complete with that CPU of choice. However QEMU did not support these instructions in its TCG in versions used before. I had to grab a more recent version of it and build it in our reproducible environment. Now I don't appreciate docker needing a root service so I rewrote some of the text around the setup to use podman user-space container runtime instead. Now the scripts run without any notable permission or service requiremenets (besides the requirement to have podman tool available instead of docker.)\r\n\r\nReferences to docker still remain here and there \u2013 I will resolve them once I'm done with the primary task at hand.\r\n\r\nThe estimations are not quite what they seem to have been recorded last time continuous estimation ran successfully (protocol version was 50!?) but this difference appears to be reasonably reproducible between the two CPU choices (which makes sense -- we're counting instructions executed) for what test cases work with the previous option.\r\n\r\nUnfortunately it is difficult for me to provide specific numbers as the full estimator run takes some 12 hours-or-so to run under qemu\u2026", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10645/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10645/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10644", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10644/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10644/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10644/events", "html_url": "https://github.com/near/nearcore/pull/10644", "id": 2147515943, "node_id": "PR_kwDOCQUkYs5nkH7U", "number": 10644, "title": "fix lychee lints", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-21T19:22:12Z", "updated_at": "2024-02-21T19:59:00Z", "closed_at": "2024-02-21T19:58:59Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10644", "html_url": "https://github.com/near/nearcore/pull/10644", "diff_url": "https://github.com/near/nearcore/pull/10644.diff", "patch_url": "https://github.com/near/nearcore/pull/10644.patch", "merged_at": "2024-02-21T19:58:58Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10644/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10644/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10643", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10643/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10643/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10643/events", "html_url": "https://github.com/near/nearcore/pull/10643", "id": 2147449159, "node_id": "PR_kwDOCQUkYs5nj5PY", "number": 10643, "title": "bump our bolero dependency", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-21T18:40:01Z", "updated_at": "2024-02-21T19:46:30Z", "closed_at": "2024-02-21T19:46:30Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10643", "html_url": "https://github.com/near/nearcore/pull/10643", "diff_url": "https://github.com/near/nearcore/pull/10643.diff", "patch_url": "https://github.com/near/nearcore/pull/10643.patch", "merged_at": "2024-02-21T19:46:30Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10643/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10643/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10638", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10638/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10638/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10638/events", "html_url": "https://github.com/near/nearcore/pull/10638", "id": 2146087457, "node_id": "PR_kwDOCQUkYs5nfLDr", "number": 10638, "title": "hardcode target cpu for clusterfuzz targets", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-21T08:17:07Z", "updated_at": "2024-02-21T12:01:14Z", "closed_at": "2024-02-21T12:01:13Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10638", "html_url": "https://github.com/near/nearcore/pull/10638", "diff_url": "https://github.com/near/nearcore/pull/10638.diff", "patch_url": "https://github.com/near/nearcore/pull/10638.patch", "merged_at": "2024-02-21T12:01:13Z"}, "body": "This should hopefully counter the issue that our fuzzers are currently facing, and that stem from -C target-cpu=native in bolero code: https://github.com/camshaft/bolero/blob/a9dc98616435c85daca4b1612eb4b014c757d7db/bin/cargo-bolero/src/project.rs#L143", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10638/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10638/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10636", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10636/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10636/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10636/events", "html_url": "https://github.com/near/nearcore/pull/10636", "id": 2145848897, "node_id": "PR_kwDOCQUkYs5neW_u", "number": 10636, "title": "[Snyk] Upgrade react-router from 6.21.1 to 6.21.3", "user": {"login": "ecp88", "id": 109925246, "node_id": "U_kgDOBo1Tfg", "avatar_url": "https://avatars.githubusercontent.com/u/109925246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecp88", "html_url": "https://github.com/ecp88", "followers_url": "https://api.github.com/users/ecp88/followers", "following_url": "https://api.github.com/users/ecp88/following{/other_user}", "gists_url": "https://api.github.com/users/ecp88/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecp88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecp88/subscriptions", "organizations_url": "https://api.github.com/users/ecp88/orgs", "repos_url": "https://api.github.com/users/ecp88/repos", "events_url": "https://api.github.com/users/ecp88/events{/privacy}", "received_events_url": "https://api.github.com/users/ecp88/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-21T05:07:57Z", "updated_at": "2024-02-21T10:33:13Z", "closed_at": "2024-02-21T10:33:12Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10636", "html_url": "https://github.com/near/nearcore/pull/10636", "diff_url": "https://github.com/near/nearcore/pull/10636.diff", "patch_url": "https://github.com/near/nearcore/pull/10636.patch", "merged_at": "2024-02-21T10:33:12Z"}, "body": "<p>This PR was automatically created by Snyk using the credentials of a real user.</p><br /><h3>Snyk has created this PR to upgrade react-router from 6.21.1 to 6.21.3.</h3>\n\n:information_source: Keep your dependencies up-to-date. This makes it easier to fix existing vulnerabilities and to more quickly identify and fix newly disclosed vulnerabilities when they affect your project.\n<hr/>\n\n- The recommended version is **4 versions** ahead of your current version.\n- The recommended version was released **a month ago**, on 2024-01-18.\n\n\n<details>\n<summary><b>Release notes</b></summary>\n<br/>\n  <details>\n    <summary>Package name: <b>react-router</b></summary>\n    <ul>\n      <li>\n        <b>6.21.3</b> - <a href=\"https://snyk.io/redirect/github/remix-run/react-router/releases/tag/react-router-native%406.21.3\">2024-01-18</a></br><p>react-router-native@6.21.3</p>\n      </li>\n      <li>\n        <b>6.21.3-pre.0</b> - <a href=\"https://snyk.io/redirect/github/remix-run/react-router/releases/tag/react-router-native%406.21.3-pre.0\">2024-01-16</a></br><p>react-router-native@6.21.3-pre.0</p>\n      </li>\n      <li>\n        <b>6.21.2</b> - 2024-01-11\n      </li>\n      <li>\n        <b>6.21.2-pre.0</b> - 2024-01-09\n      </li>\n      <li>\n        <b>6.21.1</b> - 2023-12-21\n      </li>\n    </ul>\n    from <a href=\"https://snyk.io/redirect/github/remix-run/react-router/releases\">react-router GitHub release notes</a>\n  </details>\n</details>\n\n\n<details>\n  <summary><b>Commit messages</b></summary>\n  </br>\n  <details>\n    <summary>Package name: <b>react-router</b></summary>\n    <ul>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/44b391ad27dacc07bb1298bd79315c00845d5a2c\">44b391a</a> chore: Update version for release (#11203)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/82c48435350d239b376e435e8693ea51296c5848\">82c4843</a> Exit prerelease mode</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/1551285c2e821994d01b0a86cd2839c63898dabc\">1551285</a> Change release date</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/8fc701a910788d69c358565c974665384ca462fb\">8fc701a</a> Prep release notes</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/b4bf9271bc3e2a5a1fec73485392563cf3c8a7e2\">b4bf927</a> chore: Update version for release (pre) (#11196)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/84e5fb9f6df09e8324e43541d2ab660c383a025e\">84e5fb9</a> Enter prerelease mode</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/858f6f125d4dad94483f87fdfb8cc23cbbe68d59\">858f6f1</a> Merge branch &#x27;main&#x27; into release-next</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/b541b8dd5a582b1e95a2fd0111eeac2ab92f738b\">b541b8d</a> Fix NavLink isPending with a basename (#11195)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/552662ab867fd09e865adb33bb6631207a16ca53\">552662a</a> Remove leftover &#x60;unstable_&#x60; prefix from &#x60;Blocker&#x60;/&#x60;BlockerFunction&#x60; types (#11187)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/04d653bcdb5b641485e4b9081fe196cfeac12716\">04d653b</a> Copy remix script to remove prereleases from changelogs (#11183)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/6837a1111a8ae1c60ab665b9ff2d9eb20b2f2f40\">6837a11</a> Fix date in changelog</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/c418410cb8b7277655d51e8ad2756059ad19fbeb\">c418410</a> Merge branch &#x27;release-next&#x27; into dev</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/274027eba64e614442106678c5a0676834202491\">274027e</a> Fix date in changelog</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/6be8e6c57d347c2dd975fa76b5aef6d39fd71d0e\">6be8e6c</a> Merge branch &#x27;release-next&#x27;</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/4e528c0bcee338c8f26d948affb3092257f6ee85\">4e528c0</a> chore: Update version for release (#11182)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/c8742d464d539bfdad452d59b7d5ce55b3628980\">c8742d4</a> Exit prerelease mode</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/f9780210d84257c21f628c31de165e91f3474263\">f978021</a> Prep release notes</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/cfce7e61655b46f7894fa8cadd336a66d58d1a00\">cfce7e6</a> Unbold date</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/038ad94452d81d882f1042395b28b0d80c3b4f40\">038ad94</a> Add dates to prior releases in changelog</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/c2c0826c6e4a9e213b4f43bc4e95d4f85bf2d96e\">c2c0826</a> chore: Update version for release (pre) (#11178)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/5cd3a45d625d947c795bd85aab8026a5e6b29614\">5cd3a45</a> Enter prerelease mode</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/03ce0377f5bed5fca3eb94d875c33eab9414b116\">03ce037</a> Merge branch &#x27;main&#x27; into release-next</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/0ef18963d274ea78592479cab9a48be2c5ec3c6a\">0ef1896</a> Do not attempt to deserialize empty json responses (#11164)</li>\n      <li><a href=\"https://snyk.io/redirect/github/remix-run/react-router/commit/e0d106bbe765ef12d3ad31e223127e2d08cab8e1\">e0d106b</a> Leverage useId for internal fetcher keys when available (#11166)</li>\n    </ul>\n\n   <a href=\"https://snyk.io/redirect/github/remix-run/react-router/compare/08cda17f450ebe19481be3fc080d243ec5ef509f...44b391ad27dacc07bb1298bd79315c00845d5a2c\">Compare</a>\n  </details>\n</details>\n<hr/>\n\n**Note:** *You are seeing this because you or someone else with access to this repository has authorized Snyk to open upgrade PRs.*\n\nFor more information:  <img src=\"https://api.segment.io/v1/pixel/track?data=eyJ3cml0ZUtleSI6InJyWmxZcEdHY2RyTHZsb0lYd0dUcVg4WkFRTnNCOUEwIiwiYW5vbnltb3VzSWQiOiI1YjE0ODcwNy0yNzZhLTQ2M2EtOGU0Mi01YTQ2ZGRlOWViNWEiLCJldmVudCI6IlBSIHZpZXdlZCIsInByb3BlcnRpZXMiOnsicHJJZCI6IjViMTQ4NzA3LTI3NmEtNDYzYS04ZTQyLTVhNDZkZGU5ZWI1YSJ9fQ==\" width=\"0\" height=\"0\"/>\n\n\ud83e\uddd0 [View latest project report](https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763?utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;upgrade-pr)\n\n\ud83d\udee0 [Adjust upgrade PR settings](https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763/settings/integration?utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;upgrade-pr)\n\n\ud83d\udd15 [Ignore this dependency or unsubscribe from future upgrade PRs](https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763/settings/integration?pkg&#x3D;react-router&amp;utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;upgrade-pr#auto-dep-upgrades)\n\n<!--- (snyk:metadata:{\"prId\":\"5b148707-276a-463a-8e42-5a46dde9eb5a\",\"prPublicId\":\"5b148707-276a-463a-8e42-5a46dde9eb5a\",\"dependencies\":[{\"name\":\"react-router\",\"from\":\"6.21.1\",\"to\":\"6.21.3\"}],\"packageManager\":\"npm\",\"type\":\"auto\",\"projectUrl\":\"https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763?utm_source=github&utm_medium=referral&page=upgrade-pr\",\"projectPublicId\":\"98480bdc-d80b-4fd1-89d7-c4c56a706763\",\"env\":\"prod\",\"prType\":\"upgrade\",\"vulns\":[],\"issuesToFix\":[],\"upgrade\":[],\"upgradeInfo\":{\"versionsDiff\":4,\"publishedDate\":\"2024-01-18T19:49:25.374Z\"},\"templateVariants\":[],\"hasFixes\":false,\"isMajorUpgrade\":false,\"isBreakingChange\":false,\"priorityScoreList\":[]}) --->\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10636/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10636/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10635", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10635/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10635/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10635/events", "html_url": "https://github.com/near/nearcore/pull/10635", "id": 2145848783, "node_id": "PR_kwDOCQUkYs5neW-F", "number": 10635, "title": "[Snyk] Upgrade @types/node from 16.18.64 to 16.18.77", "user": {"login": "ecp88", "id": 109925246, "node_id": "U_kgDOBo1Tfg", "avatar_url": "https://avatars.githubusercontent.com/u/109925246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecp88", "html_url": "https://github.com/ecp88", "followers_url": "https://api.github.com/users/ecp88/followers", "following_url": "https://api.github.com/users/ecp88/following{/other_user}", "gists_url": "https://api.github.com/users/ecp88/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecp88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecp88/subscriptions", "organizations_url": "https://api.github.com/users/ecp88/orgs", "repos_url": "https://api.github.com/users/ecp88/repos", "events_url": "https://api.github.com/users/ecp88/events{/privacy}", "received_events_url": "https://api.github.com/users/ecp88/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-21T05:07:53Z", "updated_at": "2024-02-21T19:52:47Z", "closed_at": "2024-02-21T19:52:46Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10635", "html_url": "https://github.com/near/nearcore/pull/10635", "diff_url": "https://github.com/near/nearcore/pull/10635.diff", "patch_url": "https://github.com/near/nearcore/pull/10635.patch", "merged_at": "2024-02-21T19:52:46Z"}, "body": "<p>This PR was automatically created by Snyk using the credentials of a real user.</p><br /><h3>Snyk has created this PR to upgrade @types/node from 16.18.64 to 16.18.77.</h3>\n\n:information_source: Keep your dependencies up-to-date. This makes it easier to fix existing vulnerabilities and to more quickly identify and fix newly disclosed vulnerabilities when they affect your project.\n<hr/>\n\n- The recommended version is **13 versions** ahead of your current version.\n- The recommended version was released **21 days ago**, on 2024-01-30.\n\n\n<details>\n<summary><b>Release notes</b></summary>\n<br/>\n  <details>\n    <summary>Package name: <b>@types/node</b></summary>\n    <ul>\n      <li>\n        <b>16.18.77</b> - 2024-01-30\n      </li>\n      <li>\n        <b>16.18.76</b> - 2024-01-26\n      </li>\n      <li>\n        <b>16.18.75</b> - 2024-01-24\n      </li>\n      <li>\n        <b>16.18.74</b> - 2024-01-21\n      </li>\n      <li>\n        <b>16.18.73</b> - 2024-01-19\n      </li>\n      <li>\n        <b>16.18.72</b> - 2024-01-19\n      </li>\n      <li>\n        <b>16.18.71</b> - 2024-01-15\n      </li>\n      <li>\n        <b>16.18.70</b> - 2024-01-07\n      </li>\n      <li>\n        <b>16.18.69</b> - 2023-12-30\n      </li>\n      <li>\n        <b>16.18.68</b> - 2023-12-07\n      </li>\n      <li>\n        <b>16.18.67</b> - 2023-12-03\n      </li>\n      <li>\n        <b>16.18.66</b> - 2023-11-29\n      </li>\n      <li>\n        <b>16.18.65</b> - 2023-11-23\n      </li>\n      <li>\n        <b>16.18.64</b> - 2023-11-22\n      </li>\n    </ul>\n    from <a href=\"https://snyk.io/redirect/github/DefinitelyTyped/DefinitelyTyped/releases\">@types/node GitHub release notes</a>\n  </details>\n</details>\n<hr/>\n\n**Note:** *You are seeing this because you or someone else with access to this repository has authorized Snyk to open upgrade PRs.*\n\nFor more information:  <img src=\"https://api.segment.io/v1/pixel/track?data=eyJ3cml0ZUtleSI6InJyWmxZcEdHY2RyTHZsb0lYd0dUcVg4WkFRTnNCOUEwIiwiYW5vbnltb3VzSWQiOiJkMmNiMDYwMy04MDM0LTQwOTAtYjliOS0wNGVmMjE3NWVkNDEiLCJldmVudCI6IlBSIHZpZXdlZCIsInByb3BlcnRpZXMiOnsicHJJZCI6ImQyY2IwNjAzLTgwMzQtNDA5MC1iOWI5LTA0ZWYyMTc1ZWQ0MSJ9fQ==\" width=\"0\" height=\"0\"/>\n\n\ud83e\uddd0 [View latest project report](https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763?utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;upgrade-pr)\n\n\ud83d\udee0 [Adjust upgrade PR settings](https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763/settings/integration?utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;upgrade-pr)\n\n\ud83d\udd15 [Ignore this dependency or unsubscribe from future upgrade PRs](https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763/settings/integration?pkg&#x3D;@types/node&amp;utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;upgrade-pr#auto-dep-upgrades)\n\n<!--- (snyk:metadata:{\"prId\":\"d2cb0603-8034-4090-b9b9-04ef2175ed41\",\"prPublicId\":\"d2cb0603-8034-4090-b9b9-04ef2175ed41\",\"dependencies\":[{\"name\":\"@types/node\",\"from\":\"16.18.64\",\"to\":\"16.18.77\"}],\"packageManager\":\"npm\",\"type\":\"auto\",\"projectUrl\":\"https://app.snyk.io/org/ecp88/project/98480bdc-d80b-4fd1-89d7-c4c56a706763?utm_source=github&utm_medium=referral&page=upgrade-pr\",\"projectPublicId\":\"98480bdc-d80b-4fd1-89d7-c4c56a706763\",\"env\":\"prod\",\"prType\":\"upgrade\",\"vulns\":[],\"issuesToFix\":[],\"upgrade\":[],\"upgradeInfo\":{\"versionsDiff\":13,\"publishedDate\":\"2024-01-30T22:07:41.250Z\"},\"templateVariants\":[],\"hasFixes\":false,\"isMajorUpgrade\":false,\"isBreakingChange\":false,\"priorityScoreList\":[]}) --->\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10635/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10635/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10633", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10633/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10633/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10633/events", "html_url": "https://github.com/near/nearcore/pull/10633", "id": 2144341023, "node_id": "PR_kwDOCQUkYs5nZKhp", "number": 10633, "title": "fix: properly handle genesis as part of stateless validation", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-02-20T13:06:29Z", "updated_at": "2024-02-27T11:24:49Z", "closed_at": "2024-02-23T15:03:55Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10633", "html_url": "https://github.com/near/nearcore/pull/10633", "diff_url": "https://github.com/near/nearcore/pull/10633.diff", "patch_url": "https://github.com/near/nearcore/pull/10633.patch", "merged_at": "2024-02-23T15:03:55Z"}, "body": "This PR removes \"approve anything\" shortcut when previous chunk is part of genesis. The only difference in case of genesis is that we don't want to execute main state transition and instead just check that post state root matches genesis state root for that shard.\r\n\r\nThis also exposed some issue I had to fix to make tests work:\r\n* `MockEpochManager::get_epoch_chunk_producers` returns empty Vec which results in `Chain:: should_produce_state_witness_for_this_or_next_epoch` returning `false`. Fixed by adding `is_chunk_producer_for_epoch` as part of `EpochManagerAdapter` so `MockEpochManager` can override it.\r\n* `test_chunk_state_witness_bad_shard_id` test started failing: this actually uncovered a real issue which could result in crashing chunk validator when state witness contains invalid shard id, fixed in c5b2c5e1ea5bf470ceb26fb9681d293765bf5362\r\n\r\nCloses #10502.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10633/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10633/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10632", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10632/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10632/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10632/events", "html_url": "https://github.com/near/nearcore/pull/10632", "id": 2144296633, "node_id": "PR_kwDOCQUkYs5nZAwo", "number": 10632, "title": "fix(state-sync): Track headers in state dump monitoring tool", "user": {"login": "VanBarbascu", "id": 8384611, "node_id": "MDQ6VXNlcjgzODQ2MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/8384611?v=4", "gravatar_id": "", "url": "https://api.github.com/users/VanBarbascu", "html_url": "https://github.com/VanBarbascu", "followers_url": "https://api.github.com/users/VanBarbascu/followers", "following_url": "https://api.github.com/users/VanBarbascu/following{/other_user}", "gists_url": "https://api.github.com/users/VanBarbascu/gists{/gist_id}", "starred_url": "https://api.github.com/users/VanBarbascu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/VanBarbascu/subscriptions", "organizations_url": "https://api.github.com/users/VanBarbascu/orgs", "repos_url": "https://api.github.com/users/VanBarbascu/repos", "events_url": "https://api.github.com/users/VanBarbascu/events{/privacy}", "received_events_url": "https://api.github.com/users/VanBarbascu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 5, "created_at": "2024-02-20T12:43:58Z", "updated_at": "2024-02-28T17:28:54Z", "closed_at": "2024-02-28T17:28:53Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10632", "html_url": "https://github.com/near/nearcore/pull/10632", "diff_url": "https://github.com/near/nearcore/pull/10632.diff", "patch_url": "https://github.com/near/nearcore/pull/10632.patch", "merged_at": "2024-02-28T17:28:53Z"}, "body": "Count the number of headers uploaded in the tracked external folder. Report the state through the exported metrics.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10632/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10632/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10631", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10631/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10631/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10631/events", "html_url": "https://github.com/near/nearcore/pull/10631", "id": 2142958369, "node_id": "PR_kwDOCQUkYs5nUeAk", "number": 10631, "title": "ignore warnings when building fuzzers", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-19T18:39:57Z", "updated_at": "2024-02-20T11:13:56Z", "closed_at": "2024-02-20T11:13:55Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10631", "html_url": "https://github.com/near/nearcore/pull/10631", "diff_url": "https://github.com/near/nearcore/pull/10631.diff", "patch_url": "https://github.com/near/nearcore/pull/10631.patch", "merged_at": "2024-02-20T11:13:55Z"}, "body": "Apparently https://github.com/near/nearcore/pull/10630 was not actually enough to disable builds, as cargo does not seem to support this syntax. Instead, just remove the explicit warnings=deny setting when building fuzzers", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10631/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10631/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10630", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10630/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10630/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10630/events", "html_url": "https://github.com/near/nearcore/pull/10630", "id": 2142865115, "node_id": "PR_kwDOCQUkYs5nUJ5L", "number": 10630, "title": "Fix fuzzer builds", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-19T17:29:39Z", "updated_at": "2024-02-19T18:08:02Z", "closed_at": "2024-02-19T18:08:01Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10630", "html_url": "https://github.com/near/nearcore/pull/10630", "diff_url": "https://github.com/near/nearcore/pull/10630.diff", "patch_url": "https://github.com/near/nearcore/pull/10630.patch", "merged_at": "2024-02-19T18:08:01Z"}, "body": null, "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10630/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10630/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10629", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10629/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10629/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10629/events", "html_url": "https://github.com/near/nearcore/pull/10629", "id": 2142576396, "node_id": "PR_kwDOCQUkYs5nTKut", "number": 10629, "title": "docs: add a page on applied tracing", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-19T15:03:54Z", "updated_at": "2024-02-20T15:11:33Z", "closed_at": "2024-02-20T15:11:33Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10629", "html_url": "https://github.com/near/nearcore/pull/10629", "diff_url": "https://github.com/near/nearcore/pull/10629.diff", "patch_url": "https://github.com/near/nearcore/pull/10629.patch", "merged_at": "2024-02-20T15:11:32Z"}, "body": "I went ahead and wrote a brief page on how to apply tracing in practice more effectively than just for plain stdout logs. Hopefully it inspires others to utilize this tool more readily as well.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10629/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10629/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10628", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10628/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10628/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10628/events", "html_url": "https://github.com/near/nearcore/pull/10628", "id": 2142499506, "node_id": "PR_kwDOCQUkYs5nS5zN", "number": 10628, "title": "Missing parentheses around url for wget for mocknet", "user": {"login": "staffik", "id": 18039094, "node_id": "MDQ6VXNlcjE4MDM5MDk0", "avatar_url": "https://avatars.githubusercontent.com/u/18039094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/staffik", "html_url": "https://github.com/staffik", "followers_url": "https://api.github.com/users/staffik/followers", "following_url": "https://api.github.com/users/staffik/following{/other_user}", "gists_url": "https://api.github.com/users/staffik/gists{/gist_id}", "starred_url": "https://api.github.com/users/staffik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/staffik/subscriptions", "organizations_url": "https://api.github.com/users/staffik/orgs", "repos_url": "https://api.github.com/users/staffik/repos", "events_url": "https://api.github.com/users/staffik/events{/privacy}", "received_events_url": "https://api.github.com/users/staffik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-19T14:28:42Z", "updated_at": "2024-02-20T19:44:39Z", "closed_at": "2024-02-20T19:44:38Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10628", "html_url": "https://github.com/near/nearcore/pull/10628", "diff_url": "https://github.com/near/nearcore/pull/10628.diff", "patch_url": "https://github.com/near/nearcore/pull/10628.patch", "merged_at": "2024-02-20T19:44:38Z"}, "body": "Setting up adversenet failed when I used a neard binary url with `&` sign.\r\nIt worked so far with `s3` urls as they did not have ampersand.\r\n\r\nRelated PR: https://github.com/near/near-ops/pull/1579", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10628/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10628/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10627", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10627/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10627/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10627/events", "html_url": "https://github.com/near/nearcore/pull/10627", "id": 2139282127, "node_id": "PR_kwDOCQUkYs5nH68h", "number": 10627, "title": "[TestLoop refactoring] (2/n) Use Sender framework for the network stack and jsonrpc stack", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-16T19:24:38Z", "updated_at": "2024-02-21T21:57:39Z", "closed_at": "2024-02-21T21:57:38Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10627", "html_url": "https://github.com/near/nearcore/pull/10627", "diff_url": "https://github.com/near/nearcore/pull/10627.diff", "patch_url": "https://github.com/near/nearcore/pull/10627.patch", "merged_at": "2024-02-21T21:57:38Z"}, "body": "Quite a large change. Here's the idea:\r\n\r\n* Introduce `ClientSenderForNetwork` and `ClientSenderForRpc`, which are multisenders. `ClientSenderForNetwork` is used by the network layer to send messages to the client, and `ClientSenderForRpc` is used by the jsonrpc layer to send messages to the client. These layers no longer require a `Addr<ClientActor>` or `Addr<ViewClientActor>` to construct.\r\n* The rest of the changes are just whatever that is necessary to make this work:\r\n  * There is no longer a trait abstraction (`near_network::client::Client`) for the network to call the client. This trait abstraction is nice, but it introduces an additional indirection to make things confusing, and is also arbitrarily designed (there's non-uniform data transformation for the requests and responses), and not consistent with the rest of the codebase. Instead, usages of this trait are replaced with direct calls to the `ClientSenderForNetwork` multisender.\r\n  * That means that the struct being sent from the network layer to the client is now a part of the `ClientSenderForNetwork` interface, meaning that I have moved these structs into the near_network crate. This is not ideal because these structs are annotated with actix response types, making them somewhat \"actix dependent\". It could be avoided by introducing intermediate structs but that is a bit of an overkill. Instead, I just make each sender in `ClientSenderForNetwork` an `AsyncSender<M, ActixResult<M>>`; it's convenient (coz we don't need to specify the return result) and guaranteed to work with the actix side. In the future if we are to get rid of actix, we just replace this with the spelling of the real type.\r\n  * Another implementation of the old `near_network::client::Client` is `FakeClient`. This is quite annoying because for two messages it responds with a sane response, but for other messages it wraps them and sends them into a `Sink`. Now, `Sink` is another abstraction that basically has the same semantics as `Sender` so I've replaced all usages of it with `Sender`, removed the entire `FakeClient`, and moved the custom behavior of handling those two messages into `peer_manager/testonly.rs`. Also, the events that were sent to the sink do not appear to be used, I'm not sure what's going with that, perhaps it was a refactoring that was half done before.\r\n  * On the jsonrpc side, all the errors had to be convertible to some kind of RpcError, and it used to be that we convert actix's `MailboxError` to each type of RpcError, but now that we're not relying on actix, we instead convert `AsyncSendError`. The semantics are the same in the end.\r\n  * Finally, there's an event_sink in the `config.rs`'s `NetworkConfig` struct. This was only used for testing to collect various events, but these events are written to the sink in various places in the networking code and some of them are not efficient because they require additional cloning. Previously, the way it was handled was that the Sink had an extra feature of sending something \"lazily\" (by calling it with a closure) so that if the sink was an noop-sink, the closure is not called at all, thereby avoiding expensive computation in the production code path. Now, `Sender` does not have such functionality (and adding such functionality would add extra complexity) and it's not even clear how to define lazy sending, so instead, I've guarded the whole `event_sink` and all usages with `#[cfg(test)]`. Again, these do not seem to be used today.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10627/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10627/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10626", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10626/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10626/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10626/events", "html_url": "https://github.com/near/nearcore/pull/10626", "id": 2139136656, "node_id": "PR_kwDOCQUkYs5nHaSg", "number": 10626, "title": "fix(mirror): fix skipped account creations in the fifth block", "user": {"login": "marcelo-gonzalez", "id": 37846884, "node_id": "MDQ6VXNlcjM3ODQ2ODg0", "avatar_url": "https://avatars.githubusercontent.com/u/37846884?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcelo-gonzalez", "html_url": "https://github.com/marcelo-gonzalez", "followers_url": "https://api.github.com/users/marcelo-gonzalez/followers", "following_url": "https://api.github.com/users/marcelo-gonzalez/following{/other_user}", "gists_url": "https://api.github.com/users/marcelo-gonzalez/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcelo-gonzalez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcelo-gonzalez/subscriptions", "organizations_url": "https://api.github.com/users/marcelo-gonzalez/orgs", "repos_url": "https://api.github.com/users/marcelo-gonzalez/repos", "events_url": "https://api.github.com/users/marcelo-gonzalez/events{/privacy}", "received_events_url": "https://api.github.com/users/marcelo-gonzalez/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-16T18:04:31Z", "updated_at": "2024-02-23T20:46:48Z", "closed_at": "2024-02-23T20:46:47Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10626", "html_url": "https://github.com/near/nearcore/pull/10626", "diff_url": "https://github.com/near/nearcore/pull/10626.diff", "patch_url": "https://github.com/near/nearcore/pull/10626.patch", "merged_at": "2024-02-23T20:46:47Z"}, "body": "When `mirror run` is run for the first time, we call add_create_account_txs() for each of the first 5 blocks before we start sending transactions because normally this is called on the block that's 5 blocks ahead of the block we're currently preparing transactions for. But there is an off-by-one error here, where we take the first 5 block heights, say [10, 11, 12, 13, 14]. And then on the first call to queue_txs(), `tracker.next_heights()` will return 10 for the next height, and 16 for the height to look for create account receipts, skipping 15. So we need to just add one to the number of blocks we send create account txs for at the start of sending traffic", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10626/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10626/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10624", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10624/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10624/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10624/events", "html_url": "https://github.com/near/nearcore/pull/10624", "id": 2137832714, "node_id": "PR_kwDOCQUkYs5nC7fI", "number": 10624, "title": "[Snyk] Security upgrade nginx from 1.25.3-alpine to 1.25.4-alpine", "user": {"login": "ecp88", "id": 109925246, "node_id": "U_kgDOBo1Tfg", "avatar_url": "https://avatars.githubusercontent.com/u/109925246?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ecp88", "html_url": "https://github.com/ecp88", "followers_url": "https://api.github.com/users/ecp88/followers", "following_url": "https://api.github.com/users/ecp88/following{/other_user}", "gists_url": "https://api.github.com/users/ecp88/gists{/gist_id}", "starred_url": "https://api.github.com/users/ecp88/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ecp88/subscriptions", "organizations_url": "https://api.github.com/users/ecp88/orgs", "repos_url": "https://api.github.com/users/ecp88/repos", "events_url": "https://api.github.com/users/ecp88/events{/privacy}", "received_events_url": "https://api.github.com/users/ecp88/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-16T04:05:36Z", "updated_at": "2024-02-16T13:46:58Z", "closed_at": "2024-02-16T13:46:57Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10624", "html_url": "https://github.com/near/nearcore/pull/10624", "diff_url": "https://github.com/near/nearcore/pull/10624.diff", "patch_url": "https://github.com/near/nearcore/pull/10624.patch", "merged_at": "2024-02-16T13:46:57Z"}, "body": "<p>This PR was automatically created by Snyk using the credentials of a real user.</p><br />Keeping your Docker base image up-to-date means you\u2019ll benefit from security fixes in the latest version of your chosen image.\n\n#### Changes included in this PR \n\n\n- tools/debug-ui/Dockerfile\n\nWe recommend upgrading to `nginx:1.25.4-alpine`, as this image has only 0 known vulnerabilities. To do this, merge this pull request, then verify your application still works as expected.\n\n\n\nSome of the most important vulnerabilities in your base image include:\n\n| Severity                                                                                                                 | Priority Score / 1000  | Issue                                                                     | Exploit Maturity      |\n| :------:                                                                                                                 | :--------------------  | :----                                                                     | :---------------      |\n| ![high severity](https://res.cloudinary.com/snyk/image/upload/w_20,h_20/v1561977819/icon/h.png \"high severity\")   | **686**  | Resource Exhaustion <br/>[SNYK-ALPINE318-EXPAT-6241039](https://snyk.io/vuln/SNYK-ALPINE318-EXPAT-6241039)   | No Known Exploit   |\n| ![medium severity](https://res.cloudinary.com/snyk/image/upload/w_20,h_20/v1561977819/icon/m.png \"medium severity\")   | **586**  | Improper Restriction of Recursive Entity References in DTDs (&#x27;XML Entity Expansion&#x27;) <br/>[SNYK-ALPINE318-EXPAT-6241040](https://snyk.io/vuln/SNYK-ALPINE318-EXPAT-6241040)   | No Known Exploit   |\n| ![high severity](https://res.cloudinary.com/snyk/image/upload/w_20,h_20/v1561977819/icon/h.png \"high severity\")   | **686**  | Use After Free <br/>[SNYK-ALPINE318-LIBXML2-6245694](https://snyk.io/vuln/SNYK-ALPINE318-LIBXML2-6245694)   | No Known Exploit   |\n\n\n\n---\n\n**Note:** _You are seeing this because you or someone else with access to this repository has authorized Snyk to open fix PRs._\n\nFor more information: <img src=\"https://api.segment.io/v1/pixel/track?data=eyJ3cml0ZUtleSI6InJyWmxZcEdHY2RyTHZsb0lYd0dUcVg4WkFRTnNCOUEwIiwiYW5vbnltb3VzSWQiOiIyMzE3NTU0OS1iNTk4LTQ1YjYtODBjMy1hMmMwZmUwMTdiMDUiLCJldmVudCI6IlBSIHZpZXdlZCIsInByb3BlcnRpZXMiOnsicHJJZCI6IjIzMTc1NTQ5LWI1OTgtNDViNi04MGMzLWEyYzBmZTAxN2IwNSJ9fQ==\" width=\"0\" height=\"0\"/>\n\ud83e\uddd0 [View latest project report](https://app.snyk.io/org/ecp88/project/a889bd26-862d-4e1f-bdd8-efb16b6d8cca?utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;fix-pr)\n\n\ud83d\udee0 [Adjust project settings](https://app.snyk.io/org/ecp88/project/a889bd26-862d-4e1f-bdd8-efb16b6d8cca?utm_source&#x3D;github&amp;utm_medium&#x3D;referral&amp;page&#x3D;fix-pr/settings)\n\n[//]: # 'snyk:metadata:{\"prId\":\"23175549-b598-45b6-80c3-a2c0fe017b05\",\"prPublicId\":\"23175549-b598-45b6-80c3-a2c0fe017b05\",\"dependencies\":[{\"name\":\"nginx\",\"from\":\"1.25.3-alpine\",\"to\":\"1.25.4-alpine\"}],\"packageManager\":\"dockerfile\",\"projectPublicId\":\"a889bd26-862d-4e1f-bdd8-efb16b6d8cca\",\"projectUrl\":\"https://app.snyk.io/org/ecp88/project/a889bd26-862d-4e1f-bdd8-efb16b6d8cca?utm_source=github&utm_medium=referral&page=fix-pr\",\"type\":\"auto\",\"patch\":[],\"vulns\":[\"SNYK-ALPINE318-EXPAT-6241039\",\"SNYK-ALPINE318-LIBXML2-6245694\",\"SNYK-ALPINE318-EXPAT-6241040\"],\"upgrade\":[\"SNYK-ALPINE318-EXPAT-6241039\",\"SNYK-ALPINE318-EXPAT-6241040\",\"SNYK-ALPINE318-LIBXML2-6245694\"],\"isBreakingChange\":false,\"env\":\"prod\",\"prType\":\"fix\",\"templateVariants\":[\"updated-fix-title\",\"priorityScore\"],\"priorityScoreList\":[686,686,586],\"remediationStrategy\":\"vuln\"}'\n\n---\n\n**Learn how to fix vulnerabilities with free interactive lessons:**\n\n \ud83e\udd89 [Resource Exhaustion](https://learn.snyk.io/lesson/redos/?loc&#x3D;fix-pr)\n \ud83e\udd89 [Use After Free](https://learn.snyk.io/lesson/use-after-free/?loc&#x3D;fix-pr)\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10624/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10624/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10622", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10622/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10622/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10622/events", "html_url": "https://github.com/near/nearcore/pull/10622", "id": 2137082439, "node_id": "PR_kwDOCQUkYs5nAakf", "number": 10622, "title": "Print error description in InvalidChunkStateWitness error", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-15T17:33:33Z", "updated_at": "2024-02-16T17:23:54Z", "closed_at": "2024-02-16T17:23:54Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10622", "html_url": "https://github.com/near/nearcore/pull/10622", "diff_url": "https://github.com/near/nearcore/pull/10622.diff", "patch_url": "https://github.com/near/nearcore/pull/10622.patch", "merged_at": "2024-02-16T17:23:54Z"}, "body": "This error variant contains a String with additional description, but it isn't printed when the error is displayed.\r\nLet's print the description to make errors clearer, it'll make debugging things easier.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10622/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10622/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10621", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10621/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10621/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10621/events", "html_url": "https://github.com/near/nearcore/pull/10621", "id": 2137068675, "node_id": "PR_kwDOCQUkYs5nAXrI", "number": 10621, "title": "fix: don't panic when a Client receives ChunkStateWitness with invalid shard_id", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-15T17:25:08Z", "updated_at": "2024-02-21T20:02:52Z", "closed_at": "2024-02-21T20:02:52Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10621", "html_url": "https://github.com/near/nearcore/pull/10621", "diff_url": "https://github.com/near/nearcore/pull/10621.diff", "patch_url": "https://github.com/near/nearcore/pull/10621.patch", "merged_at": "2024-02-21T20:02:52Z"}, "body": "When Client start processing a new `ChunkStateWitness` which it received, it immediately fetches the previous block and the previous chunk using `prev_block_hash` and `shard_id` provided by the `ChunkStateWitness`.\r\nIt turns out that the current implementation of `Chain::get_prev_chunk_header` will panic if it's given an invalid `shard_id`, which means that a malicious peer could send  a `ChunkStateWitness` with a bad `shard_id` and it would crash the node that received it.\r\n\r\nhttps://github.com/near/nearcore/blob/c5c84adbadf54957083a33ec243cb334b411daee/chain/client/src/stateless_validation/chunk_validator.rs#L596-L607\r\n\r\n`Chain::get_prev_chunk_header` is very deceptive, it returns a `Result`, but still does an `unwrap()` inside. Let's fix the problem by removing the `unwrap()`. From now on `Chain::get_prev_chunk_header` will return a error when it encounters an invalid `shard_id`.\r\n\r\nA test is added to ensure that this bug doesn't happen again. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10621/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10621/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10620", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10620/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10620/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10620/events", "html_url": "https://github.com/near/nearcore/pull/10620", "id": 2137019042, "node_id": "PR_kwDOCQUkYs5nANKz", "number": 10620, "title": "estimator: write up some instructions for running its icount mode", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-15T16:58:13Z", "updated_at": "2024-02-19T13:28:48Z", "closed_at": "2024-02-19T13:28:47Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10620", "html_url": "https://github.com/near/nearcore/pull/10620", "diff_url": "https://github.com/near/nearcore/pull/10620.diff", "patch_url": "https://github.com/near/nearcore/pull/10620.patch", "merged_at": "2024-02-19T13:28:47Z"}, "body": "I wrote some instructions up. Best reviewed commit-by-commit.\r\n\r\nTurns out I lost a bunch of time on the `--profile` stuff \u2013 I was compiling the estimator in `dev-release` mode (cause `release` just takes three decades and change per iteration) and then running the estimator from the `target/release` directory. :facepalm: ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10620/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10620/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10619", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10619/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10619/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10619/events", "html_url": "https://github.com/near/nearcore/pull/10619", "id": 2136938169, "node_id": "PR_kwDOCQUkYs5m_74r", "number": 10619, "title": "fix(mirror): change the default extra key when running with a key mapping secret", "user": {"login": "marcelo-gonzalez", "id": 37846884, "node_id": "MDQ6VXNlcjM3ODQ2ODg0", "avatar_url": "https://avatars.githubusercontent.com/u/37846884?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marcelo-gonzalez", "html_url": "https://github.com/marcelo-gonzalez", "followers_url": "https://api.github.com/users/marcelo-gonzalez/followers", "following_url": "https://api.github.com/users/marcelo-gonzalez/following{/other_user}", "gists_url": "https://api.github.com/users/marcelo-gonzalez/gists{/gist_id}", "starred_url": "https://api.github.com/users/marcelo-gonzalez/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marcelo-gonzalez/subscriptions", "organizations_url": "https://api.github.com/users/marcelo-gonzalez/orgs", "repos_url": "https://api.github.com/users/marcelo-gonzalez/repos", "events_url": "https://api.github.com/users/marcelo-gonzalez/events{/privacy}", "received_events_url": "https://api.github.com/users/marcelo-gonzalez/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-15T16:18:16Z", "updated_at": "2024-02-23T20:06:37Z", "closed_at": "2024-02-23T20:06:36Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10619", "html_url": "https://github.com/near/nearcore/pull/10619", "diff_url": "https://github.com/near/nearcore/pull/10619.diff", "patch_url": "https://github.com/near/nearcore/pull/10619.patch", "merged_at": "2024-02-23T20:06:36Z"}, "body": "When records are prepared for a forked network to work with the mirror tool, there is an option to include a secret that will be used to map keys so that only someone with the secret can generate the keys in the forked chain. There is also a default key that is added to any account that doesn't have a full access key in the source chain so that we can send transactions on its behalf in the forked chain. But there was an oversight where this default extra key is not mixed with the secret, which means that anyone can control any account that doesn't have any full access key in the source chain. So fix it by mapping the key with the secret, and leaving it as-is when there's no secret, which should be backward compatible with old setups with no secret.\r\n\r\nThis hasn't been an issue, but the records prepared for the statelessnet program were prepared with a secret so that only the test operator can control the accounts coming from mainnet, and these accounts were therefore exposed on statelessnet. They have since all been updated manually to use the default key defined in this PR", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10619/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10619/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10618", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10618/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10618/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10618/events", "html_url": "https://github.com/near/nearcore/pull/10618", "id": 2136844584, "node_id": "PR_kwDOCQUkYs5m_nKa", "number": 10618, "title": "[test] Update block schema for pytest", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-15T15:38:02Z", "updated_at": "2024-02-26T18:06:42Z", "closed_at": "2024-02-26T18:06:41Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10618", "html_url": "https://github.com/near/nearcore/pull/10618", "diff_url": "https://github.com/near/nearcore/pull/10618.diff", "patch_url": "https://github.com/near/nearcore/pull/10618.patch", "merged_at": "2024-02-26T18:06:41Z"}, "body": "Passes a couple of nayduck tests", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10618/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10618/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10617", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10617/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10617/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10617/events", "html_url": "https://github.com/near/nearcore/pull/10617", "id": 2136752293, "node_id": "PR_kwDOCQUkYs5m_S30", "number": 10617, "title": "fix: timeout in skip_epoch pytest", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-15T14:59:40Z", "updated_at": "2024-02-15T16:43:43Z", "closed_at": "2024-02-15T16:43:42Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10617", "html_url": "https://github.com/near/nearcore/pull/10617", "diff_url": "https://github.com/near/nearcore/pull/10617.diff", "patch_url": "https://github.com/near/nearcore/pull/10617.patch", "merged_at": "2024-02-15T16:43:42Z"}, "body": "In some previous PR #9503 epoch length was increased, but timeout wasn't updated proportionally.\r\n8 minutes look more than enough: https://nayduck.near.org/#/test/576088", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10617/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10617/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10614", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10614/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10614/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10614/events", "html_url": "https://github.com/near/nearcore/pull/10614", "id": 2135267653, "node_id": "PR_kwDOCQUkYs5m6Mtj", "number": 10614, "title": "[TestLoop Refactor] (1/n) Overhaul the sender framework.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-14T21:56:48Z", "updated_at": "2024-02-16T08:59:26Z", "closed_at": "2024-02-16T06:50:28Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10614", "html_url": "https://github.com/near/nearcore/pull/10614", "diff_url": "https://github.com/near/nearcore/pull/10614.diff", "patch_url": "https://github.com/near/nearcore/pull/10614.patch", "merged_at": "2024-02-16T06:50:28Z"}, "body": "Previously, we had CanSend and CanSendAsync traits, and corresponding to them, the Sender and AsyncSender wrapper structs. The difference between the two types of senders turns out to be a little tricky to work with, so now there is only one Sender, whereas `AsyncSender<M, R>` is now an alias for `Sender<MessageExpectingResponse<M, R>>`.\r\n\r\nAnother pain point was the ability to combine several senders into one; PeerManagerAdapter is an example; previously we had to use some boilerplate to make it convertible from any object that implements all of its CanSend and CanSendAsync requirements, and then to do such conversion, we used `.into()`, which is quite confusing -- somehow, an `Addr<PeerManagerActor>` can be `.into()`-ed into a `PeerManagerAdapter`. Now, instead of all that, we use proc macros. `PeerManagerAdapter` is annotated with `#[derive(MultiSend, MultiSenderFrom)]`, the former allows PeerManagerAdapter to be used like any of the senders it contains, and the latter allows `Addr<PeerManagerActor>` to be converted to it via `.into_multi_sender()`. This interface is more explicit and doesn't use the confusing `.into()`.\r\n\r\nThere are also some general QoL improvements. The interface on `LateBoundSender` and `noop()` is also improved. Wrapping things into `Arc`s is generally no longer needed now. `Sender::from_fn`/`Sender::from_async_fn` can be used to create a sender (for testing) from an inline function.\r\n\r\nThe rest of the PR is just adapting the existing usages of Sender/AsyncSender to the new API.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10614/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10614/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10613", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10613/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10613/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10613/events", "html_url": "https://github.com/near/nearcore/pull/10613", "id": 2135197970, "node_id": "PR_kwDOCQUkYs5m59cU", "number": 10613, "title": "feat: orphan chunk state witness pool", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 10, "created_at": "2024-02-14T21:01:29Z", "updated_at": "2024-02-27T16:01:47Z", "closed_at": "2024-02-23T21:20:28Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10613", "html_url": "https://github.com/near/nearcore/pull/10613", "diff_url": "https://github.com/near/nearcore/pull/10613.diff", "patch_url": "https://github.com/near/nearcore/pull/10613.patch", "merged_at": "2024-02-23T21:20:28Z"}, "body": "### Description\r\nThis PR adds a pool for orphaned `ChunkStateWitnesses`.\r\nTo process a `ChunkStateWitness` we need the previous block, but sometimes it isn't available immediately. The node might receive a `ChunkStateWitness` before the block that's required to process it. In such cases the witness becomes an \"orphaned chunk state witness\" and it's put in `OrphanChunkStateWitnessPool`, where it waits for the desired block to appear. Once a new block is accepted, we fetch all orphaned witnesses that were waiting for this block from the pool and process them.\r\n\r\n### Design of `OrphanStateWitnessPool`\r\n\r\n`OrphanStateWitnessPool` keeps a cache which maps `shard_id` and `height` to an orphan `ChunkStateWitness` with these parameters:\r\n```rust\r\nwitness_cache: LruCache<(ShardId, BlockHeight), ChunkStateWitness>,\r\n```\r\n\r\nAll `ChunkStateWitnesses` go through basic validation before being put in the orphan cache.\r\n* The signature is checked to make sure that this witness really comes from the right chunk producer that should produce a witness at this height and shard_id.\r\n* Client keeps only witnesses which are within 5 blocks of the current chain head to prevent spam attacks. Without this limitation a single malicious chunk producer could fill the whole cache with their fake witnesses.\r\n* There's also a limitation on witness size to limit the amount of memory consumed by the pool. During StatelessNet loadtests performed by `@staffik` and `@Longarithm` the observed `ChunkStateWitness` sIze was 16-32MB, so a 40MB limit should be alright. This PR only limits the size of orphaned witnesses, limiting the size of non-orphan witnesses is much more tricky, see the discussion in https://github.com/near/nearcore/pull/10615.\r\n\r\nIt's impossible to fully validate an orphaned witness, but this partial validation should be enough to protect against attacks on the orphan pool. \r\n\r\nUnder normal circumstances there should be only a few orphaned witnesses per shard. If the node has fallen behind by more than a few blocks, it has to catch up and its chunk endorsements don't matter.\r\nThe default cache capacity is set to 25 witnesses. With 5 shards it provides capacity for 5 orphaned witnesses on each shard, which should be enough.\r\nAssuming that a single witness can take up 40 MB, the pool will consume at most 1GB at full capacity.\r\n\r\nThe changes are divided into individual commits, they can be reviewed commit-by-commit.\r\n\r\n### Fixes\r\nFixes: https://github.com/near/nearcore/issues/10552\r\nFixes: https://github.com/near/stakewars-iv/issues/15", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10613/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10613/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10612", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10612/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10612/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10612/events", "html_url": "https://github.com/near/nearcore/pull/10612", "id": 2134644349, "node_id": "PR_kwDOCQUkYs5m4Dka", "number": 10612, "title": "refactor: move `chunk_endorsement.rs` to stateless_validation folder", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-14T15:44:48Z", "updated_at": "2024-02-14T18:21:23Z", "closed_at": "2024-02-14T18:21:22Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10612", "html_url": "https://github.com/near/nearcore/pull/10612", "diff_url": "https://github.com/near/nearcore/pull/10612.diff", "patch_url": "https://github.com/near/nearcore/pull/10612.patch", "merged_at": "2024-02-14T18:21:22Z"}, "body": "A follow-up to [this comment](https://github.com/near/nearcore/pull/10599#discussion_r1486439511).", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10612/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10612/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10611", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10611/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10611/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10611/events", "html_url": "https://github.com/near/nearcore/pull/10611", "id": 2134224516, "node_id": "PR_kwDOCQUkYs5m2m6H", "number": 10611, "title": "[resharding] Handle case of restarting node during resharding catchup", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2024-02-14T12:14:43Z", "updated_at": "2024-02-27T05:00:06Z", "closed_at": "2024-02-27T05:00:05Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10611", "html_url": "https://github.com/near/nearcore/pull/10611", "diff_url": "https://github.com/near/nearcore/pull/10611.diff", "patch_url": "https://github.com/near/nearcore/pull/10611.patch", "merged_at": "2024-02-27T05:00:05Z"}, "body": "This PR is a fix for the issue where when we restart a node doing resharding and in the catchup phase.\r\n\r\nHigh level issue: When we restart a node in the epoch when resharding in happening, what happens is we go through the whole state_sync process from the beginning which includes resharding. Once building of the child trie is completed, we then do a catchup, apply the split state to the child tried and delete the split state changes for resharding [here](https://github.com/near/nearcore/blob/e00dcaa72cfed35831b1e72760d21bb8152f1049/chain/chain/src/chain_update.rs#L399).\r\n\r\nZulip thread link: https://near.zulipchat.com/#narrow/stream/308695-pagoda.2Fprivate/topic/Problems.20after.20resharding.20restart/near/421312417\r\n\r\nThis is the implementation of Option 1 in the thread.\r\n\r\nThe key idea here is to not delete the `DBCol::StateChangesForSplitStates` during catchup of individual blocks but rather at the end of the catchup phase. This implies, in case we restart the node in the middle the catchup, we would still have all the split state information in `DBCol::StateChangesForSplitStates` and it wouldn't have been deleted.\r\n\r\nTODO: Testing on mocknet.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10611/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10611/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10608", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10608/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10608/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10608/events", "html_url": "https://github.com/near/nearcore/pull/10608", "id": 2133022898, "node_id": "PR_kwDOCQUkYs5myhqd", "number": 10608, "title": "fix: don't read empty flat storage deltas", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-13T19:47:47Z", "updated_at": "2024-02-22T13:15:47Z", "closed_at": "2024-02-13T20:34:05Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10608", "html_url": "https://github.com/near/nearcore/pull/10608", "diff_url": "https://github.com/near/nearcore/pull/10608.diff", "patch_url": "https://github.com/near/nearcore/pull/10608.patch", "merged_at": "2024-02-13T20:34:05Z"}, "body": "Temporary optimization for cases when there are no state changes for a while and deltas are not removed from storage.\r\nIf we know from metadata that delta is empty, set it to empty without reading it.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10608/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10608/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10607", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10607/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10607/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10607/events", "html_url": "https://github.com/near/nearcore/pull/10607", "id": 2132659795, "node_id": "PR_kwDOCQUkYs5mxTLB", "number": 10607, "title": "estimator: clean up the plugin build code and uncheckout binaries", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-13T16:05:15Z", "updated_at": "2024-02-14T16:05:27Z", "closed_at": "2024-02-14T16:05:26Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10607", "html_url": "https://github.com/near/nearcore/pull/10607", "diff_url": "https://github.com/near/nearcore/pull/10607.diff", "patch_url": "https://github.com/near/nearcore/pull/10607.patch", "merged_at": "2024-02-14T16:05:26Z"}, "body": "The plugin is trivial to build, I don't see a good reason to keep the binaries checked in, especially given that the docker container should be providing the relevant reproducible build environment for the plugin anyhow.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10607/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10607/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10606", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10606/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10606/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10606/events", "html_url": "https://github.com/near/nearcore/pull/10606", "id": 2132468186, "node_id": "PR_kwDOCQUkYs5mwpiQ", "number": 10606, "title": "estimator: bail early if qemu does not work", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-13T14:32:39Z", "updated_at": "2024-02-14T17:17:29Z", "closed_at": "2024-02-14T16:05:26Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10606", "html_url": "https://github.com/near/nearcore/pull/10606", "diff_url": "https://github.com/near/nearcore/pull/10606.diff", "patch_url": "https://github.com/near/nearcore/pull/10606.patch", "merged_at": "2024-02-14T16:05:26Z"}, "body": "Previously the read call might have failed in one of the many different ways. That might have led to some incorrect results, like for example the 0s you get if you run the estimator outside of the qemu with the plugin.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10606/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10606/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10603", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10603/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10603/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10603/events", "html_url": "https://github.com/near/nearcore/pull/10603", "id": 2131355194, "node_id": "PR_kwDOCQUkYs5ms3Q5", "number": 10603, "title": "fix: make test_validate_chunk_extra work with stateless validation", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-13T02:32:22Z", "updated_at": "2024-02-13T11:22:32Z", "closed_at": "2024-02-13T11:22:31Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10603", "html_url": "https://github.com/near/nearcore/pull/10603", "diff_url": "https://github.com/near/nearcore/pull/10603.diff", "patch_url": "https://github.com/near/nearcore/pull/10603.patch", "merged_at": "2024-02-13T11:22:31Z"}, "body": "This test didn't work with stateless validation.\r\nIt manually creates a chunk and blocks containing this chunk, but it didn't set the `chunk_endorsements` field in the blocks, because of which the blocks couldn't be accepted.\r\nLet's fix it by generating the correct chunk endoresment and setting the field in the generated blocks.\r\n\r\nRefs: https://github.com/near/nearcore/issues/10506", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10603/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10603/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10601", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10601/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10601/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10601/events", "html_url": "https://github.com/near/nearcore/pull/10601", "id": 2130240580, "node_id": "PR_kwDOCQUkYs5mpDAv", "number": 10601, "title": "fix: test_chunk_forwarding_optimization with statelessnet_protocol feature", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-12T14:20:01Z", "updated_at": "2024-02-12T14:57:44Z", "closed_at": "2024-02-12T14:57:43Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10601", "html_url": "https://github.com/near/nearcore/pull/10601", "diff_url": "https://github.com/near/nearcore/pull/10601.diff", "patch_url": "https://github.com/near/nearcore/pull/10601.patch", "merged_at": "2024-02-12T14:57:43Z"}, "body": "The main assertion in the integration test `test_chunk_forwarding_optimization` is disabled on `--features nightly`, which is a recent change that was introduced due to single shard tracking in https://github.com/near/nearcore/pull/10582.\r\n\r\nLet's also disable it on `--features statelessnet_protocol`, the reasoning is similar.\r\n\r\nFixes: https://github.com/near/nearcore/issues/10600", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10601/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10601/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10599", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10599/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10599/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10599/events", "html_url": "https://github.com/near/nearcore/pull/10599", "id": 2127884781, "node_id": "PR_kwDOCQUkYs5mhWQl", "number": 10599, "title": "feat: garbage collect StateTransitionData for on block finalization  ", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-09T21:40:54Z", "updated_at": "2024-02-13T17:26:47Z", "closed_at": "2024-02-13T17:26:46Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10599", "html_url": "https://github.com/near/nearcore/pull/10599", "diff_url": "https://github.com/near/nearcore/pull/10599.diff", "patch_url": "https://github.com/near/nearcore/pull/10599.patch", "merged_at": "2024-02-13T17:26:46Z"}, "body": "Currently `StateTransitionData` is a part of regular chain GC process. Unfortunately it still reaches 300GB on mainnet, see #10578.\r\n\r\nThis PR introduces more aggressive garbage collection for `StateTransitionData`. If a chunk is present in a final block then we can safely clean up entries for that shard which correspond to blocks with lower height. \r\n\r\nNote that we still keep `StateTransitionData` as part of epoch-based GC just in case. \r\n\r\nTesting:\r\n* unit testing\r\n* running mainnet rpc node with shadow validation and monitoring data on disk size via `near_rocksdb_live_sst_files_size` and making sure that we still have required entries via `near_shadow_chunk_validation_failed_total`.\r\n<img width=\"750\" alt=\"Screenshot 2024-02-13 at 10 32 15\" src=\"https://github.com/near/nearcore/assets/3171838/e60fea9c-750f-4195-8b8b-63f9a8512c57\">\r\n\r\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10599/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10599/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10598", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10598/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10598/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10598/events", "html_url": "https://github.com/near/nearcore/pull/10598", "id": 2127476675, "node_id": "PR_kwDOCQUkYs5mf-K5", "number": 10598, "title": "[test] Have real epoch_manager as default for tests", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-09T16:29:39Z", "updated_at": "2024-02-12T15:30:34Z", "closed_at": "2024-02-12T15:30:33Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10598", "html_url": "https://github.com/near/nearcore/pull/10598", "diff_url": "https://github.com/near/nearcore/pull/10598.diff", "patch_url": "https://github.com/near/nearcore/pull/10598.patch", "merged_at": "2024-02-12T15:30:33Z"}, "body": "In an effort to kill mock epoch manager, this PR makes the default test environment have real epoch managers.\r\n\r\nAll tests that still do require a mock epoch manager (for whatever reason), can call `builder.mock_epoch_managers()`.\r\n\r\nOver time we would slowly like to get rid of all calls to `mock_epoch_managers()`", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10598/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10598/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10597", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10597/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10597/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10597/events", "html_url": "https://github.com/near/nearcore/pull/10597", "id": 2127290432, "node_id": "PR_kwDOCQUkYs5mfVCP", "number": 10597, "title": "[test] real_epoch_managers doesn't need `genesis.config`", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-09T14:47:23Z", "updated_at": "2024-02-09T19:00:22Z", "closed_at": "2024-02-09T19:00:21Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10597", "html_url": "https://github.com/near/nearcore/pull/10597", "diff_url": "https://github.com/near/nearcore/pull/10597.diff", "patch_url": "https://github.com/near/nearcore/pull/10597.patch", "merged_at": "2024-02-09T19:00:21Z"}, "body": "Buildup PRs\r\n\r\nhttps://github.com/near/nearcore/pull/10590\r\nhttps://github.com/near/nearcore/pull/10591\r\nhttps://github.com/near/nearcore/pull/10594\r\n\r\nNext PR I'll try using the real epoch manager as default and let's see what happens...\r\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10597/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10597/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10596", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10596/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10596/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10596/events", "html_url": "https://github.com/near/nearcore/pull/10596", "id": 2127180360, "node_id": "PR_kwDOCQUkYs5me88_", "number": 10596, "title": "fix: bump statelessnet to 82", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-09T13:41:22Z", "updated_at": "2024-02-09T15:11:09Z", "closed_at": "2024-02-09T15:11:08Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10596", "html_url": "https://github.com/near/nearcore/pull/10596", "diff_url": "https://github.com/near/nearcore/pull/10596.diff", "patch_url": "https://github.com/near/nearcore/pull/10596.patch", "merged_at": "2024-02-09T15:11:08Z"}, "body": "Setting protocol version to use `ProtocolFeature::SingleShardTracking` introduced in https://github.com/near/nearcore/pull/10582.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10596/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10596/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10595", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10595/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10595/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10595/events", "html_url": "https://github.com/near/nearcore/pull/10595", "id": 2127133731, "node_id": "PR_kwDOCQUkYs5meysB", "number": 10595, "title": "fix: adversenet speedups and fixes", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-09T13:14:30Z", "updated_at": "2024-02-10T19:50:47Z", "closed_at": "2024-02-10T19:50:46Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10595", "html_url": "https://github.com/near/nearcore/pull/10595", "diff_url": "https://github.com/near/nearcore/pull/10595.diff", "patch_url": "https://github.com/near/nearcore/pull/10595.patch", "merged_at": "2024-02-10T19:50:46Z"}, "body": "1. It is quite annoying to wait for sequential JSON uploading, especially for many nodes, so I parallelize this.\r\n2. Not sure why neard init script always clears data if there is a specific function for it. Removing it from neard init - now it makes `update` command in adversenet actually working.\r\n3. Removing neard logs on each restart because this file grows extremely quickly.\r\n\r\n@robin-near why each \"Adding account...\" execution takes 5 seconds?", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10595/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10595/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10594", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10594/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10594/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10594/events", "html_url": "https://github.com/near/nearcore/pull/10594", "id": 2127078772, "node_id": "PR_kwDOCQUkYs5memLo", "number": 10594, "title": "[test] TestEnvBuilder takes genesis_config as input", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-09T12:50:26Z", "updated_at": "2024-02-09T13:59:03Z", "closed_at": "2024-02-09T13:59:02Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10594", "html_url": "https://github.com/near/nearcore/pull/10594", "diff_url": "https://github.com/near/nearcore/pull/10594.diff", "patch_url": "https://github.com/near/nearcore/pull/10594.patch", "merged_at": "2024-02-09T13:59:02Z"}, "body": "This schema makes way more sense for the TestEnv::builder() to take the genesis_config instead of chain_genesis.\r\n\r\nNote that real_epoch_manager requires a genesis_config which in a future PR we can directly supply from the test environment builder.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10594/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10594/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10592", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10592/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10592/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10592/events", "html_url": "https://github.com/near/nearcore/pull/10592", "id": 2126367011, "node_id": "PR_kwDOCQUkYs5mcLbR", "number": 10592, "title": "Improve the memtrie integration test to include a state sync base case.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-09T02:24:00Z", "updated_at": "2024-02-15T02:27:54Z", "closed_at": "2024-02-15T02:27:53Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10592", "html_url": "https://github.com/near/nearcore/pull/10592", "diff_url": "https://github.com/near/nearcore/pull/10592.diff", "patch_url": "https://github.com/near/nearcore/pull/10592.patch", "merged_at": "2024-02-15T02:27:53Z"}, "body": "It turns out that even setting up a e2e test case for single-shard tracking is tricky, so this PR does that. It makes a few fixes to the test framework as well as the memtrie test code, so that\r\n - In the track-all-shards + single-shard-tracking case (i.e. single shard tracking is enabled but nodes still track all shards), allow test code a chance to request partial encoded chunks.\r\n - Query account balance from a client that tracks the shard (otherwise we would get trie node missing errors).\r\n - Send txns to every client instead of client 0, because not everyone produces chunks for every shard now.\r\n - Check that every block contains all new chunks, to self-verify that the partial encoded chunk propagation is correct. Also check that the total number of transactions included is correct in the end.\r\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10592/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10592/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10591", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10591/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10591/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10591/events", "html_url": "https://github.com/near/nearcore/pull/10591", "id": 2126105167, "node_id": "PR_kwDOCQUkYs5mbTVz", "number": 10591, "title": "[test] ChainGenesis::new from genesis_config instead of genesis", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-08T21:33:26Z", "updated_at": "2024-02-09T09:04:03Z", "closed_at": "2024-02-09T09:04:03Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10591", "html_url": "https://github.com/near/nearcore/pull/10591", "diff_url": "https://github.com/near/nearcore/pull/10591.diff", "patch_url": "https://github.com/near/nearcore/pull/10591.patch", "merged_at": "2024-02-09T09:04:02Z"}, "body": "ChainGenesis constructor currently takes the whole genesis as input. We might as well just work with the genesis config.\r\n\r\nFurther down the line, this would be helpful to change the test environment to store just the genesis_config instead of chain_genesis.\r\n\r\nFuture plans to only use real epoch manager would benefit as real epoch manager takes genesis_config as input.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10591/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10591/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10590", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10590/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10590/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10590/events", "html_url": "https://github.com/near/nearcore/pull/10590", "id": 2126084786, "node_id": "PR_kwDOCQUkYs5mbOzj", "number": 10590, "title": "[test] Introduce TestEnv::default_builder", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-08T21:18:40Z", "updated_at": "2024-02-09T11:35:34Z", "closed_at": "2024-02-09T11:35:33Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10590", "html_url": "https://github.com/near/nearcore/pull/10590", "diff_url": "https://github.com/near/nearcore/pull/10590.diff", "patch_url": "https://github.com/near/nearcore/pull/10590.patch", "merged_at": "2024-02-09T11:35:33Z"}, "body": "Adding a `default_builder` for TestEnv so that we don't need to always pass chain genesis.\r\n\r\nIn the future we would change this to passing genesis_config instead of chain_genesis.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10590/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10590/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10589", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10589/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10589/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10589/events", "html_url": "https://github.com/near/nearcore/pull/10589", "id": 2126029938, "node_id": "PR_kwDOCQUkYs5mbC6x", "number": 10589, "title": "test: statelessnet ci", "user": {"login": "Longarithm", "id": 8607261, "node_id": "MDQ6VXNlcjg2MDcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/8607261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Longarithm", "html_url": "https://github.com/Longarithm", "followers_url": "https://api.github.com/users/Longarithm/followers", "following_url": "https://api.github.com/users/Longarithm/following{/other_user}", "gists_url": "https://api.github.com/users/Longarithm/gists{/gist_id}", "starred_url": "https://api.github.com/users/Longarithm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Longarithm/subscriptions", "organizations_url": "https://api.github.com/users/Longarithm/orgs", "repos_url": "https://api.github.com/users/Longarithm/repos", "events_url": "https://api.github.com/users/Longarithm/events{/privacy}", "received_events_url": "https://api.github.com/users/Longarithm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-08T20:35:51Z", "updated_at": "2024-02-10T19:42:09Z", "closed_at": "2024-02-10T19:42:08Z", "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10589", "html_url": "https://github.com/near/nearcore/pull/10589", "diff_url": "https://github.com/near/nearcore/pull/10589.diff", "patch_url": "https://github.com/near/nearcore/pull/10589.patch", "merged_at": "2024-02-10T19:42:08Z"}, "body": "Introduce automatic CI checks for latest statelessnet binary used for https://github.com/near/near-one-project-tracking/issues/20. This PR adopts new check automatically.\r\nThe check is not required, in order not to block main development flow.\r\nWanted to make this trigger only on demand, but there is no simple way to do it.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10589/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10589/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10588", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10588/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10588/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10588/events", "html_url": "https://github.com/near/nearcore/pull/10588", "id": 2125412034, "node_id": "PR_kwDOCQUkYs5mY52C", "number": 10588, "title": "[resharding] Fix opening snapshot for split storage nodes", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-08T15:13:34Z", "updated_at": "2024-02-12T12:53:19Z", "closed_at": "2024-02-12T12:53:18Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10588", "html_url": "https://github.com/near/nearcore/pull/10588", "diff_url": "https://github.com/near/nearcore/pull/10588.diff", "patch_url": "https://github.com/near/nearcore/pull/10588.patch", "merged_at": "2024-02-12T12:53:18Z"}, "body": "In testnet we hit an issue during resharding with split storage nodes where they failed to create the snapshot required for resharding. This PR is a fix for this issue.\r\n\r\nLink to zulip thread: https://near.zulipchat.com/#narrow/stream/308695-pagoda.2Fprivate/topic/cutting.201.2E37.2E0/near/420092380\r\n\r\nCreation of snapshot happens via the function call `checkpoint_hot_storage_and_cleanup_columns` which takes a hot_store and creates a snapshot out of it. Later we open the snapshot `opener.open_in_mode(Mode::ReadWriteExisting)`.\r\n\r\nThe function `open_in_mode` -> `ensure_kind` -> `is_valid_kind_archive` was the point of failure. This is evident from the log line\r\n```\r\nFeb 06 14:19:29 testnet-rpc-archive-public-02-asia-east1-b-fc341f59 neard[1753]: 2024-02-06T14:19:29.215599Z ERROR state_snapshot: State snapshot creation failed err=Hot database kind should be RPC but got Some(Hot). Did you forget to set archive on your store opener?\r\n```\r\n\r\nThere are three types of nodes, RPC, legacy archival and split storage nodes.\r\n\r\nThe function call to `get_default_kind` gets us the DbKind for the new snapshot hot storage while opening\r\n\r\nTo get the snapshot storage to open properly, we need to handle the three types of storages. We need to set the value of `archive` appropriately which is passed to the storage opener and ensure we set the correct storage type of the snapshot.\r\n\r\nThe table below talks about the expected values of each of these fields.\r\n\r\n| Node type | Hot storage kind | Required snapshot storage type | archive |\r\n| -- | -- | -- | -- |\r\n| RPC | DbKind::RPC | RPC | false |\r\n| Legacy Archival | DbKind::Archival | Legacy Archival | true |\r\n| Split Storage | DbKind::Hot | RPC | false |\r\n\r\nThe place where our code went wrong with the split storage node was in function call to `is_valid_kind_archive` where the DbKind is Hot for split storage and archive is set as false.\r\n\r\nThe new relaxation in check basically states, if we are creating a snapshot of the hot storage from a split storage node, convert it into a RPC storage.\r\n\r\nTesting: Adhoc testing where I manually set the storage DbKind as Hot and check the fix works.\r\nAdditionally added an integration test that manually sets the DbKind as Hot, Archive and RPC and checks whether resharding happens.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10588/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10588/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10587", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10587/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10587/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10587/events", "html_url": "https://github.com/near/nearcore/pull/10587", "id": 2125384066, "node_id": "PR_kwDOCQUkYs5mYzlu", "number": 10587, "title": "rust: 1.76.0", "user": {"login": "mina86", "id": 32383, "node_id": "MDQ6VXNlcjMyMzgz", "avatar_url": "https://avatars.githubusercontent.com/u/32383?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mina86", "html_url": "https://github.com/mina86", "followers_url": "https://api.github.com/users/mina86/followers", "following_url": "https://api.github.com/users/mina86/following{/other_user}", "gists_url": "https://api.github.com/users/mina86/gists{/gist_id}", "starred_url": "https://api.github.com/users/mina86/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mina86/subscriptions", "organizations_url": "https://api.github.com/users/mina86/orgs", "repos_url": "https://api.github.com/users/mina86/repos", "events_url": "https://api.github.com/users/mina86/events{/privacy}", "received_events_url": "https://api.github.com/users/mina86/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 7, "created_at": "2024-02-08T15:02:44Z", "updated_at": "2024-02-12T14:37:59Z", "closed_at": "2024-02-12T13:19:21Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10587", "html_url": "https://github.com/near/nearcore/pull/10587", "diff_url": "https://github.com/near/nearcore/pull/10587.diff", "patch_url": "https://github.com/near/nearcore/pull/10587.patch", "merged_at": "2024-02-12T13:19:21Z"}, "body": "Release notes: https://blog.rust-lang.org/2024/02/08/Rust-1.76.0.html\r\n\r\nptr::addr_eq immediately jumped at me as replacement for same_db the\r\nmoment I saw it and now it\u2019s finally stabilised.  The rest of the\r\nchanges don\u2019t seem relevant (though admittedly I haven\u2019t really\r\nlooked).\r\n", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10587/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10587/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10586", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10586/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10586/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10586/events", "html_url": "https://github.com/near/nearcore/pull/10586", "id": 2124830836, "node_id": "PR_kwDOCQUkYs5mW4-I", "number": 10586, "title": "[cleanup] Remove references of `setup_client_with_synchronous_shards_manager`", "user": {"login": "shreyan-gupta", "id": 16697830, "node_id": "MDQ6VXNlcjE2Njk3ODMw", "avatar_url": "https://avatars.githubusercontent.com/u/16697830?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shreyan-gupta", "html_url": "https://github.com/shreyan-gupta", "followers_url": "https://api.github.com/users/shreyan-gupta/followers", "following_url": "https://api.github.com/users/shreyan-gupta/following{/other_user}", "gists_url": "https://api.github.com/users/shreyan-gupta/gists{/gist_id}", "starred_url": "https://api.github.com/users/shreyan-gupta/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shreyan-gupta/subscriptions", "organizations_url": "https://api.github.com/users/shreyan-gupta/orgs", "repos_url": "https://api.github.com/users/shreyan-gupta/repos", "events_url": "https://api.github.com/users/shreyan-gupta/events{/privacy}", "received_events_url": "https://api.github.com/users/shreyan-gupta/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-08T10:34:36Z", "updated_at": "2024-02-08T13:35:39Z", "closed_at": "2024-02-08T13:35:38Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10586", "html_url": "https://github.com/near/nearcore/pull/10586", "diff_url": "https://github.com/near/nearcore/pull/10586.diff", "patch_url": "https://github.com/near/nearcore/pull/10586.patch", "merged_at": "2024-02-08T13:35:38Z"}, "body": "Cleanup of tests. One more reference of MockEpochManager and KeyValueRuntime removed! \ud83c\udf89 \r\n\r\nWaiting for PR https://github.com/near/nearcore/pull/10583 to be merged in ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10586/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10586/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10585", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10585/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10585/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10585/events", "html_url": "https://github.com/near/nearcore/pull/10585", "id": 2124015808, "node_id": "PR_kwDOCQUkYs5mUIsG", "number": 10585, "title": "do not count coverage for integration tests", "user": {"login": "Ekleog-NEAR", "id": 96595974, "node_id": "U_kgDOBcHwBg", "avatar_url": "https://avatars.githubusercontent.com/u/96595974?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ekleog-NEAR", "html_url": "https://github.com/Ekleog-NEAR", "followers_url": "https://api.github.com/users/Ekleog-NEAR/followers", "following_url": "https://api.github.com/users/Ekleog-NEAR/following{/other_user}", "gists_url": "https://api.github.com/users/Ekleog-NEAR/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ekleog-NEAR/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ekleog-NEAR/subscriptions", "organizations_url": "https://api.github.com/users/Ekleog-NEAR/orgs", "repos_url": "https://api.github.com/users/Ekleog-NEAR/repos", "events_url": "https://api.github.com/users/Ekleog-NEAR/events{/privacy}", "received_events_url": "https://api.github.com/users/Ekleog-NEAR/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-07T22:36:58Z", "updated_at": "2024-02-08T14:05:14Z", "closed_at": "2024-02-08T11:58:08Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10585", "html_url": "https://github.com/near/nearcore/pull/10585", "diff_url": "https://github.com/near/nearcore/pull/10585.diff", "patch_url": "https://github.com/near/nearcore/pull/10585.patch", "merged_at": "2024-02-08T11:58:08Z"}, "body": "Fixes the issue pointed out in https://github.com/near/nearcore/pull/10574#issuecomment-1932010128", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10585/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10585/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10583", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10583/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10583/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10583/events", "html_url": "https://github.com/near/nearcore/pull/10583", "id": 2123939868, "node_id": "PR_kwDOCQUkYs5mT4Ev", "number": 10583, "title": "fix: make test_bad_chunk_mask work with stateless validation", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-07T21:34:15Z", "updated_at": "2024-02-08T11:54:50Z", "closed_at": "2024-02-08T11:54:49Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10583", "html_url": "https://github.com/near/nearcore/pull/10583", "diff_url": "https://github.com/near/nearcore/pull/10583.diff", "patch_url": "https://github.com/near/nearcore/pull/10583.patch", "merged_at": "2024-02-08T11:54:49Z"}, "body": "This test didn't work with stateless validation because it didn't propagate chunk state witnesses and endorsements as needed.\r\n\r\nI modified the test to use `TestEnv`, which allowed me to use the exisiting functionality for propagating all the partial chunk requests, state witnesses and endorsements.\r\nThis changed the assignment of chunk and block producers. Previously one of the clients was a chunk producer and the other a block producer, with their roles swapped on each block. Now the roles are assigned based on the logic in `EpochManager`. IMO it doesn't affect the test, in the crucial moment when the bad chunk mask is tested, the chunk producer is different from the block producer, just like in the original test.\r\n\r\nThe test manually produces a single chunk on shard 0 to achieve the desired chunk mask, so I couldn't just use the default way of generating chunks during block processing. I had to implement a function that would manually produce the required chunk.\r\n\r\nRefs: https://github.com/near/nearcore/issues/10506", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10583/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10583/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10582", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10582/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10582/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10582/events", "html_url": "https://github.com/near/nearcore/pull/10582", "id": 2123473544, "node_id": "PR_kwDOCQUkYs5mSSaP", "number": 10582, "title": "[Single Shard] Introduce SingleShardTracking, and fix partial chunk forwarding logic for single shard tracking.", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-07T16:56:05Z", "updated_at": "2024-02-09T01:18:01Z", "closed_at": "2024-02-09T01:18:00Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10582", "html_url": "https://github.com/near/nearcore/pull/10582", "diff_url": "https://github.com/near/nearcore/pull/10582.diff", "patch_url": "https://github.com/near/nearcore/pull/10582.patch", "merged_at": "2024-02-09T01:18:00Z"}, "body": "This properly tests the changes introduced in #10575 ; I've verified that without 10575, the stateless validation integration now fails.\r\n\r\nThis also properly implements chunk forwarding for the single shard (or rather, any number of shards) tracking case. Previously we were forwarding all parts to all block producers and all incoming chunk producers, but now we're forwarding to only those who track the corresponding shard. The TestLoop-based integration test in multi.rs have been modified to test the behavior of this new logic, too.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10582/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10582/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10577", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10577/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10577/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10577/events", "html_url": "https://github.com/near/nearcore/pull/10577", "id": 2123142932, "node_id": "PR_kwDOCQUkYs5mRKgV", "number": 10577, "title": "fix(nayduck) - update test names after refactoring", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-07T14:19:17Z", "updated_at": "2024-02-07T17:16:38Z", "closed_at": "2024-02-07T17:16:37Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10577", "html_url": "https://github.com/near/nearcore/pull/10577", "diff_url": "https://github.com/near/nearcore/pull/10577.diff", "patch_url": "https://github.com/near/nearcore/pull/10577.patch", "merged_at": "2024-02-07T17:16:37Z"}, "body": "The tests were failing in nayduck because the name of the test was wrong and no tests were actually executed. \r\ne.g.\r\n```\r\nhttps://nayduck.near.org/#/test/571329\r\ntest result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 57 filtered out; finished in 0.00s\r\n```\r\n\r\nI'm hoping this should help. I tried one of the tests and it passed.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10577/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10577/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10576", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10576/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10576/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10576/events", "html_url": "https://github.com/near/nearcore/pull/10576", "id": 2123107215, "node_id": "PR_kwDOCQUkYs5mRCyV", "number": 10576, "title": "fix(resharding) - disable nightly nayduck tests", "user": {"login": "wacban", "id": 1555986, "node_id": "MDQ6VXNlcjE1NTU5ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1555986?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wacban", "html_url": "https://github.com/wacban", "followers_url": "https://api.github.com/users/wacban/followers", "following_url": "https://api.github.com/users/wacban/following{/other_user}", "gists_url": "https://api.github.com/users/wacban/gists{/gist_id}", "starred_url": "https://api.github.com/users/wacban/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wacban/subscriptions", "organizations_url": "https://api.github.com/users/wacban/orgs", "repos_url": "https://api.github.com/users/wacban/repos", "events_url": "https://api.github.com/users/wacban/events{/privacy}", "received_events_url": "https://api.github.com/users/wacban/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-07T14:01:29Z", "updated_at": "2024-02-07T16:31:54Z", "closed_at": "2024-02-07T16:31:53Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10576", "html_url": "https://github.com/near/nearcore/pull/10576", "diff_url": "https://github.com/near/nearcore/pull/10576.diff", "patch_url": "https://github.com/near/nearcore/pull/10576.patch", "merged_at": "2024-02-07T16:31:53Z"}, "body": "Stateless Validation is enabled in nightly and it breaks the resharding tests. This PR disabled those tests in nightly. \r\n\r\nsample output:\r\n```\r\n2024-02-07T13:49:51.368919Z  INFO network: ed25519:FXXrTXiKWpXj1R6r5fBvMLpstd8gPyrBq3qMByqKVzKF: Peer Some(ed25519:He7QeRuwizNEhBioYG3u4DZ8jWXyETiyNzFD3MkTjDMf@127.0.0.1:24577) disconnected, reason: peer banned: BadChunkStateWitness\r\n```\r\nThen the validators refuse to talk to each other stop producing blocks and the tests timeouts. ", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10576/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10576/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10575", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10575/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10575/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10575/events", "html_url": "https://github.com/near/nearcore/pull/10575", "id": 2121969539, "node_id": "PR_kwDOCQUkYs5mNQcx", "number": 10575, "title": "[Chunk Endorsement] Use partial chunk to get header instead of full chunk", "user": {"login": "robin-near", "id": 111538878, "node_id": "U_kgDOBqXyvg", "avatar_url": "https://avatars.githubusercontent.com/u/111538878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/robin-near", "html_url": "https://github.com/robin-near", "followers_url": "https://api.github.com/users/robin-near/followers", "following_url": "https://api.github.com/users/robin-near/following{/other_user}", "gists_url": "https://api.github.com/users/robin-near/gists{/gist_id}", "starred_url": "https://api.github.com/users/robin-near/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/robin-near/subscriptions", "organizations_url": "https://api.github.com/users/robin-near/orgs", "repos_url": "https://api.github.com/users/robin-near/repos", "events_url": "https://api.github.com/users/robin-near/events{/privacy}", "received_events_url": "https://api.github.com/users/robin-near/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-07T01:16:45Z", "updated_at": "2024-02-07T15:12:14Z", "closed_at": "2024-02-07T15:12:13Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10575", "html_url": "https://github.com/near/nearcore/pull/10575", "diff_url": "https://github.com/near/nearcore/pull/10575.diff", "patch_url": "https://github.com/near/nearcore/pull/10575.patch", "merged_at": "2024-02-07T15:12:13Z"}, "body": "Testing is pending. It's not very easy because ShardsManager right now still forwards all parts to all block producers.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10575/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10575/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10574", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10574/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10574/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10574/events", "html_url": "https://github.com/near/nearcore/pull/10574", "id": 2121417094, "node_id": "PR_kwDOCQUkYs5mLXGk", "number": 10574, "title": "test: add a test for self-call delay via x-contract calls", "user": {"login": "nagisa", "id": 679122, "node_id": "MDQ6VXNlcjY3OTEyMg==", "avatar_url": "https://avatars.githubusercontent.com/u/679122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nagisa", "html_url": "https://github.com/nagisa", "followers_url": "https://api.github.com/users/nagisa/followers", "following_url": "https://api.github.com/users/nagisa/following{/other_user}", "gists_url": "https://api.github.com/users/nagisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/nagisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nagisa/subscriptions", "organizations_url": "https://api.github.com/users/nagisa/orgs", "repos_url": "https://api.github.com/users/nagisa/repos", "events_url": "https://api.github.com/users/nagisa/events{/privacy}", "received_events_url": "https://api.github.com/users/nagisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-02-06T18:21:11Z", "updated_at": "2024-02-07T22:37:12Z", "closed_at": "2024-02-07T13:50:36Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10574", "html_url": "https://github.com/near/nearcore/pull/10574", "diff_url": "https://github.com/near/nearcore/pull/10574.diff", "patch_url": "https://github.com/near/nearcore/pull/10574.patch", "merged_at": "2024-02-07T13:50:36Z"}, "body": "A very minimal test I wrote to check just how deep can we go with calling self to delay completion of a receipt.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10574/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10574/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10572", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10572/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10572/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10572/events", "html_url": "https://github.com/near/nearcore/pull/10572", "id": 2121216335, "node_id": "PR_kwDOCQUkYs5mKrHe", "number": 10572, "title": "fix: compute chunk signatures once", "user": {"login": "pugachAG", "id": 3171838, "node_id": "MDQ6VXNlcjMxNzE4Mzg=", "avatar_url": "https://avatars.githubusercontent.com/u/3171838?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pugachAG", "html_url": "https://github.com/pugachAG", "followers_url": "https://api.github.com/users/pugachAG/followers", "following_url": "https://api.github.com/users/pugachAG/following{/other_user}", "gists_url": "https://api.github.com/users/pugachAG/gists{/gist_id}", "starred_url": "https://api.github.com/users/pugachAG/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pugachAG/subscriptions", "organizations_url": "https://api.github.com/users/pugachAG/orgs", "repos_url": "https://api.github.com/users/pugachAG/repos", "events_url": "https://api.github.com/users/pugachAG/events{/privacy}", "received_events_url": "https://api.github.com/users/pugachAG/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2024-02-06T16:31:48Z", "updated_at": "2024-02-07T11:47:48Z", "closed_at": "2024-02-07T11:47:46Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10572", "html_url": "https://github.com/near/nearcore/pull/10572", "diff_url": "https://github.com/near/nearcore/pull/10572.diff", "patch_url": "https://github.com/near/nearcore/pull/10572.patch", "merged_at": "2024-02-07T11:47:46Z"}, "body": "Currently `prepare_chunk_headers_ready_for_inclusion` is called twice when producing a block:\r\n* directly as part of `ClientActor::handle_block_production` \r\n* `ClientActor::handle_block_production`  -> `ClientActor::produce_block` -> `Client::produce_block`\r\n\r\nThis results in endorsement metrics (see #10533) emitted twice.\r\nThis PR fixes it by adding `produce_block_on_head` with `prepare_chunk_headers` argument to avoid calling `prepare_chunk_headers_ready_for_inclusion` from `ClientActor` while still calling it from the tests.", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10572/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10571", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10571/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10571/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10571/events", "html_url": "https://github.com/near/nearcore/pull/10571", "id": 2121152591, "node_id": "PR_kwDOCQUkYs5mKdDp", "number": 10571, "title": "fix: make adversarial_behaviors tests pass with stateless validation", "user": {"login": "jancionear", "id": 149345204, "node_id": "U_kgDOCObTtA", "avatar_url": "https://avatars.githubusercontent.com/u/149345204?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jancionear", "html_url": "https://github.com/jancionear", "followers_url": "https://api.github.com/users/jancionear/followers", "following_url": "https://api.github.com/users/jancionear/following{/other_user}", "gists_url": "https://api.github.com/users/jancionear/gists{/gist_id}", "starred_url": "https://api.github.com/users/jancionear/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jancionear/subscriptions", "organizations_url": "https://api.github.com/users/jancionear/orgs", "repos_url": "https://api.github.com/users/jancionear/repos", "events_url": "https://api.github.com/users/jancionear/events{/privacy}", "received_events_url": "https://api.github.com/users/jancionear/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 8, "created_at": "2024-02-06T16:04:58Z", "updated_at": "2024-02-06T20:38:17Z", "closed_at": "2024-02-06T20:38:17Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10571", "html_url": "https://github.com/near/nearcore/pull/10571", "diff_url": "https://github.com/near/nearcore/pull/10571.diff", "patch_url": "https://github.com/near/nearcore/pull/10571.patch", "merged_at": "2024-02-06T20:38:16Z"}, "body": "## Description\r\nThe tests in `adversarial_behaviors.rs` didn't work with stateless validation, let's make them pass again.\r\nTo achieve this we first need to propagate chunk state witnesses and endorsements, and then adjust the expected behavior to match the one exhibited by stateless validation. \r\n\r\nThe most complex part of this PR is modifying which blocks should be skipped in `test_banning_chunk_producer_when_seeing_invalid_chunk_base()`.\r\nThis function creates a blockchain with one malicious chunk producer and runs it for a few epochs. \r\nWhich blocks will be skipped depends on whether we are using stateless validation or not.\r\n\r\n### Without stateless validation\r\nIn the old version of the protocol the invalid chunk is included in a block and then the whole block is validated. The chunk is invalid, so the whole block is also invalid and the block should be skipped. After that the malicious chunk producer is banned for the rest of the epoch, which means that block producers will reject chunks sent by this chunk producer, so the subsequent blocks won't contain any invalid chunks and won't be skipped.\r\nOnly the first block with invalid chunks in an epoch should be skipped. \r\n\r\n### With stateless validation\r\nWith stateless validation the situation is entirely different. When the malicious chunk producer produces an invalid chunk, chunk validators will refuse to send out endorsements for this chunk, so the chunk won't be included in any block. This means that no blocks should be skipped.\r\n\r\nThere is one exception - in the test the block produced at height 2 is invalid and gets skipped. I suspect that this is because the first few blocks after genesis don't use stateless validation, and they are still handled by old protocol. I'm not 100% sure if that's the case, @Longarithm could you confirm that this explanation makes sense?\r\nSomething is definitely different  for the first few blocks, in the logs I can see `client: Banning chunk producer for producing invalid` at height 2, which seems to belong to the old protocol. In the new version malicious chunk producers are banned using `BanPeer`, without any log messages.\r\n\r\nRefs: https://github.com/near/nearcore/issues/10506, [zulip discussion](https://near.zulipchat.com/#narrow/stream/295558-pagoda.2Fcore/topic/Skipping.20the.20first.20block.20with.20missing.20chunks.20in.20an.20epoch.3F/near/419838610)", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10571/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10571/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}, {"url": "https://api.github.com/repos/near/nearcore/issues/10568", "repository_url": "https://api.github.com/repos/near/nearcore", "labels_url": "https://api.github.com/repos/near/nearcore/issues/10568/labels{/name}", "comments_url": "https://api.github.com/repos/near/nearcore/issues/10568/comments", "events_url": "https://api.github.com/repos/near/nearcore/issues/10568/events", "html_url": "https://github.com/near/nearcore/pull/10568", "id": 2118710833, "node_id": "PR_kwDOCQUkYs5mCEQp", "number": 10568, "title": "[stateless_validation] fix: Pending chunk endorsement cache", "user": {"login": "staffik", "id": 18039094, "node_id": "MDQ6VXNlcjE4MDM5MDk0", "avatar_url": "https://avatars.githubusercontent.com/u/18039094?v=4", "gravatar_id": "", "url": "https://api.github.com/users/staffik", "html_url": "https://github.com/staffik", "followers_url": "https://api.github.com/users/staffik/followers", "following_url": "https://api.github.com/users/staffik/following{/other_user}", "gists_url": "https://api.github.com/users/staffik/gists{/gist_id}", "starred_url": "https://api.github.com/users/staffik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/staffik/subscriptions", "organizations_url": "https://api.github.com/users/staffik/orgs", "repos_url": "https://api.github.com/users/staffik/repos", "events_url": "https://api.github.com/users/staffik/events{/privacy}", "received_events_url": "https://api.github.com/users/staffik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 6448548662, "node_id": "LA_kwDOCQUkYs8AAAABgF0LNg", "url": "https://api.github.com/repos/near/nearcore/labels/A-stateless-validation", "name": "A-stateless-validation", "color": "0000ff", "default": false, "description": "Area: stateless validation"}], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 1, "created_at": "2024-02-05T14:34:31Z", "updated_at": "2024-02-06T14:16:50Z", "closed_at": "2024-02-06T14:16:49Z", "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/near/nearcore/pulls/10568", "html_url": "https://github.com/near/nearcore/pull/10568", "diff_url": "https://github.com/near/nearcore/pull/10568.diff", "patch_url": "https://github.com/near/nearcore/pull/10568.patch", "merged_at": "2024-02-06T14:16:49Z"}, "body": "Issue: https://github.com/near/nearcore/issues/10560\r\n\r\nhttps://near.zulipchat.com/#narrow/stream/407237-pagoda.2Fcore.2Fstateless-validation/topic/StatelessNet.20planning/near/419827117\r\n> * add pending_chunk_endorsements cache to ChunkEndorsementTracker\r\n> * if we have an error on get_chunk, add endorsements to pending cache\r\n> * on on_chunk_completed, process all pending endorsements for chunk hash\r\nWe discussed previously that full chunk may not be needed. But this solution aligns well with the existing design", "reactions": {"url": "https://api.github.com/repos/near/nearcore/issues/10568/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/near/nearcore/issues/10568/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]